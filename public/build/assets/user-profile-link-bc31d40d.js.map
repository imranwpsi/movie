{"version":3,"mappings":"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","names":["InfiniteQueryObserver","QueryObserver","client","options","notifyOptions","infiniteQueryBehavior","pageParam","query","_state$fetchMeta","_state$fetchMeta$fetc","_state$fetchMeta2","_state$fetchMeta2$fet","_state$data","_state$data2","state","result","isFetching","isRefetching","isFetchingNextPage","isFetchingPreviousPage","hasNextPage","hasPreviousPage","useInfiniteQuery","arg1","arg2","arg3","parseQueryArgs","useBaseQuery","FilterControlType","FilterOperator","ALL_PRIMITIVE_OPERATORS","startOfDay","date","endOfDay","getUserTimezone","defaultTimezone","_a","getBootstrapData","preferredTimezone","_c","_b","getLocalTimeZone","Now","now","locale","DateRangePresets","message","startOfWeek","endOfWeek","start","startOfYear","endOfYear","DateRangeIcon","createSvgIcon","jsx","Input","React","props","ref","children","inputProps","wrapperProps","className","autoFocus","style","onClick","clsx","FocusScope","DatePickerField","inputRef","onBlur","other","fieldClassNames","getInputFieldClassNames","objRef","useObjectRef","fieldProps","useField","Field","mergeProps","e","createFocusManager","getDefaultGranularity","CalendarDate","dateIsInvalid","min","max","useBaseDatePickerState","selectedDate","timezone","useUserTimezone","calendarIsOpen","setCalendarIsOpen","useState","closeDialogOnSelection","granularity","toZoned","useCurrentDateTime","useMemo","useDateRangePickerState","isPlaceholder","setIsPlaceholder","setStateValue","internalValue","setInternalValue","useControlledState","completeRange","clear","useCallback","anchorDate","setAnchorDate","isHighlighting","setIsHighlighting","highlightedRange","setHighlightedRange","calendarDates","setCalendarDates","rangeToCalendarDates","constrainRange","range","end","maxDate","startMax","minDate","endMin","setSelectedValue","newRange","value","dayIsActive","day","isSameDay","dayIsHighlighted","dayIsRangeStart","dayIsRangeEnd","getCellProps","isSameMonth","makeRange","finalRange","toCalendarDate","startOfMonth","endOfMonth","ArrowRightAltIcon","adjustSegment","part","amount","hours","isPM","setSegment","segmentValue","wasPM","PAGE_STEP","EditableDateSegment","segment","domProps","onChange","isMobile","useIsMobileMediaQuery","enteredKeys","useRef","localeCode","useSelectedLocale","focusManager","useFocusManager","formatter","useDateFormatter","parser","NumberParser","setSegmentValue","newValue","adjustSegmentValue","backspace","parsed","today","onKeyDown","onInput","amPmFormatter","am","amDate","pm","pmDate","key","numberValue","allowsZero","shouldSetValue","spinButtonProps","LiteralDateSegment","getSegmentLimits","type","getMinimumMonthInYear","getMinimumDayInMonth","DateSegmentList","segmentProps","memoOptions","dateValue","segments","limits","textValue","index","KeyboardArrowLeftIcon","KeyboardArrowRightIcon","CalendarCell","currentMonth","dayOfWeek","getDayOfWeek","isActive","isHighlighted","isRangeStart","isRangeEnd","dayIsToday","isToday","sameMonth","isDisabled","jsxs","CalendarMonth","startDate","isFirst","isLast","weeksInMonth","getWeeksInMonth","monthStart","CalendarMonthHeader","WeekdayHeader","weekIndex","m","dayIndex","shiftCalendars","direction","count","newDates","monthFormatter","isBackwardDisabled","isForwardDisabled","IconButton","dayFormatter","dateDay","weekday","Calendar","visibleMonths","Fragment","FormattedDateTimeRange","memo","preset","dates","useSettings","DateFormatPresets","castToDate","shallowEqual","parseAbsolute","DatePresetList","onPresetSelected","selectedValue","List","ListItem","Trans","useIsTabletMediaQuery","useMediaQuery","DateRangeDialog","showInlineDatePickerField","isTablet","close","useDialogContext","initialStateRef","hasPlaceholder","footer","DialogFooter","Button","Dialog","DialogBody","AnimatePresence","Calendars","InlineDatePickerField","DateRangePicker","hideCalendarIcon","dialog","DialogTrigger","openOnClick","isHourSegment","FormDateRangePicker","invalid","error","useController","formProps","dateRangeToAbsoluteRange","absoluteRangeToDateRange","dateRange","parseAbsoluteToLocal","absoluteRange","Avatar","forwardRef","circle","size","src","link","label","fallback","lazy","renderedAvatar","AvatarPlaceholderIcon","Tooltip","getSizeClassName","Link","NameWithAvatar","image","description","labelClassName","avatarSize","BackendFiltersUrlKey","decodeBackendFilters","encodedFilters","filtersFromQuery","filterValue","encodeBackendFilters","filterValues","filters","item","transformValue","fm","filterConfig","f","option","o","useBackendFilterUrlParams","pinnedFilters","searchParams","useSearchParams","navigate","useNavigate","decodedFilters","decoded","config","a","b","getDecodedWithoutKeys","values","newFilters","replaceAll","add","remove","DatatableDataQueryKey","endpoint","params","useDatatableData","useQuery","paginate","apiClient","response","isCtrlKeyPressed","isMac","useGridNavigation","cellCount","rowCount","focusSiblingCell","focusFirstElementAfterGrid","operations","grid","currentCell","row","rowIndex","cellIndex","rowOpCount","_d","cellOpCount","_e","_f","_g","nextCell","nextFocusableElement","getFocusableTreeWalker","walker","next","last","focusWithoutScrolling","TableContext","createContext","useTableCellStyle","isHeader","columns","cellHeight","useContext","column","userPadding","justify","TableCell","rowIsHovered","id","rowContext","usePointerEvents","onMoveStart","onMove","onMoveEnd","minimumMovement","preventDefault","stopPropagation","onPress","onLongPress","addGlobalListener","removeGlobalListener","useGlobalListeners","onPointerDown","onPointerMove","onPointerUp","deltaX","deltaY","longPressTriggered","createEventHandler","isCtrlOrShiftPressed","useTableRowStyle","isSelected","isDarkMode","useIsDarkMode","hideBorder","enableSelection","collapseOnMobile","interactableElements","TableRow","renderAs","selectedRows","toggleRow","selectRow","onAction","selectRowOnContextMenu","selectionStyle","hideHeaderRow","isTouchDevice","isHovered","setIsHovered","clickedOnInteractable","doubleClickHandler","anyRowsSelected","handleRowTap","keyboardHandler","contextMenuHandler","styleClassName","RowElement","CheckboxColumnConfig","SelectAllCheckbox","Skeleton","SelectRowCheckbox","Checkbox","trans","useTrans","data","onSelectionChange","allRowsSelected","someRowsSelected","d","ArrowDownwardIcon","HeaderCell","sortDescriptor","onSortChange","enableSorting","sortingKey","allowSorting","orderBy","orderDir","sortActive","ariaSort","toggleSorting","newSort","sortVisible","sortVariants","TableHeaderRow","columnIndex","Table","userColumns","propsSelectedRows","propsDefaultSelectedRows","propsOnSelectionChange","propsSortDescriptor","propsOnSortChange","onDelete","ariaLabelledBy","renderRowAs","tableBody","meta","propsTableRef","closeOnInteractOutside","isCollapsedMode","newValues","merge","filteredColumns","c","visibleInMode","contextValue","navProps","tableBodyProps","cloneElement","BasicTableBody","tableRef","useInteractOutside","EMPTY_PAGINATION_RESPONSE","pagination","FilterAltIcon","Accordion","variant","mode","isLazy","expandedValues","setExpandedValues","child","isValidElement","AccordionItem","disabled","bodyClassName","buttonPadding","startIcon","endAppend","chevronPosition","isExpanded","wasExpandedOnce","useId","buttonId","panelId","variants","toggle","i","newKeys","chevron","KeyboardArrowDownIcon","SelectFilterPanel","filter","FormSelect","Item","DateRangeFilterPanel","buildEndpoint","model","prefix","parts","useNormalizedModels","queryParams","queryOptions","userEndpoint","fetchUsers","r","modelName","modelId","useNormalizedModel","fetchModel","NormalizedModelField","modelType","background","defaultValue","placeholder","searchPlaceholder","errorMessage","customEndpoint","singleEndpoint","multipleEndpoint","inputValue","setInputValue","SelectedModelPreview","Select","onEditClick","isLoading","LoadingSkeleton","opacityAnimation","EditIcon","FormNormalizedModelField","name","NormalizedModelFilterPanel","FilterOperatorNames","InputFilterPanel","control","operator","FormTextField","BooleanFilterPanel","ChipList","color","radius","selectable","Children","chip","stringToChipValue","ChipFieldInner","fieldRef","displayWith","v","validateWith","suggestions","onInputValueChange","onItemSelected","onOpenChange","chipSize","openMenuOnFocus","showEmptyMessage","propsValue","propsOnChange","valueKey","isAsync","allowCustomValue","showDropdownArrow","onChipClick","inputFieldProps","useChipFieldValueState","listboxIsOpen","setListboxIsOpen","loadingIndicator","ProgressCircle","dropdownArrow","ListWrapper","ChipInput","items","setItems","displayChipUsing","manager","removeItem","cr","newItems","Chip","setChips","chips","inputClassName","addItems","listbox","useListbox","handleItemSelection","activeIndex","setActiveIndex","isOpen","setIsOpen","refs","listboxId","collection","onInputChange","useLayoutEffect","handleTriggerKeyDown","handleListboxKeyboardNavigation","useListboxKeyboardNavigation","handleFocusAndClick","Listbox","Popover","emails","selection","email","input","mixedValueToChipValue","propsDefaultValue","handleChange","ChipField","FormChipField","ChipFieldFilterPanel","AddFilterDialog","formId","expandedFilters","setExpandedFilters","clearButton","applyButton","DialogHeader","FilterList","defaultValues","appliedFilter","form","useForm","Form","formValue","fieldValue","AddFilterDialogPanel","CustomComponent","AddFilterButton","icon","desktopButton","mobileButton","FilterListTriggerButton","isInactive","InactiveFilterButton","ActiveFilterButton","isBoolean","FilterListItemDialogTrigger","onValueChange","FilterListControlDialog","panel","FormattedNumber","useNumberFormatter","FilterListControl","DatePickerControl","BooleanToggleControl","SelectControl","ChipFieldControl","InputControl","SelectModelControl","Control","valueLabel","MultipleValues","maxShownCount","notShownCount","names","operatorLabel","formattedValue","skeleton","modelPreview","field","handleValueChange","payload","CloseIcon","FilterListSkeleton","AddIcon","Switch","useAutoFocus","descriptionId","FormSwitch","subscribeWithSelectorImpl","fn","set","get","api","origSubscribe","selector","optListener","listener","equalityFn","currentSlice","nextSlice","previousSlice","subscribeWithSelector","BaseSlider","inline","showValueLabel","width","slider","trackColor","fillColor","trackRef","getThumbPercent","getThumbValueLabel","labelId","groupId","thumbIds","numberFormatter","minValue","maxValue","step","getValueLabel","outputValue","maxLabelLength","wrapperClassname","getTrackColor","getFillColor","useSlider","formatOptions","onChangeEnd","showThumbOnHoverOnly","thumbSize","isPointerOver","setIsPointerOver","setValues","valuesRef","draggedThumbs","setDraggedThumbs","draggedThumbsRef","getFormattedValue","isThumbDragging","getThumbMinValue","getThumbMaxValue","setThumbValue","isThumbEditable","thisMin","thisMax","snapValueToStep","replaceIndex","updateDraggedThumbs","dragging","wasDragging","focusedThumb","setFocusedThumb","getValuePercent","x","setThumbPercent","percent","getPercentValue","getRoundedValue","val","clamp","editableThumbsRef","setThumbEditable","editable","realTimeTrackDraggingIndex","currentPointer","handlePointerDown","_","trackPosition","closestThumb","split","lastLeft","firstRight","onUpTrack","currentPosition","moveDomProps","array","SliderThumb","isThumbDisabled","ariaLabel","inputObjRef","isSliderDisabled","isDragging","focusInput","isFocused","useEffect","handlePointerUp","thumbColor","Slider","otherProps","baseProps","FormSlider","usePrevious","draggables","droppables","dragMonitors","dragSession","interactableEvent","rect","activeInteraction","setActiveInteraction","domRectToObj","updateRects","targets","observer","entries","entry","height","left","top","target","useDraggable","preview","hidePreview","dragHandleRef","removeAllGlobalListeners","optionsRef","notifyMonitors","callback","monitor","onDragStart","draggable","el","clickedOnHandle","hideNativeGhostImage","ie","node","onDragOver","newRect","emptyImage","readFilesFromDataTransfer","dataTransfer","UploadedFile","getEntries","file","reader","resolve","reject","getEntryFile","asyncIterableToArray","iterator","DROP_ACTIVATE_TIMEOUT","useDroppable","canDrop","allowEventsOnSelf","fireDragLeave","getDraggable","element","dropResult","moveItemInArray","fromIndex","toIndex","from","to","delta","moveItemInNewArray","newArray","sortSession","useSortable","onSortEnd","onSortStart","onDragEnd","onDropPositionChange","previewVariant","dropPosition","draggableProps","getScrollParent","addSortStyles","removeSortStyles","clearLinePreview","droppableProps","previousPosition","newPosition","midY","overIndex","addLinePreview","droppableId","droppable","itemIndex","oldIndex","rects","s","sortable","newRects","oldRect","sortableTarget","y","transition","side","_process","mod","parseKey","isIndex","k","isObject","isArrayOrObject","isEmptyObject","blacklist","blacklistFilter","parsePath","path","sep","check","hasOwnProperty","DotObject","separator","override","useArray","useBrackets","dotDefault","wrap","method","obj","mods","self","ok","reindexArray","keys","cp","n","ret","root","source","obj1","obj2","j","recipe","tgt","isArray","previousKey","prop","dotObject","TuneIcon","MoreVertIcon","TabContext","Tabs","overflow","tabsRef","selectedTab","setSelectedTab","ContextValue","TabLine","setStyle","prevState","TabList","center","expand","childrenArray","Tab","paddingProp","elementType","relative","padding","mergedClassname","textColor","tabIndex","Element","DragHandleIcon","DragPreview","render","setChildren","domRef","useImperativeHandle","flushSync","createPortal","rootEl","useStickySentinel","isSticky","setIsSticky","observerRef","sentinelRef","sentinel","CrupdateResourceLayout","onSubmit","title","actions","backButton","disableSaveWhenNotDirty","wrapInContainer","isDirty","ImageZoomDialog","images","ChevronLeftIcon","playlist","useChannelQueryParams","channel","userParams","useParams","useChannel","slugOrId","loader","channelId","channelQueryKey","fetchChannel","channelEndpoint","ContentModelField","exclude","setValue","getValues","useFormContext","modelConfig","Option","useIsTouchDevice","RefreshIcon","useUpdateChannelContent","useMutation","updateChannel","toast","err","showHttpErrorToast","columnConfig","RemoveItemColumn","ChannelContentEditor","searchField","noResultsMessage","watch","contentType","fieldArray","useFieldArray","content","col","ContentNotEditableWarning","UpdateContentButton","ContentTableRow","IllustratedMessage","SvgImage","previewRef","setDropPosition","sortableProps","position","newIndex","RowDragPreview","WarningIcon","updateContent","useAddableContent","search","ChannelContentSearchField","onResultSelected","imgRenderer","contentModel","setQuery","ComboBox","SearchIcon","ImageIcon","ChannelContentItemImage","useImageSrc","imageClassName","ContentOrderField","sortMethods","sortConfig","TITLE_MODEL","MOVIE_MODEL","SERIES_MODEL","NEWS_ARTICLE_MODEL","CHANNEL_MODEL","PERSON_MODEL","GridViewIcon","ViewWeekIcon","ViewListIcon","Sort","Layout","contentModels","contentSortingMethods","contentLayoutMethods","contentAutoUpdateMethods","channelContentConfig","GENRE_MODEL","PRODUCTION_COUNTRY_MODEL","NewsArticleLink","article","linkProps","finalUri","getNewsArticleLink","absolute","NewspaperIcon","NewsArticleImage","useDeleteComments","deleteComments","commentIds","UserAvatar","user","auth","SiteConfigContext","buildQueryKey","queryKey","defaultOrderDir","defaultOrderBy","searchQuery","useInfiniteData","initialPage","transformResponse","willSortOrFilter","setSearchQuery","setSortDescriptor","initialQueryKey","hashQueryKey","fetchData","lastResponse","p","firstPage","totalItems","reviewsQueryKey","reviewable","useReviews","sort","useLocalStorage","useDeleteReviews","deleteReviews","queryClient","reviewIds","StarIcon","TitleRating","score","StarBorderIcon","StarSelector","readonly","hoverRating","setHoverRating","number","BulletSeparatedItems","SortIcon","SortOptions","ReviewListSortButton","showReportsItem","selectedOption","MenuTrigger","Menu","MenuItem","BaseMediaLink","displayContents","baseClassName","getBaseMediaLink","SeasonLink","seasonNumber","getSeasonLink","getTitleLink","EpisodeLink","episodeNumber","episode","getEpisodeLink","CompactSeasonEpisode","seasonNum","episodeNum","prefixWithZero","TitleLink","TitleLinkWithEpisodeNumber","season","slugifyString","getWatchLink","video","MediaPlayIcon","TitlePoster","srcSize","aspect","showPlayButton","MovieIcon","linkChildren","VideoPlayerSkeleton","animate","hlsRegex","dashRegex","audioRegex","youtubeUrlRegex","youtubeIdRegex","guessPlayerProvider","shuffleArray","keepFirst","first","currentIndex","temporaryValue","randomIndex","getPlayerStateFromLocalStorage","defaultVolume","getFromLocalStorage","prependToArrayAtIndex","toAdd","copyOfArray","tail","resetMediaSession","action","playerQueue","getPointer","handlePlayerKeybinds","initPlayerMediaSession","actionHandlers","details","cuedMedia","isSameMedia","ScreenOrientation","__publicField","lockType","IS_CLIENT","IS_IPHONE","webkit","moz","ms","document","vendor","fscreen","handler","fscreen$1","createNativeFullscreenAdapter","host","createIphoneFullscreenAdapter","iPhoneProviderBlacklist","createFullscreenSlice","subscription","orientation","adapter","onFullscreenChange","isFullscreen","isSupported","canFullscreen","createChromePipAdapter","canUsePiPInChrome","_canUsePiPInChrome","createSafariPipAdapter","canUsePiPInSafari","_canUsePiPInSafari","adapterFactories","createPipSlice","adapters","onPipChange","factory","canPip","createPlayerStore","initialData","deepMerge","setInLocalStorage","_setInLocalStorage","createStore","immer","store","listeners","internalListeners","rates","qualities","quality","tracks","trackId","isVisible","isBuffering","media","queue","url","provider","keybindsHandler","initialQueue","isSeeking","isMuted","speed","newRepeat","currentRepeat","newQueue","time","timeStr","previousProvider","timeoutId","unsubscribe","mediaItems","queuePointer","afterCuedMedia","shuffledNewItems","mediaId","mediaToCue","newListeners","event","l","PlayerStoreContext","PlayerContext","YoutubeCommand","YouTubePlayerState","isNumber","loadImage","minWidth","posterCache","loadYoutubePoster","videoId","posterURL","img","poster","handleYoutubeEmbedMessage","internalStateRef","iframeRef","info","internalState","emit","buffered","onYoutubeStateChange","onCued","usePlayerStore","useStore","usePlayerActions","overrideQueueAndPlay","youtubeIdFromSrc","queryString","useYoutubeProviderSrc","loadVideoById","getState","origin","initialVideoId","setInitialVideoId","updateVideoIds","prevId","YoutubeProvider","youtubeApi","command","arg","initialVideoUrl","registerApi","internalProviderApi","volume","muted","createRafLoop","isUndefined","loop","stop","useHtmlMediaInternalState","updateCurrentTime","updateBuffered","timeRange","seconds","newTime","toggleTextTrackModes","newTrackId","textTracks","track","oldTrack","nextTrack","timeRafLoop","defaultPlaybackRates","useHtmlMediaEvents","onTextTracksChange","t","useHtmlMediaApi","HtmlVideoProvider","autoPlay","events","providerApi","caption","HtmlAudioProvider","HlsProvider","__vitePreload","DashProvider","PlayerOutlet","Provider","Suspense","MediaPauseIcon","PlayButton","iconSize","isPlaying","playerReady","player","MediaMuteIcon","MediaVolumeLowIcon","MediaVolumeHighIcon","VolumeControls","buttonColor","ToggleMuteButton","useCurrentTime","subscribe","getCurrentTime","providerKey","currentTime","setCurrentTime","Seekbar","pause","seek","setIsSeeking","play","duration","pauseWhileSeeking","wasPlayingBeforeDragging","FormattedDuration","minutes","verbose","addZeroToFirstUnit","unsignedMs","parsedMS","formatVerbose","formatCompact","output","addZero","FormattedCurrentTime","FormattedPlayerDuration","MediaNextIcon","NextButton","MediaFullscreenExitIcon","MediaFullscreenIcon","FullscreenButton","labelMessage","MediaPictureInPictureExitIcon","MediaPictureInPictureIcon","PipButton","isPip","ArrowRightIcon","MediaSettingsIcon","MediaPlaybackSpeedCircleIcon","MediaSettingsMenuIcon","MediaClosedCaptionsIcon","MediaArrowLeftIcon","Panels","PlaybackRatePanel","PlaybackQualityPanel","OptionsListPanel","CaptionsPanel","PlaybackOptionsButton","darkThemeVars","useDarkThemeVariables","PlaybackOptionsPanel","activePanel","setActivePanel","PanelComponent","onActivePanelChange","activeRate","availableQualities","activeQuality","availableTextTracks","textTrackId","currentTextTrack","availableRates","PanelLayout","rate","MediaClosedCaptionsOnIcon","ToggleCaptionsButton","captionsVisible","PlayerPoster","hideDuringPlayback","posterUrl","shouldHidePoster","usePlayerClickHandler","clickRef","togglePlay","BufferingSpinner","VideoPlayer","cuedMediaId","onBeforePlayPrevious","onBeforePlayNext","onDestroy","apiRef","rightActions","mediaItemFromSrc","QueueOverrider","PlayerLayout","leaveTimerRef","inactiveTimerRef","pointerIsOverControls","controlsVisible","setControlsVisible","clickHandler","clearTimers","startInactiveTimer","Blocker","OverlayButtons","BottomGradient","Controls","onPointerEnter","onPointerLeave","overrideQueue","queueKey","TitleBackdrop","initialSrc","wrapWithLink","wrapperClassName","primaryVideo","srcset","useImageSrcSet","playButton","VideoThumbnail","forceTitleBackdrop","thumbnailUrl","setThumbnailUrl","youtubeId","TitleBackdropFallback","useLogVideoPlay","playerRef","enabled","getCookie","EpisodePoster","rightAction","ArrowBackIcon","ArrowForwardIcon","TvIcon","seasonQueryKey","titleId","useSeason","fetchSeason","useSeasonEpisodes","urlParams","InfiniteScrollSentinel","isInitialLoading","fetchNextPage","loaderMarginTop","_variant","loadMoreExtraContent","loadMoreClickCount","setLoadMoreClickCount","innerVariant","sentinelEl","MediaEpisodesIcon","EpisodeSelector","trigger","EpisodeSelectorDialog","currentEpisode","onSelected","activeTab","setActiveTab","selectedSeason","setSelectedSeason","heading","showBackButton","EpisodeList","SeasonList","AnimatedPanel","selectedEpisodeId","FullPageLoader","EpisodeItem","isPlayable","SiteVideoPlayer","NativeVideoPlayer","EmbedPlayer","mediaItemId","relatedVideos","logPlays","showEpisodeSelector","logVideoPlay","mediaItem","videoToMediaItem","related","handleVisibilityChange","nextMedia","previous","getTitleChannelFilters","languages","countries","genres","ageRatings","restriction","genre","parseDateTime","useTitleIndexFilters","fetchStatus","useValueLists","useTitle","fetchTitle","EPISODE_MODEL","useCreateReview","createReview","onFormQueryError","RatingDialog","initialRating","deleteReview","currentRating","setCurrentRating","handleCreateReview","handleDeleteReview","DialogTitle","EpisodeDetails","TitleDetails","useCurrentUserRatings","useAuth","fetchRatings","useCurrentUserRatingFor","useAuthClickCapture","dialogContext","isLoggedIn","InteractableRating","isUpcoming","RateButton","rating","authHandler","EpisodeListItem","allowRating","EpisodeRating","FormattedDate","useScrollToTop","pathname","useLocation","previousPathname","titleSeasonsQueryKey","useTitleSeasons","SeasonPoster","PlayCircleIcon","VideoGrid","videos","VideoGridItem","showCategory","VideoGridItemBottomGradient","VideoGridItemSkeleton","useEpisode","fetchEpisode","PersonLink","person","getPersonLink","PersonPoster","rounded","PersonIcon","KnownForCompact","linkTarget","linkColor","usePerson","personId","fetchPerson","useNewsArticle","articleId","fetchNewsArticle","todoImage","useCreateList","createList","CrupdateUserListForm","SearchField","NoResultsMessage","CreateUserListPage","StaticPageTitle","useUpdateList","listId","EditUserListPage","PageContent","PageStatus","list","updateList","UserProfileLink"],"sources":["../../../node_modules/@tanstack/query-core/build/lib/infiniteQueryObserver.mjs","../../../node_modules/@tanstack/react-query/build/lib/useInfiniteQuery.mjs","../../../common/resources/client/datatable/filters/backend-filter.ts","../../../common/resources/client/utils/date/start-of-day.ts","../../../common/resources/client/utils/date/end-of-day.ts","../../../common/resources/client/i18n/get-user-timezone.ts","../../../common/resources/client/ui/forms/input-field/date/date-range-picker/dialog/date-range-presets.ts","../../../common/resources/client/icons/material/DateRange.tsx","../../../common/resources/client/ui/forms/input-field/input.tsx","../../../common/resources/client/ui/forms/input-field/date/date-range-picker/date-picker-field.tsx","../../../common/resources/client/ui/forms/input-field/date/utils.ts","../../../common/resources/client/ui/forms/input-field/date/use-base-date-picker-state.ts","../../../common/resources/client/i18n/use-current-date-time.ts","../../../common/resources/client/ui/forms/input-field/date/date-range-picker/use-date-range-picker-state.ts","../../../common/resources/client/icons/material/ArrowRightAlt.tsx","../../../common/resources/client/ui/forms/input-field/date/segments/utils/adjust-segment.ts","../../../common/resources/client/ui/forms/input-field/date/segments/utils/set-segment.ts","../../../common/resources/client/ui/forms/input-field/date/segments/utils/page-step.ts","../../../common/resources/client/ui/forms/input-field/date/segments/editable-date-segment.tsx","../../../common/resources/client/ui/forms/input-field/date/segments/literal-segment.tsx","../../../common/resources/client/ui/forms/input-field/date/segments/utils/get-segment-limits.ts","../../../common/resources/client/ui/forms/input-field/date/segments/date-segment-list.tsx","../../../common/resources/client/icons/material/KeyboardArrowLeft.tsx","../../../common/resources/client/icons/material/KeyboardArrowRight.tsx","../../../common/resources/client/ui/forms/input-field/date/calendar/calendar-cell.tsx","../../../common/resources/client/ui/forms/input-field/date/calendar/calendar-month.tsx","../../../common/resources/client/ui/forms/input-field/date/calendar/calendar.tsx","../../../common/resources/client/i18n/formatted-date-time-range.tsx","../../../common/resources/client/ui/forms/input-field/date/date-range-picker/dialog/date-preset-list.tsx","../../../common/resources/client/utils/hooks/is-tablet-media-query.ts","../../../common/resources/client/ui/forms/input-field/date/date-range-picker/dialog/date-range-dialog.tsx","../../../common/resources/client/ui/forms/input-field/date/date-range-picker/date-range-picker.tsx","../../../common/resources/client/ui/forms/input-field/date/date-range-picker/form-date-range-picker.tsx","../../../common/resources/client/ui/images/avatar.tsx","../../../common/resources/client/datatable/column-templates/name-with-avatar.tsx","../../../common/resources/client/datatable/filters/backend-filters-url-key.ts","../../../common/resources/client/datatable/filters/utils/decode-backend-filters.ts","../../../common/resources/client/datatable/filters/utils/encode-backend-filters.ts","../../../common/resources/client/datatable/filters/backend-filter-url-params.ts","../../../common/resources/client/datatable/requests/paginated-resources.ts","../../../common/resources/client/utils/keybinds/is-ctrl-key-pressed.ts","../../../common/resources/client/ui/tables/navigate-grid.ts","../../../common/resources/client/ui/tables/table-context.ts","../../../common/resources/client/ui/tables/style/use-table-cell-style.ts","../../../common/resources/client/ui/tables/table-cell.tsx","../../../common/resources/client/ui/interactions/use-pointer-events.ts","../../../common/resources/client/utils/keybinds/is-ctrl-or-shift-pressed.ts","../../../common/resources/client/ui/tables/style/use-table-row-style.ts","../../../common/resources/client/ui/tables/table-row.tsx","../../../common/resources/client/ui/tables/checkbox-column-config.tsx","../../../common/resources/client/icons/material/ArrowDownward.tsx","../../../common/resources/client/ui/tables/header-cell.tsx","../../../common/resources/client/ui/tables/table-header-row.tsx","../../../common/resources/client/ui/tables/table.tsx","../../../common/resources/client/http/backend-response/pagination-response.ts","../../../common/resources/client/icons/material/FilterAlt.tsx","../../../common/resources/client/ui/accordion/accordion.tsx","../../../common/resources/client/datatable/filters/panels/select-filter-panel.tsx","../../../common/resources/client/datatable/filters/panels/date-range-filter-panel.tsx","../../../common/resources/client/users/queries/use-normalized-models.ts","../../../common/resources/client/users/queries/use-normalized-model.ts","../../../common/resources/client/ui/forms/normalized-model-field.tsx","../../../common/resources/client/datatable/filters/panels/normalized-model-filter-panel.tsx","../../../common/resources/client/datatable/filters/filter-operator-names.ts","../../../common/resources/client/datatable/filters/panels/input-filter-panel.tsx","../../../common/resources/client/datatable/filters/panels/boolean-filter-panel.tsx","../../../common/resources/client/ui/forms/input-field/chip-field/chip-list.tsx","../../../common/resources/client/ui/forms/input-field/chip-field/string-to-chip-value.ts","../../../common/resources/client/ui/forms/input-field/chip-field/chip-field.tsx","../../../common/resources/client/ui/forms/input-field/chip-field/form-chip-field.tsx","../../../common/resources/client/datatable/filters/panels/chip-field-filter-panel.tsx","../../../common/resources/client/datatable/filters/add-filter-dialog.tsx","../../../common/resources/client/datatable/filters/add-filter-button.tsx","../../../common/resources/client/datatable/filters/filter-list/filter-list-trigger-button.tsx","../../../common/resources/client/datatable/filters/filter-list/filter-list-item-dialog-trigger.tsx","../../../common/resources/client/i18n/formatted-number.tsx","../../../common/resources/client/datatable/filters/filter-list/filter-list-control.tsx","../../../common/resources/client/datatable/filters/filter-list/filter-list.tsx","../../../common/resources/client/datatable/filters/filter-list/filter-list-skeleton.tsx","../../../common/resources/client/icons/material/Add.tsx","../../../common/resources/client/ui/forms/toggle/switch.tsx","../../../node_modules/zustand/esm/middleware.mjs","../../../common/resources/client/ui/forms/slider/base-slider.tsx","../../../common/resources/client/ui/forms/slider/use-slider.ts","../../../common/resources/client/ui/forms/slider/slider-thumb.tsx","../../../common/resources/client/ui/forms/slider/slider.tsx","../../../common/resources/client/utils/hooks/use-previous.ts","../../../common/resources/client/ui/interactions/dnd/drag-state.ts","../../../common/resources/client/ui/interactions/interactable-event.ts","../../../common/resources/client/ui/interactions/active-interaction.ts","../../../common/resources/client/ui/interactions/utils/dom-rect-to-obj.ts","../../../common/resources/client/ui/interactions/dnd/update-rects.ts","../../../common/resources/client/ui/interactions/dnd/use-draggable.ts","../../../common/resources/client/ui/interactions/dnd/read-files-from-data-transfer.ts","../../../common/resources/client/utils/array/async-iterable-to-array.ts","../../../common/resources/client/ui/interactions/dnd/use-droppable.ts","../../../common/resources/client/utils/array/move-item-in-array.ts","../../../common/resources/client/utils/array/move-item-in-new-array.ts","../../../common/resources/client/ui/interactions/dnd/use-sortable.ts","../../../node_modules/dot-object/index.js","../../../common/resources/client/icons/material/Tune.tsx","../../../common/resources/client/icons/material/MoreVert.tsx","../../../common/resources/client/ui/tabs/tabs-context.tsx","../../../common/resources/client/ui/tabs/tabs.tsx","../../../common/resources/client/ui/tabs/tab-line.tsx","../../../common/resources/client/ui/tabs/tab-list.tsx","../../../common/resources/client/ui/tabs/tab.tsx","../../../common/resources/client/icons/material/DragHandle.tsx","../../../common/resources/client/ui/interactions/dnd/drag-preview.tsx","../../../common/resources/client/utils/hooks/sticky-sentinel.ts","../../../common/resources/client/admin/crupdate-resource-layout.tsx","../../../common/resources/client/ui/overlays/dialog/image-zoom-dialog.tsx","../../../common/resources/client/icons/material/ChevronLeft.tsx","../../../common/resources/client/admin/channels/playlist.svg","../../../common/resources/client/channels/use-channel-query-params.ts","../../../common/resources/client/channels/requests/use-channel.ts","../../../common/resources/client/admin/channels/channel-editor/controls/content-model-field.tsx","../../../common/resources/client/utils/hooks/is-touch-device.ts","../../../common/resources/client/icons/material/Refresh.tsx","../../../common/resources/client/admin/channels/requests/use-update-channel-content.ts","../../../common/resources/client/admin/channels/channel-editor/channel-content-editor.tsx","../../../common/resources/client/admin/channels/requests/use-addable-content.ts","../../../common/resources/client/admin/channels/channel-editor/channel-content-search-field.tsx","../../../common/resources/client/icons/material/Image.tsx","../../../resources/client/admin/channels/channel-content-item-image.tsx","../../../common/resources/client/admin/channels/channel-editor/controls/content-order-field.tsx","../../../resources/client/titles/models/title.ts","../../../resources/client/titles/models/news-article.ts","../../../common/resources/client/channels/channel.ts","../../../resources/client/titles/models/person.ts","../../../common/resources/client/icons/material/GridView.tsx","../../../common/resources/client/icons/material/ViewWeek.tsx","../../../common/resources/client/icons/material/ViewList.tsx","../../../resources/client/admin/channels/channel-content-config.tsx","../../../resources/client/titles/models/genre.ts","../../../resources/client/titles/models/production-country.ts","../../../resources/client/news/news-article-link.tsx","../../../common/resources/client/icons/material/Newspaper.tsx","../../../resources/client/news/news-article-image.tsx","../../../common/resources/client/comments/requests/use-delete-comments.ts","../../../common/resources/client/ui/images/user-avatar.tsx","../../../common/resources/client/ui/infinite-scroll/use-infinite-data.ts","../../../resources/client/reviews/requests/use-reviews.ts","../../../resources/client/reviews/requests/use-delete-reviews.ts","../../../common/resources/client/icons/material/Star.tsx","../../../resources/client/reviews/title-rating.tsx","../../../common/resources/client/icons/material/StarBorder.tsx","../../../resources/client/reviews/review-list/star-selector.tsx","../../../resources/client/titles/bullet-separated-items.tsx","../../../common/resources/client/icons/material/Sort.tsx","../../../resources/client/reviews/review-list/review-list-sort-button.tsx","../../../resources/client/base-media-link.tsx","../../../resources/client/seasons/season-link.tsx","../../../resources/client/episodes/episode-link.tsx","../../../resources/client/episodes/compact-season-episode.tsx","../../../resources/client/titles/title-link.tsx","../../../resources/client/videos/watch-page/get-watch-link.ts","../../../common/resources/client/icons/media/media-play.tsx","../../../resources/client/titles/title-poster/title-poster.tsx","../../../resources/client/videos/video-player-skeleton.tsx","../../../common/resources/client/player/utils/guess-player-provider.ts","../../../common/resources/client/utils/array/shuffle-array.ts","../../../common/resources/client/player/utils/player-local-storage.ts","../../../common/resources/client/utils/array/prepend-to-array-at-index.ts","../../../common/resources/client/player/utils/reset-media-session.ts","../../../common/resources/client/player/player-queue.ts","../../../common/resources/client/player/handle-player-keybinds.ts","../../../common/resources/client/player/utils/init-player-media-session.ts","../../../common/resources/client/player/utils/is-same-media.ts","../../../common/resources/client/player/state/fullscreen/screen-orientation.ts","../../../common/resources/client/utils/platform.ts","../../../node_modules/fscreen/dist/fscreen.esm.js","../../../common/resources/client/player/state/fullscreen/create-native-fullscreen-adapter.ts","../../../common/resources/client/player/state/fullscreen/create-iphone-fullscreen-adapter.ts","../../../common/resources/client/player/state/fullscreen/fullscreen-slice.ts","../../../common/resources/client/player/state/pip/chrome-pip-adapter.ts","../../../common/resources/client/player/state/pip/safari-pip-adapter.ts","../../../common/resources/client/player/state/pip/pip-slice.ts","../../../common/resources/client/player/state/player-store.tsx","../../../common/resources/client/player/player-context.tsx","../../../common/resources/client/player/providers/youtube/youtube-types.ts","../../../common/resources/client/utils/number/is-number.ts","../../../common/resources/client/utils/http/load-image.ts","../../../common/resources/client/player/providers/youtube/load-youtube-poster.ts","../../../common/resources/client/player/providers/youtube/handle-youtube-embed-message.tsx","../../../common/resources/client/player/hooks/use-player-store.tsx","../../../common/resources/client/player/hooks/use-player-actions.ts","../../../common/resources/client/player/utils/youtube-id-from-src.ts","../../../common/resources/client/player/providers/youtube/use-youtube-provider-src.ts","../../../common/resources/client/player/providers/youtube/youtube-provider.tsx","../../../common/resources/client/utils/dom/create-ref-loop.ts","../../../common/resources/client/player/providers/html-media/use-html-media-internal-state.ts","../../../common/resources/client/player/providers/html-media/use-html-media-events.ts","../../../common/resources/client/player/providers/html-media/use-html-media-api.ts","../../../common/resources/client/player/providers/html-video-provider.tsx","../../../common/resources/client/player/providers/html-audio-provider.tsx","../../../common/resources/client/player/ui/player-outlet.tsx","../../../common/resources/client/icons/media/media-pause.tsx","../../../common/resources/client/player/ui/controls/play-button.tsx","../../../common/resources/client/icons/media/media-mute.tsx","../../../common/resources/client/icons/media/media-volume-low.tsx","../../../common/resources/client/icons/media/media-volume-high.tsx","../../../common/resources/client/player/ui/controls/volume-controls.tsx","../../../common/resources/client/player/hooks/use-current-time.ts","../../../common/resources/client/player/ui/controls/seeking/seekbar.tsx","../../../common/resources/client/i18n/formatted-duration.tsx","../../../common/resources/client/player/ui/controls/formatted-current-time.tsx","../../../common/resources/client/player/ui/controls/formatted-player-duration.tsx","../../../common/resources/client/icons/media/media-next.tsx","../../../common/resources/client/player/ui/controls/next-button.tsx","../../../common/resources/client/icons/media/media-fullscreen-exit.tsx","../../../common/resources/client/icons/media/media-fullscreen.tsx","../../../common/resources/client/player/ui/controls/fullscreen-button.tsx","../../../common/resources/client/icons/media/media-picture-in-picture-exit.tsx","../../../common/resources/client/icons/media/media-picture-in-picture.tsx","../../../common/resources/client/player/ui/controls/pip-button.tsx","../../../common/resources/client/icons/material/ArrowRight.tsx","../../../common/resources/client/icons/media/media-settings.tsx","../../../common/resources/client/icons/media/media-playback-speed-circle.tsx","../../../common/resources/client/icons/media/media-settings-menu.tsx","../../../common/resources/client/icons/media/media-closed-captions.tsx","../../../common/resources/client/icons/media/media-arrow-left.tsx","../../../common/resources/client/player/ui/controls/playback-options-button.tsx","../../../common/resources/client/icons/media/media-closed-captions-on.tsx","../../../common/resources/client/player/ui/controls/toggle-captions-button.tsx","../../../common/resources/client/player/ui/controls/player-poster.tsx","../../../common/resources/client/player/hooks/use-player-click-handler.ts","../../../common/resources/client/player/ui/controls/buffering-spinner.tsx","../../../common/resources/client/player/ui/video-player.tsx","../../../resources/client/titles/title-poster/title-backdrop.tsx","../../../resources/client/videos/video-thumbnail.tsx","../../../resources/client/videos/requests/use-log-video-play.ts","../../../resources/client/episodes/episode-poster/episode-poster.tsx","../../../common/resources/client/icons/material/ArrowBack.tsx","../../../common/resources/client/icons/material/ArrowForward.tsx","../../../common/resources/client/icons/material/Tv.tsx","../../../resources/client/seasons/requests/use-season.ts","../../../resources/client/titles/requests/use-season-episodes.ts","../../../common/resources/client/ui/infinite-scroll/infinite-scroll-sentinel.tsx","../../../common/resources/client/icons/media/media-episodes.tsx","../../../resources/client/videos/watch-page/episode-selector.tsx","../../../resources/client/videos/site-video-player.tsx","../../../resources/client/channels/channel-header/get-title-channel-filters.ts","../../../resources/client/titles/use-title-index-filters.ts","../../../resources/client/titles/requests/use-title.ts","../../../resources/client/titles/models/episode.ts","../../../resources/client/reviews/requests/use-create-review.ts","../../../resources/client/reviews/rating-dialog.tsx","../../../resources/client/reviews/requests/use-current-user-ratings.ts","../../../resources/client/use-auth-click-capture.ts","../../../resources/client/reviews/interactable-rating.tsx","../../../resources/client/seasons/episode-list-item.tsx","../../../common/resources/client/ui/navigation/use-scroll-to-top.ts","../../../resources/client/titles/requests/use-title-seasons.ts","../../../resources/client/seasons/season-poster.tsx","../../../common/resources/client/icons/material/PlayCircle.tsx","../../../resources/client/titles/video-grid.tsx","../../../resources/client/episodes/requests/use-episode.ts","../../../resources/client/people/person-link.tsx","../../../resources/client/people/person-poster/person-poster.tsx","../../../resources/client/people/known-for-compact.tsx","../../../resources/client/people/requests/use-person.ts","../../../resources/client/admin/news/requests/use-news-article.ts","../../../resources/client/admin/lists/todo.svg","../../../resources/client/user-lists/requests/use-create-list.ts","../../../resources/client/user-lists/pages/crupdate-user-list-form.tsx","../../../resources/client/user-lists/pages/create-user-list-page.tsx","../../../resources/client/user-lists/requests/use-update-list.ts","../../../resources/client/user-lists/pages/edit-user-list-page.tsx","../../../common/resources/client/users/user-profile-link.tsx"],"sourcesContent":["import { QueryObserver } from './queryObserver.mjs';\nimport { infiniteQueryBehavior, hasNextPage, hasPreviousPage } from './infiniteQueryBehavior.mjs';\n\nclass InfiniteQueryObserver extends QueryObserver {\n  // Type override\n  // Type override\n  // Type override\n  // eslint-disable-next-line @typescript-eslint/no-useless-constructor\n  constructor(client, options) {\n    super(client, options);\n  }\n\n  bindMethods() {\n    super.bindMethods();\n    this.fetchNextPage = this.fetchNextPage.bind(this);\n    this.fetchPreviousPage = this.fetchPreviousPage.bind(this);\n  }\n\n  setOptions(options, notifyOptions) {\n    super.setOptions({ ...options,\n      behavior: infiniteQueryBehavior()\n    }, notifyOptions);\n  }\n\n  getOptimisticResult(options) {\n    options.behavior = infiniteQueryBehavior();\n    return super.getOptimisticResult(options);\n  }\n\n  fetchNextPage({\n    pageParam,\n    ...options\n  } = {}) {\n    return this.fetch({ ...options,\n      meta: {\n        fetchMore: {\n          direction: 'forward',\n          pageParam\n        }\n      }\n    });\n  }\n\n  fetchPreviousPage({\n    pageParam,\n    ...options\n  } = {}) {\n    return this.fetch({ ...options,\n      meta: {\n        fetchMore: {\n          direction: 'backward',\n          pageParam\n        }\n      }\n    });\n  }\n\n  createResult(query, options) {\n    var _state$fetchMeta, _state$fetchMeta$fetc, _state$fetchMeta2, _state$fetchMeta2$fet, _state$data, _state$data2;\n\n    const {\n      state\n    } = query;\n    const result = super.createResult(query, options);\n    const {\n      isFetching,\n      isRefetching\n    } = result;\n    const isFetchingNextPage = isFetching && ((_state$fetchMeta = state.fetchMeta) == null ? void 0 : (_state$fetchMeta$fetc = _state$fetchMeta.fetchMore) == null ? void 0 : _state$fetchMeta$fetc.direction) === 'forward';\n    const isFetchingPreviousPage = isFetching && ((_state$fetchMeta2 = state.fetchMeta) == null ? void 0 : (_state$fetchMeta2$fet = _state$fetchMeta2.fetchMore) == null ? void 0 : _state$fetchMeta2$fet.direction) === 'backward';\n    return { ...result,\n      fetchNextPage: this.fetchNextPage,\n      fetchPreviousPage: this.fetchPreviousPage,\n      hasNextPage: hasNextPage(options, (_state$data = state.data) == null ? void 0 : _state$data.pages),\n      hasPreviousPage: hasPreviousPage(options, (_state$data2 = state.data) == null ? void 0 : _state$data2.pages),\n      isFetchingNextPage,\n      isFetchingPreviousPage,\n      isRefetching: isRefetching && !isFetchingNextPage && !isFetchingPreviousPage\n    };\n  }\n\n}\n\nexport { InfiniteQueryObserver };\n//# sourceMappingURL=infiniteQueryObserver.mjs.map\n","'use client';\nimport { parseQueryArgs, InfiniteQueryObserver } from '@tanstack/query-core';\nimport { useBaseQuery } from './useBaseQuery.mjs';\n\nfunction useInfiniteQuery(arg1, arg2, arg3) {\n  const options = parseQueryArgs(arg1, arg2, arg3);\n  return useBaseQuery(options, InfiniteQueryObserver);\n}\n\nexport { useInfiniteQuery };\n//# sourceMappingURL=useInfiniteQuery.mjs.map\n","import {ComponentType} from 'react';\nimport {MessageDescriptor} from '../../i18n/message-descriptor';\nimport {NormalizedModel} from '@common/datatable/filters/normalized-model';\nimport {ChipValue} from '@common/ui/forms/input-field/chip-field/chip-field';\nimport {AbsoluteDateRange} from '@common/ui/forms/input-field/date/date-range-picker/form-date-range-picker';\nimport {DateValue} from '@internationalized/date';\nimport {FilterListControlProps} from '@common/datatable/filters/filter-list/filter-list-control';\n\nexport interface FilterSelectControl {\n  type: FilterControlType.Select;\n  options: {label: MessageDescriptor; key: string | number; value: any}[];\n  defaultValue?: string | number | boolean;\n  placeholder?: MessageDescriptor;\n  searchPlaceholder?: MessageDescriptor;\n  showSearchField?: boolean;\n}\n\nexport interface FilterNumberInputControl {\n  type: FilterControlType.Input;\n  placeholder?: MessageDescriptor;\n  inputType: 'number';\n  minValue?: number;\n  maxValue?: number;\n  defaultValue: number;\n}\n\nexport interface FilterTextInputControl {\n  type: FilterControlType.Input;\n  placeholder?: MessageDescriptor;\n  inputType: 'string';\n  minLength?: number;\n  maxLength?: number;\n  defaultValue: string;\n}\n\nexport interface FilterSelectModelControl {\n  type: FilterControlType.SelectModel;\n  model: string;\n  defaultValue?: NormalizedModel;\n}\n\nexport interface FilterChipFieldControl {\n  type: FilterControlType.ChipField;\n  options: FilterSelectControl['options'];\n  placeholder?: MessageDescriptor;\n  defaultValue: ChipValue[];\n}\n\nexport interface FilterBooleanToggleControl {\n  type: FilterControlType.BooleanToggle;\n  // value can be something other than boolean, toggling will either send that value or nothing\n  defaultValue: string | number | boolean | null;\n}\n\nexport interface DatePickerFilterControl {\n  type: FilterControlType.DateRangePicker;\n  defaultValue: AbsoluteDateRange;\n  min?: DateValue;\n  max?: DateValue;\n}\n\nexport interface CustomFilterControl {\n  type: FilterControlType.Custom;\n  panel: ComponentType<{filter: BackendFilter<CustomFilterControl>}>;\n  listItem: ComponentType<FilterListControlProps<number, CustomFilterControl>>;\n  defaultValue?: any;\n}\n\nexport type FilterControl =\n  | FilterSelectControl\n  | FilterNumberInputControl\n  | FilterTextInputControl\n  | FilterSelectModelControl\n  | FilterChipFieldControl\n  | DatePickerFilterControl\n  | FilterBooleanToggleControl\n  | CustomFilterControl;\n\nexport interface BackendFilter<T = FilterControl> {\n  key: string;\n  label: MessageDescriptor;\n  description?: MessageDescriptor;\n  control: T;\n  defaultOperator: FilterOperator;\n  operators?: FilterOperator[];\n  extraFilters?: {key: string; operator: FilterOperator; value: any}[];\n}\n\nexport enum FilterControlType {\n  Select = 'select',\n  DateRangePicker = 'dateRangePicker',\n  SelectModel = 'selectModel',\n  Input = 'input',\n  BooleanToggle = 'booleanToggle',\n  ChipField = 'chipField',\n  Custom = 'custom',\n}\n\nexport enum FilterOperator {\n  eq = '=',\n  ne = '!=',\n  gt = '>',\n  gte = '>=',\n  lt = '<',\n  lte = '<=',\n  has = 'has',\n  hasAll = 'hasAll',\n  doesntHave = 'doesntHave',\n  between = 'between',\n}\n\nexport const ALL_PRIMITIVE_OPERATORS = [\n  FilterOperator.eq,\n  FilterOperator.ne,\n  FilterOperator.gt,\n  FilterOperator.gte,\n  FilterOperator.lt,\n  FilterOperator.lte,\n];\n","import {ZonedDateTime} from '@internationalized/date';\n\nexport function startOfDay(date: ZonedDateTime): ZonedDateTime {\n  return date.set({hour: 0, minute: 0, second: 0, millisecond: 0});\n}\n","import {ZonedDateTime} from '@internationalized/date';\n\nexport function endOfDay(date: ZonedDateTime): ZonedDateTime {\n  return date.set({\n    hour: 24 - 1,\n    minute: 60 - 1,\n    second: 60 - 1,\n    millisecond: 1000 - 1,\n  });\n}\n","import {getBootstrapData} from '../core/bootstrap-data/use-backend-bootstrap-data';\nimport {getLocalTimeZone} from '@internationalized/date';\n\nexport function getUserTimezone(): string {\n  const defaultTimezone = getBootstrapData()?.settings.dates.default_timezone;\n  const preferredTimezone =\n    getBootstrapData()?.user?.timezone || defaultTimezone || 'auto';\n\n  if (!preferredTimezone || preferredTimezone === 'auto') {\n    return getLocalTimeZone();\n  }\n  return preferredTimezone;\n}\n","import {DateRangeValue} from '../date-range-value';\nimport {message} from '@common/i18n/message';\nimport {MessageDescriptor} from '@common/i18n/message-descriptor';\nimport {\n  endOfWeek,\n  endOfYear,\n  now,\n  startOfWeek,\n  startOfYear,\n} from '@internationalized/date';\nimport {startOfDay} from '@common/utils/date/start-of-day';\nimport {endOfDay} from '@common/utils/date/end-of-day';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\nimport {getUserTimezone} from '@common/i18n/get-user-timezone';\n\nconst Now = startOfDay(now(getUserTimezone()));\nconst locale = getBootstrapData()?.i18n?.language || 'en';\n\nexport interface DateRangePreset {\n  key: number;\n  label: MessageDescriptor;\n  getRangeValue: () => DateRangeValue;\n}\n\nexport const DateRangePresets: DateRangePreset[] = [\n  {\n    key: 0,\n    label: message('Today'),\n    getRangeValue: () => ({\n      preset: 0,\n      start: Now,\n      end: endOfDay(Now),\n    }),\n  },\n  {\n    key: 1,\n    label: message('Yesterday'),\n    getRangeValue: () => ({\n      preset: 1,\n      start: Now.subtract({days: 1}),\n      end: endOfDay(Now).subtract({days: 1}),\n    }),\n  },\n  {\n    key: 2,\n    label: message('This week'),\n    getRangeValue: () => ({\n      preset: 2,\n      start: startOfWeek(Now, locale),\n      end: endOfWeek(endOfDay(Now), locale),\n    }),\n  },\n  {\n    key: 3,\n    label: message('Last week'),\n    getRangeValue: () => {\n      const start = startOfWeek(Now, locale).subtract({days: 7});\n      return {\n        preset: 3,\n        start,\n        end: start.add({days: 6}),\n      };\n    },\n  },\n  {\n    key: 4,\n    label: message('Last 7 days'),\n    getRangeValue: () => ({\n      preset: 4,\n      start: Now.subtract({days: 7}),\n      end: endOfDay(Now),\n    }),\n  },\n  {\n    key: 5,\n    label: message('Last 14 days'),\n    getRangeValue: () => ({\n      preset: 5,\n      start: Now.subtract({days: 14}),\n      end: endOfDay(Now),\n    }),\n  },\n  {\n    key: 6,\n    label: message('Last 30 days'),\n    getRangeValue: () => ({\n      preset: 6,\n      start: Now.subtract({days: 30}),\n      end: endOfDay(Now),\n    }),\n  },\n  {\n    key: 7,\n    label: message('Last 3 months'),\n    getRangeValue: () => ({\n      preset: 7,\n      start: Now.subtract({months: 3}),\n      end: endOfDay(Now),\n    }),\n  },\n  {\n    key: 8,\n    label: message('Last 12 months'),\n    getRangeValue: () => ({\n      preset: 8,\n      start: Now.subtract({months: 12}),\n      end: endOfDay(Now),\n    }),\n  },\n  {\n    key: 9,\n    label: message('This year'),\n    getRangeValue: () => ({\n      preset: 9,\n      start: startOfYear(Now),\n      end: endOfYear(endOfDay(Now)),\n    }),\n  },\n  {\n    key: 10,\n    label: message('Last year'),\n    getRangeValue: () => ({\n      preset: 10,\n      start: startOfYear(Now).subtract({years: 1}),\n      end: endOfYear(endOfDay(Now)).subtract({years: 1}),\n    }),\n  },\n];\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const DateRangeIcon = createSvgIcon(\n  <path d=\"M7 11h2v2H7v-2zm14-5v14c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2l.01-14c0-1.1.88-2 1.99-2h1V2h2v2h8V2h2v2h1c1.1 0 2 .9 2 2zM5 8h14V6H5v2zm14 12V10H5v10h14zm-4-7h2v-2h-2v2zm-4 0h2v-2h-2v2z\" />\n, 'DateRangeOutlined');\n","import {FocusScope} from '@react-aria/focus';\nimport React, {ComponentPropsWithoutRef, CSSProperties, ReactNode} from 'react';\nimport clsx from 'clsx';\n\ninterface InputProps {\n  className?: string;\n  children: ReactNode;\n  autoFocus?: boolean;\n  disabled?: boolean;\n  style?: CSSProperties;\n  inputProps?: ComponentPropsWithoutRef<'div'>;\n  wrapperProps?: ComponentPropsWithoutRef<'div'>;\n  onClick?: React.MouseEventHandler<HTMLDivElement>;\n}\n\nexport const Input = React.forwardRef<HTMLDivElement, InputProps>(\n  (props, ref) => {\n    const {\n      children,\n      inputProps,\n      wrapperProps,\n      className,\n      autoFocus,\n      style,\n      onClick,\n    } = props;\n\n    return (\n      <div {...wrapperProps} onClick={onClick}>\n        <div\n          {...inputProps}\n          role=\"group\"\n          className={clsx(\n            className,\n            'flex items-center focus-within:ring focus-within:ring-primary/focus focus-within:border-primary/60'\n          )}\n          ref={ref}\n          style={style}\n        >\n          <FocusScope autoFocus={autoFocus}>{children}</FocusScope>\n        </div>\n      </div>\n    );\n  }\n);\n","import React, {ComponentPropsWithoutRef, FocusEventHandler, Ref} from 'react';\nimport clsx from 'clsx';\nimport {createFocusManager} from '@react-aria/focus';\nimport {mergeProps, useObjectRef} from '@react-aria/utils';\nimport {getInputFieldClassNames} from '../../get-input-field-class-names';\nimport {Field, FieldProps} from '../../field';\nimport {Input} from '../../input';\nimport {useField} from '../../use-field';\n\nexport interface DatePickerFieldProps\n  extends Omit<FieldProps, 'fieldClassNames'> {\n  inputRef?: Ref<HTMLDivElement>;\n  onBlur?: FocusEventHandler;\n  showCalendarFooter?: boolean;\n}\nexport const DatePickerField = React.forwardRef<\n  HTMLDivElement,\n  DatePickerFieldProps\n>(({inputRef, wrapperProps, children, onBlur, ...other}, ref) => {\n  const fieldClassNames = getInputFieldClassNames(other);\n  const objRef = useObjectRef(ref);\n\n  const {fieldProps, inputProps} = useField({\n    ...other,\n    focusRef: objRef,\n    labelElementType: 'span',\n  });\n\n  fieldClassNames.wrapper = clsx(\n    fieldClassNames.wrapper,\n    other.disabled && 'pointer-events-none'\n  );\n\n  return (\n    <Field\n      wrapperProps={mergeProps<ComponentPropsWithoutRef<'div'>[]>(\n        wrapperProps!,\n        {\n          onBlur: e => {\n            if (!objRef.current.contains(e.relatedTarget)) {\n              onBlur?.(e);\n            }\n          },\n          onClick: () => {\n            // focus first segment when clicking on label or somewhere else in the field, but no directly on segment\n            const focusManager = createFocusManager(objRef);\n            focusManager.focusFirst();\n          },\n        }\n      )}\n      fieldClassNames={fieldClassNames}\n      ref={objRef}\n      {...fieldProps}\n    >\n      <Input\n        inputProps={inputProps}\n        className={clsx(fieldClassNames.input, 'gap-10')}\n        ref={inputRef}\n      >\n        {children}\n      </Input>\n    </Field>\n  );\n});\n","import {CalendarDate, DateValue} from '@internationalized/date';\n\nexport function getDefaultGranularity(date: DateValue) {\n  if (date instanceof CalendarDate) {\n    return 'day';\n  }\n  return 'minute';\n}\n\nexport function dateIsInvalid(\n  date: CalendarDate,\n  min?: DateValue,\n  max?: DateValue\n) {\n  return (\n    (min != null && date.compare(min) < 0) ||\n    (max != null && date.compare(max) > 0)\n  );\n}\n","import {useState} from 'react';\nimport {DateValue, toZoned, ZonedDateTime} from '@internationalized/date';\nimport {getDefaultGranularity} from './utils';\nimport type {DatePickerValueProps} from './date-picker/use-date-picker-state';\nimport {DateRangeValue} from './date-range-picker/date-range-value';\nimport {useUserTimezone} from '@common/i18n/use-user-timezone';\n\nexport function useBaseDatePickerState(\n  selectedDate: DateValue,\n  props:\n    | DatePickerValueProps<ZonedDateTime>\n    | DatePickerValueProps<Partial<DateRangeValue>, DateRangeValue>\n) {\n  const timezone = useUserTimezone();\n  const [calendarIsOpen, setCalendarIsOpen] = useState(false);\n  const closeDialogOnSelection = props.closeDialogOnSelection ?? true;\n\n  const granularity = props.granularity || getDefaultGranularity(selectedDate);\n  const min = props.min ? toZoned(props.min, timezone) : undefined;\n  const max = props.max ? toZoned(props.max, timezone) : undefined;\n\n  return {\n    timezone,\n    granularity,\n    min,\n    max,\n    calendarIsOpen,\n    setCalendarIsOpen,\n    closeDialogOnSelection,\n  };\n}\n","import {useMemo} from 'react';\nimport {now} from '@internationalized/date';\nimport {useUserTimezone} from './use-user-timezone';\n\nexport function useCurrentDateTime() {\n  const timezone = useUserTimezone();\n  return useMemo(() => {\n    return now(timezone);\n  }, [timezone]);\n}\n","import {useControlledState} from '@react-stately/utils';\nimport {HTMLAttributes, useCallback, useState} from 'react';\nimport {\n  CalendarDate,\n  DateValue,\n  endOfMonth,\n  isSameDay,\n  isSameMonth,\n  maxDate,\n  minDate,\n  startOfMonth,\n  toCalendarDate,\n  toZoned,\n  ZonedDateTime,\n} from '@internationalized/date';\nimport {\n  BaseDatePickerState,\n  DatePickerValueProps,\n} from '../date-picker/use-date-picker-state';\nimport {DateRangeValue} from './date-range-value';\nimport {useBaseDatePickerState} from '../use-base-date-picker-state';\nimport {startOfDay} from '@common/utils/date/start-of-day';\nimport {endOfDay} from '@common/utils/date/end-of-day';\nimport {useCurrentDateTime} from '@common/i18n/use-current-date-time';\n\nexport interface IsPlaceholderValue {\n  start: boolean;\n  end: boolean;\n}\n\nexport type DateRangePickerState = BaseDatePickerState<\n  DateRangeValue,\n  IsPlaceholderValue\n>;\n\nexport function useDateRangePickerState(\n  props: DatePickerValueProps<Partial<DateRangeValue>, DateRangeValue>\n): DateRangePickerState {\n  const now = useCurrentDateTime();\n  const [isPlaceholder, setIsPlaceholder] = useState<IsPlaceholderValue>({\n    start: (!props.value || !props.value.start) && !props.defaultValue?.start,\n    end: (!props.value || !props.value.end) && !props.defaultValue?.end,\n  });\n\n  // if user clears the date, we will want to still keep an\n  // instance internally, but return null via \"onChange\" callback\n  const setStateValue = props.onChange;\n  const [internalValue, setInternalValue] = useControlledState(\n    props.value ? completeRange(props.value, now) : undefined,\n    !props.value ? completeRange(props.defaultValue, now) : undefined,\n    props.onChange\n  );\n\n  const {\n    min,\n    max,\n    granularity,\n    timezone,\n    calendarIsOpen,\n    setCalendarIsOpen,\n    closeDialogOnSelection,\n  } = useBaseDatePickerState(internalValue.start, props);\n\n  const clear = useCallback(() => {\n    setIsPlaceholder({start: true, end: true});\n    setInternalValue(completeRange(null, now));\n    setStateValue?.(null);\n    setCalendarIsOpen(false);\n  }, [now, setInternalValue, setStateValue, setCalendarIsOpen]);\n\n  const [anchorDate, setAnchorDate] = useState<CalendarDate | null>(null);\n  const [isHighlighting, setIsHighlighting] = useState(false);\n  const [highlightedRange, setHighlightedRange] =\n    useState<DateRangeValue>(internalValue);\n  const [calendarDates, setCalendarDates] = useState<CalendarDate[]>(() => {\n    return rangeToCalendarDates(internalValue, max);\n  });\n\n  const constrainRange = useCallback(\n    (range: DateRangeValue): DateRangeValue => {\n      let start = range.start;\n      let end = range.end;\n\n      // make sure start date is after min date and before max date/range end\n      if (min) {\n        start = maxDate(start, min);\n      }\n      const startMax = max ? minDate(max, end) : end;\n      start = minDate(start, startMax);\n\n      // make sure end date is after min date/range start and before max date\n      const endMin = min ? maxDate(min, start) : start;\n      end = maxDate(end, endMin);\n\n      if (max) {\n        end = minDate(end, max);\n      }\n\n      return {start: toZoned(start, timezone), end: toZoned(end, timezone)};\n    },\n    [min, max, timezone]\n  );\n\n  const setSelectedValue = useCallback(\n    (newRange: DateRangeValue) => {\n      const value = {\n        ...constrainRange(newRange),\n        preset: newRange.preset,\n      };\n      setInternalValue(value);\n      setHighlightedRange(value);\n      setCalendarDates(rangeToCalendarDates(value, max));\n      setIsPlaceholder({start: false, end: false});\n    },\n    [setInternalValue, constrainRange, max]\n  );\n\n  const dayIsActive = useCallback(\n    (day: CalendarDate) => {\n      return (\n        (!isPlaceholder.start && isSameDay(day, highlightedRange.start)) ||\n        (!isPlaceholder.end && isSameDay(day, highlightedRange.end))\n      );\n    },\n    [highlightedRange, isPlaceholder]\n  );\n\n  const dayIsHighlighted = useCallback(\n    (day: CalendarDate) => {\n      return (\n        (isHighlighting || (!isPlaceholder.start && !isPlaceholder.end)) &&\n        day.compare(highlightedRange.start) >= 0 &&\n        day.compare(highlightedRange.end) <= 0\n      );\n    },\n    [highlightedRange, isPlaceholder, isHighlighting]\n  );\n\n  const dayIsRangeStart = useCallback(\n    (day: CalendarDate) => isSameDay(day, highlightedRange.start),\n    [highlightedRange]\n  );\n\n  const dayIsRangeEnd = useCallback(\n    (day: CalendarDate) => isSameDay(day, highlightedRange.end),\n    [highlightedRange]\n  );\n\n  const getCellProps = useCallback(\n    (date: CalendarDate, isSameMonth: boolean): HTMLAttributes<HTMLElement> => {\n      return {\n        onPointerEnter: () => {\n          if (isHighlighting && isSameMonth) {\n            setHighlightedRange(\n              makeRange({start: anchorDate!, end: date, timezone})\n            );\n          }\n        },\n        onClick: () => {\n          if (!isHighlighting) {\n            setIsHighlighting(true);\n            setAnchorDate(date);\n            setHighlightedRange(makeRange({start: date, end: date, timezone}));\n          } else {\n            const finalRange = makeRange({\n              start: startOfDay(toZoned(anchorDate!, timezone)),\n              end: endOfDay(toZoned(date, timezone)),\n              timezone,\n            });\n            setIsHighlighting(false);\n            setAnchorDate(null);\n            setSelectedValue?.(finalRange);\n            if (closeDialogOnSelection) {\n              setCalendarIsOpen?.(false);\n            }\n          }\n        },\n      };\n    },\n    [\n      anchorDate,\n      isHighlighting,\n      setSelectedValue,\n      setCalendarIsOpen,\n      closeDialogOnSelection,\n      timezone,\n    ]\n  );\n\n  return {\n    selectedValue: internalValue,\n    setSelectedValue,\n    calendarIsOpen,\n    setCalendarIsOpen,\n    dayIsActive,\n    dayIsHighlighted,\n    dayIsRangeStart,\n    dayIsRangeEnd,\n    getCellProps,\n    calendarDates,\n    setIsPlaceholder,\n    isPlaceholder,\n    clear,\n    setCalendarDates,\n    min,\n    max,\n    granularity,\n    timezone,\n    closeDialogOnSelection,\n  };\n}\n\nfunction rangeToCalendarDates(\n  range: DateRangeValue,\n  max?: DateValue\n): CalendarDate[] {\n  let start = toCalendarDate(startOfMonth(range.start));\n  let end = toCalendarDate(endOfMonth(range.end));\n\n  // make sure we don't show the same month twice\n  if (isSameMonth(start, end)) {\n    end = endOfMonth(end.add({months: 1}));\n  }\n\n  // if next month is disabled, show previous instead\n  if (max && end.compare(max) > 0) {\n    end = start;\n    start = startOfMonth(start.subtract({months: 1}));\n  }\n  return [start, end];\n}\n\ninterface MakeRangeProps {\n  start: DateValue;\n  end: DateValue;\n  timezone: string;\n}\nfunction makeRange(props: MakeRangeProps): DateRangeValue {\n  const start = toZoned(props.start, props.timezone);\n  const end = toZoned(props.end, props.timezone);\n  if (start.compare(end) > 0) {\n    return {start: end, end: start};\n  }\n  return {start, end};\n}\n\nfunction completeRange(\n  range: Partial<DateRangeValue> | null | undefined,\n  now: ZonedDateTime\n): DateRangeValue {\n  if (range?.start && range?.end) {\n    return range as DateRangeValue;\n  } else if (!range?.start && range?.end) {\n    range.start = range.end.subtract({months: 1});\n    return range as DateRangeValue;\n  } else if (!range?.end && range?.start) {\n    range.end = range.start.add({months: 1});\n    return range as DateRangeValue;\n  }\n  return {start: now, end: now.add({months: 1})};\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ArrowRightAltIcon = createSvgIcon(\n  <path d=\"M16.01 11H4v2h12.01v3L20 12l-3.99-4v3z\" />\n, 'ArrowRightAltOutlined');\n","import {ZonedDateTime} from '@internationalized/date';\n\nexport function adjustSegment(\n  value: ZonedDateTime,\n  part: string,\n  amount: number,\n  options: Intl.ResolvedDateTimeFormatOptions\n) {\n  switch (part) {\n    case 'era':\n    case 'year':\n    case 'month':\n    case 'day':\n      return value.cycle(part, amount, {round: part === 'year'});\n  }\n\n  if ('hour' in value) {\n    switch (part) {\n      case 'dayPeriod': {\n        const hours = value.hour;\n        const isPM = hours >= 12;\n        return value.set({hour: isPM ? hours - 12 : hours + 12});\n      }\n      case 'hour':\n      case 'minute':\n      case 'second':\n        return value.cycle(part, amount, {\n          round: part !== 'hour',\n          hourCycle: options.hour12 ? 12 : 24,\n        });\n    }\n  }\n\n  return value;\n}\n","import {ZonedDateTime} from '@internationalized/date';\n\nexport function setSegment(\n  value: ZonedDateTime,\n  part: string,\n  segmentValue: number,\n  options: Intl.ResolvedDateTimeFormatOptions\n) {\n  switch (part) {\n    case 'day':\n    case 'month':\n    case 'year':\n      return value.set({[part]: segmentValue});\n  }\n\n  if ('hour' in value) {\n    switch (part) {\n      case 'dayPeriod': {\n        const hours = value.hour;\n        const wasPM = hours >= 12;\n        const isPM = segmentValue >= 12;\n        if (isPM === wasPM) {\n          return value;\n        }\n        return value.set({hour: wasPM ? hours - 12 : hours + 12});\n      }\n      case 'hour':\n        // In 12 hour time, ensure that AM/PM does not change\n        if (options.hour12) {\n          const hours = value.hour;\n          const wasPM = hours >= 12;\n          if (!wasPM && segmentValue === 12) {\n            segmentValue = 0;\n          }\n          if (wasPM && segmentValue < 12) {\n            segmentValue += 12;\n          }\n        }\n      // fallthrough\n      case 'minute':\n      case 'second':\n        return value.set({[part]: segmentValue});\n    }\n  }\n\n  return value;\n}\n","export const PAGE_STEP = {\n  year: 5,\n  month: 2,\n  day: 7,\n  hour: 2,\n  minute: 15,\n  second: 15,\n  dayPeriod: 1,\n};\n","import {useFocusManager} from '@react-aria/focus';\nimport React, {\n  ComponentPropsWithoutRef,\n  HTMLAttributes,\n  KeyboardEventHandler,\n  useMemo,\n  useRef,\n} from 'react';\nimport {NumberParser} from '@internationalized/number';\nimport {mergeProps} from '@react-aria/utils';\nimport {today, ZonedDateTime} from '@internationalized/date';\nimport {useSelectedLocale} from '../../../../../i18n/selected-locale';\nimport {useDateFormatter} from '../../../../../i18n/use-date-formatter';\nimport {DatePickerState} from '../date-picker/use-date-picker-state';\nimport {adjustSegment} from './utils/adjust-segment';\nimport {setSegment} from './utils/set-segment';\nimport {PAGE_STEP} from './utils/page-step';\nimport {DateRangePickerState} from '../date-range-picker/use-date-range-picker-state';\nimport {useIsMobileMediaQuery} from '../../../../../utils/hooks/is-mobile-media-query';\n\nexport interface EditableSegment {\n  type: 'day' | 'dayPeriod' | 'hour' | 'minute' | 'month' | 'second' | 'year';\n  text: string;\n  value: number;\n  minValue: number;\n  maxValue: number;\n  minLength: number;\n}\n\ninterface DatePickerSegmentProps {\n  segment: EditableSegment;\n  domProps?: ComponentPropsWithoutRef<'div'>;\n  state: DatePickerState | DateRangePickerState;\n  value: ZonedDateTime;\n  onChange: (newValue: ZonedDateTime) => void;\n  isPlaceholder?: boolean;\n}\nexport function EditableDateSegment({\n  segment,\n  domProps,\n  value,\n  onChange,\n  isPlaceholder,\n  state: {timezone, calendarIsOpen, setCalendarIsOpen},\n}: DatePickerSegmentProps) {\n  const isMobile = useIsMobileMediaQuery();\n  const enteredKeys = useRef('');\n  const {localeCode} = useSelectedLocale();\n  const focusManager = useFocusManager();\n  const formatter = useDateFormatter({timeZone: timezone});\n  const parser = useMemo(\n    () => new NumberParser(localeCode, {maximumFractionDigits: 0}),\n    [localeCode]\n  );\n\n  const setSegmentValue = (newValue: number) => {\n    onChange(\n      setSegment(value, segment.type, newValue, formatter.resolvedOptions())\n    );\n  };\n\n  const adjustSegmentValue = (amount: number) => {\n    onChange(\n      adjustSegment(value, segment.type, amount, formatter.resolvedOptions())\n    );\n  };\n\n  const backspace = () => {\n    if (parser.isValidPartialNumber(segment.text)) {\n      const newValue = segment.text.slice(0, -1);\n      const parsed = parser.parse(newValue);\n      if (newValue.length === 0 || parsed === 0) {\n        const now = today(timezone);\n        if (segment.type in now) {\n          // @ts-ignore\n          setSegmentValue(now[segment.type]);\n        }\n      } else {\n        setSegmentValue(parsed);\n      }\n      enteredKeys.current = newValue;\n    } else if (segment.type === 'dayPeriod') {\n      adjustSegmentValue(-1);\n    }\n  };\n\n  const onKeyDown: KeyboardEventHandler = e => {\n    if (e.ctrlKey || e.metaKey || e.shiftKey || e.altKey) {\n      return;\n    }\n\n    // Navigation between date segments and deletion\n    switch (e.key) {\n      case 'ArrowLeft':\n        e.preventDefault();\n        e.stopPropagation();\n        focusManager.focusPrevious();\n        break;\n      case 'ArrowRight':\n        e.preventDefault();\n        e.stopPropagation();\n        focusManager.focusNext();\n        break;\n      case 'Enter':\n        (e.target as HTMLElement).closest('form')?.requestSubmit();\n        setCalendarIsOpen(!calendarIsOpen);\n        break;\n      case 'Tab':\n        break;\n      case 'Backspace':\n      case 'Delete': {\n        e.preventDefault();\n        e.stopPropagation();\n        backspace();\n        break;\n      }\n\n      // Spinbutton incrementing/decrementing\n      case 'ArrowUp':\n        e.preventDefault();\n        enteredKeys.current = '';\n        adjustSegmentValue(1);\n        break;\n      case 'ArrowDown':\n        e.preventDefault();\n        enteredKeys.current = '';\n        adjustSegmentValue(-1);\n        break;\n      case 'PageUp':\n        e.preventDefault();\n        enteredKeys.current = '';\n        adjustSegmentValue(PAGE_STEP[segment.type] || 1);\n        break;\n      case 'PageDown':\n        e.preventDefault();\n        enteredKeys.current = '';\n        adjustSegmentValue(-(PAGE_STEP[segment.type] || 1));\n        break;\n      case 'Home':\n        e.preventDefault();\n        enteredKeys.current = '';\n        setSegmentValue(segment.maxValue);\n        break;\n      case 'End':\n        e.preventDefault();\n        enteredKeys.current = '';\n        setSegmentValue(segment.minValue);\n        break;\n    }\n\n    onInput(e.key);\n  };\n\n  const amPmFormatter = useDateFormatter({hour: 'numeric', hour12: true});\n  const am = useMemo(() => {\n    const amDate = new Date();\n    amDate.setHours(0);\n    return amPmFormatter\n      .formatToParts(amDate)\n      .find(part => part.type === 'dayPeriod')!.value;\n  }, [amPmFormatter]);\n  const pm = useMemo(() => {\n    const pmDate = new Date();\n    pmDate.setHours(12);\n    return amPmFormatter\n      .formatToParts(pmDate)\n      .find(part => part.type === 'dayPeriod')!.value;\n  }, [amPmFormatter]);\n\n  // Update date values on user keyboard input\n  const onInput = (key: string) => {\n    const newValue = enteredKeys.current + key;\n\n    switch (segment.type) {\n      case 'dayPeriod':\n        if (am.toLowerCase().startsWith(key)) {\n          setSegmentValue(0);\n        } else if (pm.toLowerCase().startsWith(key)) {\n          setSegmentValue(12);\n        } else {\n          break;\n        }\n        focusManager.focusNext();\n        break;\n      case 'day':\n      case 'hour':\n      case 'minute':\n      case 'second':\n      case 'month':\n      case 'year': {\n        if (!parser.isValidPartialNumber(newValue)) {\n          return;\n        }\n\n        let numberValue = parser.parse(newValue);\n        let segmentValue = numberValue;\n        let allowsZero = segment.minValue === 0;\n        if (segment.type === 'hour' && formatter.resolvedOptions().hour12) {\n          switch (formatter.resolvedOptions().hourCycle) {\n            case 'h11':\n              if (numberValue > 11) {\n                segmentValue = parser.parse(key);\n              }\n              break;\n            case 'h12':\n              allowsZero = false;\n              if (numberValue > 12) {\n                segmentValue = parser.parse(key);\n              }\n              break;\n          }\n\n          if (segment.value >= 12 && numberValue > 1) {\n            numberValue += 12;\n          }\n        } else if (numberValue > segment.maxValue) {\n          segmentValue = parser.parse(key);\n        }\n\n        if (Number.isNaN(numberValue)) {\n          return;\n        }\n\n        const shouldSetValue = segmentValue !== 0 || allowsZero;\n        if (shouldSetValue) {\n          setSegmentValue(segmentValue);\n        }\n\n        if (\n          Number(`${numberValue}0`) > segment.maxValue ||\n          newValue.length >= String(segment.maxValue).length\n        ) {\n          enteredKeys.current = '';\n          if (shouldSetValue) {\n            focusManager.focusNext();\n          }\n        } else {\n          enteredKeys.current = newValue;\n        }\n        break;\n      }\n    }\n  };\n\n  const spinButtonProps: HTMLAttributes<HTMLDivElement> = isMobile\n    ? {}\n    : {\n        'aria-label': segment.type,\n        'aria-valuetext': isPlaceholder ? undefined : `${segment.value}`,\n        'aria-valuemin': segment.minValue,\n        'aria-valuemax': segment.maxValue,\n        'aria-valuenow': isPlaceholder ? undefined : segment.value,\n        tabIndex: 0,\n        onKeyDown,\n      };\n\n  return (\n    <div\n      {...mergeProps(domProps!, {\n        ...spinButtonProps,\n        onFocus: e => {\n          enteredKeys.current = '';\n          e.target.scrollIntoView({block: 'nearest'});\n        },\n        onClick: e => {\n          e.preventDefault();\n          e.stopPropagation();\n        },\n      } as HTMLAttributes<HTMLDivElement>)}\n      className=\"p-2 outline-none caret-transparent cursor-default rounded focus:bg-primary focus:text-on-primary select-none whitespace-nowrap box-content tabular-nums text-center\"\n    >\n      {segment.text.padStart(segment.minLength, '0')}\n    </div>\n  );\n}\n","import {useFocusManager} from '@react-aria/focus';\nimport {ComponentPropsWithoutRef} from 'react';\n\nexport interface LiteralSegment {\n  type: 'literal';\n  minLength: 1;\n  text: string;\n}\n\ninterface LiteralSegmentProps extends ComponentPropsWithoutRef<'div'> {\n  segment: LiteralSegment;\n  domProps?: ComponentPropsWithoutRef<'div'>;\n}\nexport function LiteralDateSegment({segment, domProps}: LiteralSegmentProps) {\n  const focusManager = useFocusManager();\n  return (\n    <div\n      {...domProps}\n      onPointerDown={e => {\n        if (e.pointerType === 'mouse') {\n          e.preventDefault();\n          const res = focusManager.focusNext({from: e.target as HTMLElement});\n          if (!res) {\n            focusManager.focusPrevious({from: e.target as HTMLElement});\n          }\n        }\n      }}\n      aria-hidden\n      className=\"min-w-4 cursor-default select-none\"\n    >\n      {segment.text}\n    </div>\n  );\n}\n","import {\n  DateValue,\n  getMinimumDayInMonth,\n  getMinimumMonthInYear,\n} from '@internationalized/date';\n\nexport function getSegmentLimits(\n  date: DateValue,\n  type: string,\n  options: Intl.ResolvedDateTimeFormatOptions\n) {\n  switch (type) {\n    case 'year':\n      return {\n        value: date.year,\n        placeholder: 'yyyy',\n        minValue: 1,\n        maxValue: date.calendar.getYearsInEra(date),\n      };\n    case 'month':\n      return {\n        value: date.month,\n        placeholder: 'mm',\n        minValue: getMinimumMonthInYear(date),\n        maxValue: date.calendar.getMonthsInYear(date),\n      };\n    case 'day':\n      return {\n        value: date.day,\n        minValue: getMinimumDayInMonth(date),\n        maxValue: date.calendar.getDaysInMonth(date),\n        placeholder: 'dd',\n      };\n  }\n\n  if ('hour' in date) {\n    switch (type) {\n      case 'dayPeriod':\n        return {\n          value: date.hour >= 12 ? 12 : 0,\n          minValue: 0,\n          maxValue: 12,\n          placeholder: '--',\n        };\n      case 'hour':\n        if (options.hour12) {\n          const isPM = date.hour >= 12;\n          return {\n            value: date.hour,\n            minValue: isPM ? 12 : 0,\n            maxValue: isPM ? 23 : 11,\n            placeholder: '--',\n          };\n        }\n\n        return {\n          value: date.hour,\n          minValue: 0,\n          maxValue: 23,\n          placeholder: '--',\n        };\n      case 'minute':\n        return {\n          value: date.minute,\n          minValue: 0,\n          maxValue: 59,\n          placeholder: '--',\n        };\n    }\n  }\n\n  return {};\n}\n","import React, {ComponentPropsWithoutRef, useMemo} from 'react';\nimport {ZonedDateTime} from '@internationalized/date';\nimport {EditableDateSegment, EditableSegment} from './editable-date-segment';\nimport {LiteralDateSegment, LiteralSegment} from './literal-segment';\nimport {useDateFormatter} from '@common/i18n/use-date-formatter';\nimport {DatePickerState} from '../date-picker/use-date-picker-state';\nimport {getSegmentLimits} from './utils/get-segment-limits';\nimport {DateRangePickerState} from '../date-range-picker/use-date-range-picker-state';\n\ninterface DateSegmentListProps {\n  segmentProps?: ComponentPropsWithoutRef<'div'>;\n  state: DatePickerState | DateRangePickerState;\n  value: ZonedDateTime;\n  onChange: (newValue: ZonedDateTime) => void;\n  isPlaceholder?: boolean;\n}\nexport function DateSegmentList({\n  segmentProps,\n  state,\n  value,\n  onChange,\n  isPlaceholder,\n}: DateSegmentListProps) {\n  const {granularity} = state;\n  const options = useMemo(() => {\n    const memoOptions: Intl.DateTimeFormatOptions = {\n      year: 'numeric',\n      month: 'numeric',\n      day: 'numeric',\n    };\n    if (granularity === 'minute') {\n      memoOptions.hour = 'numeric';\n      memoOptions.minute = 'numeric';\n    }\n    return memoOptions;\n  }, [granularity]);\n\n  const formatter = useDateFormatter(options);\n\n  const dateValue = useMemo(() => value.toDate(), [value]);\n  const segments = useMemo(() => {\n    return formatter.formatToParts(dateValue).map(segment => {\n      const limits = getSegmentLimits(\n        value,\n        segment.type,\n        formatter.resolvedOptions()\n      );\n      const textValue =\n        isPlaceholder && segment.type !== 'literal'\n          ? limits.placeholder\n          : segment.value;\n      return {\n        type: segment.type,\n        text: segment.value === ', ' ? ' ' : textValue,\n        ...limits,\n        minLength:\n          segment.type !== 'literal' ? String(limits.maxValue).length : 1,\n      } as LiteralSegment | EditableSegment;\n    });\n  }, [dateValue, formatter, isPlaceholder, value]);\n\n  return (\n    <div className=\"flex items-center\">\n      {segments.map((segment, index) => {\n        if (segment.type === 'literal') {\n          return (\n            <LiteralDateSegment\n              domProps={segmentProps}\n              key={index}\n              segment={segment}\n            />\n          );\n        }\n        return (\n          <EditableDateSegment\n            isPlaceholder={isPlaceholder}\n            domProps={segmentProps}\n            state={state}\n            value={value}\n            onChange={onChange}\n            segment={segment}\n            key={index}\n          />\n        );\n      })}\n    </div>\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const KeyboardArrowLeftIcon = createSvgIcon(\n  <path d=\"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z\" />\n, 'KeyboardArrowLeftOutlined');\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const KeyboardArrowRightIcon = createSvgIcon(\n  <path d=\"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z\" />\n, 'KeyboardArrowRightOutlined');\n","import React from 'react';\nimport clsx from 'clsx';\nimport {\n  CalendarDate,\n  DateValue,\n  getDayOfWeek,\n  isSameMonth,\n  isToday,\n} from '@internationalized/date';\nimport {useSelectedLocale} from '../../../../../i18n/selected-locale';\nimport {DatePickerState} from '../date-picker/use-date-picker-state';\nimport {dateIsInvalid} from '../utils';\nimport {DateRangePickerState} from '../date-range-picker/use-date-range-picker-state';\n\ninterface CalendarCellProps {\n  date: CalendarDate;\n  currentMonth: DateValue;\n  state: DatePickerState | DateRangePickerState;\n}\nexport function CalendarCell({\n  date,\n  currentMonth,\n  state: {\n    dayIsActive,\n    dayIsHighlighted,\n    dayIsRangeStart,\n    dayIsRangeEnd,\n    getCellProps,\n    timezone,\n    min,\n    max,\n  },\n}: CalendarCellProps) {\n  const {localeCode} = useSelectedLocale();\n  const dayOfWeek = getDayOfWeek(date, localeCode);\n  const isActive = dayIsActive(date);\n  const isHighlighted = dayIsHighlighted(date);\n  const isRangeStart = dayIsRangeStart(date);\n  const isRangeEnd = dayIsRangeEnd(date);\n  const dayIsToday = isToday(date, timezone);\n  const sameMonth = isSameMonth(date, currentMonth);\n  const isDisabled = dateIsInvalid(date, min, max);\n\n  return (\n    <div\n      role=\"button\"\n      aria-disabled={isDisabled}\n      className={clsx(\n        'w-40 h-40 text-sm relative isolate flex-shrink-0',\n        isDisabled && 'text-disabled pointer-events-none',\n        !sameMonth && 'invisible pointer-events-none'\n      )}\n      {...getCellProps(date, sameMonth)}\n    >\n      <span\n        className={clsx(\n          'absolute inset-0 flex items-center justify-center rounded-full w-full h-full select-none z-10 cursor-pointer',\n          !isActive && !dayIsToday && 'hover:bg-hover',\n          isActive && 'bg-primary text-on-primary font-semibold',\n          dayIsToday && !isActive && 'bg-chip'\n        )}\n      >\n        {date.day}\n      </span>\n      {isHighlighted && sameMonth && (\n        <span\n          className={clsx(\n            'absolute w-full h-full inset-0 bg-primary/focus',\n            (isRangeStart || dayOfWeek === 0 || date.day === 1) &&\n              'rounded-l-full',\n            (isRangeEnd ||\n              dayOfWeek === 6 ||\n              date.day ===\n                currentMonth.calendar.getDaysInMonth(currentMonth)) &&\n              'rounded-r-full'\n          )}\n        />\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport clsx from 'clsx';\nimport {m} from 'framer-motion';\nimport {\n  CalendarDate,\n  endOfMonth,\n  getWeeksInMonth,\n  startOfMonth,\n  startOfWeek,\n} from '@internationalized/date';\nimport {KeyboardArrowLeftIcon} from '../../../../../icons/material/KeyboardArrowLeft';\nimport {IconButton} from '../../../../buttons/icon-button';\nimport {KeyboardArrowRightIcon} from '../../../../../icons/material/KeyboardArrowRight';\nimport {CalendarCell} from './calendar-cell';\nimport {DatePickerState} from '../date-picker/use-date-picker-state';\nimport {useDateFormatter} from '../../../../../i18n/use-date-formatter';\nimport {useSelectedLocale} from '../../../../../i18n/selected-locale';\nimport {dateIsInvalid} from '../utils';\nimport {DateRangePickerState} from '../date-range-picker/use-date-range-picker-state';\n\nexport interface CalendarMonthProps {\n  state: DatePickerState | DateRangePickerState;\n  startDate: CalendarDate;\n  isFirst: boolean;\n  isLast: boolean;\n}\nexport function CalendarMonth({\n  startDate,\n  state,\n  isFirst,\n  isLast,\n}: CalendarMonthProps) {\n  const {localeCode} = useSelectedLocale();\n  const weeksInMonth = getWeeksInMonth(startDate, localeCode);\n  const monthStart = startOfWeek(startDate, localeCode);\n\n  return (\n    <div className=\"w-280 flex-shrink-0\">\n      <CalendarMonthHeader\n        isFirst={isFirst}\n        isLast={isLast}\n        state={state}\n        currentMonth={startDate}\n      />\n      <div className=\"block\" role=\"grid\">\n        <WeekdayHeader state={state} startDate={startDate} />\n        {[...new Array(weeksInMonth).keys()].map(weekIndex => (\n          <m.div className=\"flex mb-6\" key={weekIndex}>\n            {[...new Array(7).keys()].map(dayIndex => (\n              <CalendarCell\n                key={dayIndex}\n                date={monthStart.add({weeks: weekIndex, days: dayIndex})}\n                currentMonth={startDate}\n                state={state}\n              />\n            ))}\n          </m.div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\ninterface CalendarMonthHeaderProps {\n  state: DatePickerState | DateRangePickerState;\n  currentMonth: CalendarDate;\n  isFirst: boolean;\n  isLast: boolean;\n}\nfunction CalendarMonthHeader({\n  currentMonth,\n  isFirst,\n  isLast,\n  state: {calendarDates, setCalendarDates, timezone, min, max},\n}: CalendarMonthHeaderProps) {\n  const shiftCalendars = (direction: 'forward' | 'backward') => {\n    const count = calendarDates.length;\n    let newDates: CalendarDate[];\n    if (direction === 'forward') {\n      newDates = calendarDates.map(date =>\n        endOfMonth(date.add({months: count}))\n      );\n    } else {\n      newDates = calendarDates.map(date =>\n        endOfMonth(date.subtract({months: count}))\n      );\n    }\n    setCalendarDates(newDates);\n  };\n\n  const monthFormatter = useDateFormatter({\n    month: 'long',\n    year: 'numeric',\n    era: currentMonth.calendar.identifier !== 'gregory' ? 'long' : undefined,\n    calendar: currentMonth.calendar.identifier,\n  });\n\n  const isBackwardDisabled = dateIsInvalid(\n    currentMonth.subtract({days: 1}),\n    min,\n    max\n  );\n  const isForwardDisabled = dateIsInvalid(\n    startOfMonth(currentMonth.add({months: 1})),\n    min,\n    max\n  );\n\n  return (\n    <div className=\"flex items-center justify-between gap-10\">\n      <IconButton\n        size=\"md\"\n        className={clsx('text-muted', !isFirst && 'invisible')}\n        disabled={!isFirst || isBackwardDisabled}\n        aria-hidden={!isFirst}\n        onClick={() => {\n          shiftCalendars('backward');\n        }}\n      >\n        <KeyboardArrowLeftIcon />\n      </IconButton>\n      <div className=\"text-sm font-semibold select-none\">\n        {monthFormatter.format(currentMonth.toDate(timezone))}\n      </div>\n      <IconButton\n        size=\"md\"\n        className={clsx('text-muted', !isLast && 'invisible')}\n        disabled={!isLast || isForwardDisabled}\n        aria-hidden={!isLast}\n        onClick={() => {\n          shiftCalendars('forward');\n        }}\n      >\n        <KeyboardArrowRightIcon />\n      </IconButton>\n    </div>\n  );\n}\n\ninterface WeekdayHeaderProps {\n  state: DatePickerState | DateRangePickerState;\n  startDate: CalendarDate;\n}\nfunction WeekdayHeader({state: {timezone}, startDate}: WeekdayHeaderProps) {\n  const {localeCode} = useSelectedLocale();\n  const dayFormatter = useDateFormatter({weekday: 'short'});\n\n  const monthStart = startOfWeek(startDate, localeCode);\n\n  return (\n    <div className=\"flex\">\n      {[...new Array(7).keys()].map(index => {\n        const date = monthStart.add({days: index});\n        const dateDay = date.toDate(timezone);\n        const weekday = dayFormatter.format(dateDay);\n        return (\n          <div\n            className=\"w-40 h-40 text-sm font-semibold relative flex-shrink-0\"\n            key={index}\n          >\n            <div className=\"absolute flex items-center justify-center w-full h-full select-none\">\n              {weekday}\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n","import React, {Fragment} from 'react';\nimport {startOfMonth, toCalendarDate} from '@internationalized/date';\nimport {useIsMobileMediaQuery} from '@common/utils/hooks/is-mobile-media-query';\nimport {CalendarMonth} from './calendar-month';\nimport {DatePickerState} from '../date-picker/use-date-picker-state';\nimport {DateRangePickerState} from '../date-range-picker/use-date-range-picker-state';\n\ninterface CalendarProps {\n  state: DatePickerState | DateRangePickerState;\n  visibleMonths?: 1 | 2;\n}\nexport function Calendar({state, visibleMonths = 1}: CalendarProps) {\n  const isMobile = useIsMobileMediaQuery();\n\n  if (isMobile) {\n    visibleMonths = 1;\n  }\n\n  return (\n    <Fragment>\n      {[...new Array(visibleMonths).keys()].map(index => {\n        const startDate = toCalendarDate(\n          startOfMonth(state.calendarDates[index])\n        );\n        const isFirst = index === 0;\n        const isLast = index === visibleMonths - 1;\n        return (\n          <CalendarMonth\n            key={index}\n            state={state}\n            startDate={startDate}\n            isFirst={isFirst}\n            isLast={isLast}\n          />\n        );\n      })}\n    </Fragment>\n  );\n}\n","import {DateValue, parseAbsolute} from '@internationalized/date';\nimport {Fragment, memo} from 'react';\nimport {useDateFormatter} from './use-date-formatter';\nimport {useSettings} from '../core/settings/use-settings';\nimport {shallowEqual} from '../utils/shallow-equal';\nimport {useUserTimezone} from './use-user-timezone';\nimport {DateFormatPresets} from '@common/i18n/formatted-date';\n\ninterface FormattedDateTimeRangeProps {\n  start?: string | DateValue | Date;\n  end?: string | DateValue | Date;\n  options?: Intl.DateTimeFormatOptions;\n  preset?: keyof typeof DateFormatPresets;\n}\nexport const FormattedDateTimeRange = memo(\n  ({start, end, options, preset}: FormattedDateTimeRangeProps) => {\n    const {dates} = useSettings();\n    const timezone = useUserTimezone();\n    const formatter = useDateFormatter(\n      options ||\n        (DateFormatPresets as Record<string, Intl.DateTimeFormatOptions>)[\n          preset || dates?.format\n        ]\n    );\n\n    if (!start || !end) {\n      return null;\n    }\n\n    let value: string;\n\n    try {\n      value = formatter.formatRange(\n        castToDate(start, timezone),\n        castToDate(end, timezone)\n      );\n    } catch (e) {\n      value = '';\n    }\n\n    return <Fragment>{value}</Fragment>;\n  },\n  shallowEqual\n);\n\nfunction castToDate(date: string | DateValue | Date, timezone: string): Date {\n  if (typeof date === 'string') {\n    return parseAbsolute(date, timezone).toDate();\n  }\n  if ('toDate' in date) {\n    return date.toDate(timezone);\n  }\n  return date;\n}\n","import {List, ListItem} from '../../../../../list/list';\nimport {DateRangePresets} from './date-range-presets';\nimport {Trans} from '../../../../../../i18n/trans';\nimport {DateRangeValue} from '../date-range-value';\n\ninterface DatePresetList {\n  onPresetSelected: (value: DateRangeValue) => void;\n  selectedValue?: DateRangeValue | null;\n}\nexport function DatePresetList({\n  onPresetSelected,\n  selectedValue,\n}: DatePresetList) {\n  return (\n    <List\n      className=\"min-w-192\"\n      padding=\"py-14\"\n      dataTestId=\"date-range-preset-list\"\n    >\n      {DateRangePresets.map(preset => (\n        <ListItem\n          borderRadius=\"rounded-none\"\n          capitalizeFirst\n          key={preset.key}\n          isSelected={selectedValue?.preset === preset.key}\n          onSelected={() => {\n            const newValue = preset.getRangeValue();\n            onPresetSelected(newValue);\n          }}\n        >\n          <Trans {...preset.label} />\n        </ListItem>\n      ))}\n    </List>\n  );\n}\n","import {useMediaQuery, UseMediaQueryOptions} from './use-media-query';\n\nexport function useIsTabletMediaQuery(options?: UseMediaQueryOptions) {\n  return useMediaQuery('(max-width: 1024px)', options);\n}\n","import React, {useRef} from 'react';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {DatePickerField} from '../date-picker-field';\nimport {DateRangePickerState} from '../use-date-range-picker-state';\nimport {Calendar} from '../../calendar/calendar';\nimport {DialogFooter} from '../../../../../overlays/dialog/dialog-footer';\nimport {Button} from '../../../../../buttons/button';\nimport {useDialogContext} from '../../../../../overlays/dialog/dialog-context';\nimport {Dialog} from '../../../../../overlays/dialog/dialog';\nimport {DialogBody} from '../../../../../overlays/dialog/dialog-body';\nimport {ArrowRightAltIcon} from '../../../../../../icons/material/ArrowRightAlt';\nimport {DateSegmentList} from '../../segments/date-segment-list';\nimport {Trans} from '../../../../../../i18n/trans';\nimport {FormattedDateTimeRange} from '../../../../../../i18n/formatted-date-time-range';\nimport {DatePresetList} from './date-preset-list';\nimport {useIsTabletMediaQuery} from '@common/utils/hooks/is-tablet-media-query';\n\ninterface DateRangeDialogProps {\n  state: DateRangePickerState;\n  showInlineDatePickerField?: boolean;\n}\nexport function DateRangeDialog({\n  state,\n  showInlineDatePickerField = false,\n}: DateRangeDialogProps) {\n  const isTablet = useIsTabletMediaQuery();\n  const {close} = useDialogContext();\n  const initialStateRef = useRef<DateRangePickerState>(state);\n\n  const hasPlaceholder = state.isPlaceholder.start || state.isPlaceholder.end;\n\n  const footer = (\n    <DialogFooter\n      dividerTop\n      startAction={\n        !hasPlaceholder && !isTablet ? (\n          <div className=\"text-xs\">\n            <FormattedDateTimeRange\n              start={state.selectedValue.start.toDate()}\n              end={state.selectedValue.end.toDate()}\n              options={{dateStyle: 'medium'}}\n            />\n          </div>\n        ) : undefined\n      }\n    >\n      <Button\n        variant=\"text\"\n        size=\"xs\"\n        onClick={() => {\n          state.setSelectedValue(initialStateRef.current.selectedValue);\n          state.setIsPlaceholder(initialStateRef.current.isPlaceholder);\n          close();\n        }}\n      >\n        <Trans message=\"Cancel\" />\n      </Button>\n      <Button\n        variant=\"flat\"\n        color=\"primary\"\n        size=\"xs\"\n        onClick={() => {\n          close(state.selectedValue);\n        }}\n      >\n        <Trans message=\"Select\" />\n      </Button>\n    </DialogFooter>\n  );\n\n  return (\n    <Dialog size=\"auto\">\n      <DialogBody className=\"flex\" padding=\"p-0\">\n        {!isTablet && (\n          <DatePresetList\n            selectedValue={state.selectedValue}\n            onPresetSelected={preset => {\n              state.setSelectedValue(preset);\n              if (state.closeDialogOnSelection) {\n                close(preset);\n              }\n            }}\n          />\n        )}\n        <AnimatePresence initial={false}>\n          <Calendars\n            state={state}\n            showInlineDatePickerField={showInlineDatePickerField}\n          />\n        </AnimatePresence>\n      </DialogBody>\n      {!state.closeDialogOnSelection && footer}\n    </Dialog>\n  );\n}\n\ninterface CustomRangePanelProps {\n  state: DateRangePickerState;\n  showInlineDatePickerField?: boolean;\n}\nfunction Calendars({state, showInlineDatePickerField}: CustomRangePanelProps) {\n  return (\n    <m.div\n      initial={{width: 0, overflow: 'hidden'}}\n      animate={{width: 'auto'}}\n      exit={{width: 0, overflow: 'hidden'}}\n      transition={{type: 'tween', duration: 0.125}}\n      className=\"border-l px-20 pt-10 pb-20\"\n    >\n      {showInlineDatePickerField && <InlineDatePickerField state={state} />}\n      <div className=\"flex items-start gap-36\">\n        <Calendar state={state} visibleMonths={2} />\n      </div>\n    </m.div>\n  );\n}\n\ninterface InlineDatePickerFieldProps {\n  state: DateRangePickerState;\n}\nfunction InlineDatePickerField({state}: InlineDatePickerFieldProps) {\n  const {selectedValue, setSelectedValue} = state;\n  return (\n    <DatePickerField className=\"mb-20 mt-10\">\n      <DateSegmentList\n        state={state}\n        value={selectedValue.start}\n        onChange={newValue => {\n          setSelectedValue({...selectedValue, start: newValue});\n        }}\n      />\n      <ArrowRightAltIcon className=\"block flex-shrink-0 text-muted\" size=\"md\" />\n      <DateSegmentList\n        state={state}\n        value={selectedValue.end}\n        onChange={newValue => {\n          setSelectedValue({...selectedValue, end: newValue});\n        }}\n      />\n    </DatePickerField>\n  );\n}\n","import React, {\n  ComponentPropsWithoutRef,\n  Fragment,\n  MouseEvent,\n  useRef,\n} from 'react';\nimport {DateRangeIcon} from '../../../../../icons/material/DateRange';\nimport {DialogTrigger} from '../../../../overlays/dialog/dialog-trigger';\nimport {DatePickerField, DatePickerFieldProps} from './date-picker-field';\nimport {useDateRangePickerState} from './use-date-range-picker-state';\nimport {ArrowRightAltIcon} from '../../../../../icons/material/ArrowRightAlt';\nimport {DatePickerValueProps} from '../date-picker/use-date-picker-state';\nimport {DateRangeValue} from './date-range-value';\nimport {DateSegmentList} from '../segments/date-segment-list';\nimport {DateRangeDialog} from './dialog/date-range-dialog';\nimport {useIsMobileMediaQuery} from '../../../../../utils/hooks/is-mobile-media-query';\n\nexport interface DateRangePickerProps\n  extends DatePickerValueProps<Partial<DateRangeValue>>,\n    Omit<DatePickerFieldProps, 'children'> {}\nexport function DateRangePicker(props: DateRangePickerProps) {\n  const {granularity, closeDialogOnSelection, ...fieldProps} = props;\n  const state = useDateRangePickerState(props);\n  const inputRef = useRef<HTMLDivElement>(null);\n  const isMobile = useIsMobileMediaQuery();\n  const hideCalendarIcon = isMobile && granularity !== 'day';\n\n  const dialog = (\n    <DialogTrigger\n      offset={8}\n      placement=\"bottom-start\"\n      isOpen={state.calendarIsOpen}\n      onOpenChange={state.setCalendarIsOpen}\n      type=\"popover\"\n      triggerRef={inputRef}\n      returnFocusToTrigger={false}\n      moveFocusToDialog={false}\n    >\n      <DateRangeDialog state={state} />\n    </DialogTrigger>\n  );\n\n  const openOnClick: ComponentPropsWithoutRef<'div'> = {\n    onClick: e => {\n      e.stopPropagation();\n      e.preventDefault();\n      if (!isHourSegment(e)) {\n        state.setCalendarIsOpen(true);\n      } else {\n        state.setCalendarIsOpen(false);\n      }\n    },\n  };\n\n  const value = state.selectedValue;\n  const onChange = state.setSelectedValue;\n\n  return (\n    <Fragment>\n      <DatePickerField\n        ref={inputRef}\n        wrapperProps={openOnClick}\n        endAdornment={!hideCalendarIcon ? <DateRangeIcon /> : undefined}\n        {...fieldProps}\n      >\n        <DateSegmentList\n          isPlaceholder={state.isPlaceholder?.start}\n          state={state}\n          segmentProps={openOnClick}\n          value={value.start}\n          onChange={newValue => {\n            onChange({start: newValue, end: value.end});\n          }}\n        />\n        <ArrowRightAltIcon\n          className=\"block flex-shrink-0 text-muted\"\n          size=\"md\"\n        />\n        <DateSegmentList\n          isPlaceholder={state.isPlaceholder?.end}\n          state={state}\n          segmentProps={openOnClick}\n          value={value.end}\n          onChange={newValue => {\n            onChange({start: value.start, end: newValue});\n          }}\n        />\n      </DatePickerField>\n      {dialog}\n    </Fragment>\n  );\n}\n\nfunction isHourSegment(e: MouseEvent<HTMLDivElement>): boolean {\n  return ['hour', 'minute', 'dayPeriod'].includes(\n    (e.currentTarget as HTMLElement).ariaLabel || ''\n  );\n}\n","import {parseAbsoluteToLocal, ZonedDateTime} from '@internationalized/date';\nimport {DateRangeValue} from './date-range-value';\nimport {useController} from 'react-hook-form';\nimport {mergeProps} from '@react-aria/utils';\nimport React from 'react';\nimport {DateRangePicker, DateRangePickerProps} from './date-range-picker';\n\nexport interface AbsoluteDateRange {\n  start?: string;\n  end?: string;\n  preset?: number;\n}\n\ninterface FormDateRange {\n  start?: string | ZonedDateTime;\n  end?: string | ZonedDateTime;\n  preset?: number;\n}\n\nexport interface FormDateRangePickerProps extends DateRangePickerProps {\n  name: string;\n}\nexport function FormDateRangePicker(props: FormDateRangePickerProps) {\n  const {\n    field: {onChange, onBlur, value, ref},\n    fieldState: {invalid, error},\n  } = useController({\n    name: props.name,\n  });\n\n  const formProps: Partial<DateRangePickerProps> = {\n    onChange: e => {\n      onChange(e ? dateRangeToAbsoluteRange(e) : null);\n    },\n    onBlur,\n    value: absoluteRangeToDateRange(value),\n    invalid,\n    errorMessage: error?.message,\n    inputRef: ref,\n  };\n\n  return <DateRangePicker {...mergeProps(formProps, props)} />;\n}\n\nexport function absoluteRangeToDateRange(props: FormDateRange | null) {\n  const {start, end, preset} = props || {};\n  const dateRange: Partial<DateRangeValue> = {preset};\n  try {\n    if (start) {\n      dateRange.start =\n        typeof start === 'string' ? parseAbsoluteToLocal(start) : start;\n    }\n    if (end) {\n      dateRange.end = typeof end === 'string' ? parseAbsoluteToLocal(end) : end;\n    }\n  } catch (e) {\n    // ignore\n  }\n  return dateRange;\n}\n\nexport function dateRangeToAbsoluteRange({\n  start,\n  end,\n  preset,\n}: Partial<DateRangeValue> = {}): AbsoluteDateRange {\n  const absoluteRange: AbsoluteDateRange = {\n    preset,\n  };\n  if (start) {\n    absoluteRange.start = start.toAbsoluteString();\n  }\n  if (end) {\n    absoluteRange.end = end.toAbsoluteString();\n  }\n  return absoluteRange;\n}\n","import clsx from 'clsx';\nimport React, {\n  ComponentProps,\n  ComponentPropsWithoutRef,\n  forwardRef,\n} from 'react';\nimport {Link} from 'react-router-dom';\nimport {Tooltip} from '@common/ui/tooltip/tooltip';\nimport {AvatarPlaceholderIcon} from '@common/auth/ui/account-settings/avatar/avatar-placeholder-icon';\n\ntype Size = 'xs' | 'sm' | 'md' | 'lg' | 'xl';\n\nexport interface AvatarProps extends ComponentPropsWithoutRef<any> {\n  className?: string;\n  src?: string;\n  label?: string;\n  circle?: boolean;\n  size?: Size;\n  link?: string;\n  fallback?: 'initials' | 'generic';\n  lazy?: boolean;\n}\nexport const Avatar = forwardRef<HTMLImageElement, AvatarProps>(\n  (\n    {\n      className,\n      circle,\n      size = 'md',\n      src,\n      link,\n      label,\n      fallback = 'generic',\n      lazy = true,\n      ...domProps\n    },\n    ref\n  ) => {\n    let renderedAvatar = src ? (\n      <img\n        ref={ref}\n        src={src}\n        alt={label}\n        loading={lazy ? 'lazy' : undefined}\n        className=\"block h-full w-full object-cover\"\n      />\n    ) : (\n      <div className=\"h-full w-full bg-alt dark:bg-chip\">\n        <AvatarPlaceholderIcon\n          viewBox=\"0 0 48 48\"\n          className=\"h-full w-full text-muted\"\n        />\n      </div>\n    );\n\n    if (label) {\n      renderedAvatar = <Tooltip label={label}>{renderedAvatar}</Tooltip>;\n    }\n\n    const wrapperProps: ComponentProps<any> = {\n      ...domProps,\n      className: clsx(\n        className,\n        'relative block overflow-hidden select-none flex-shrink-0',\n        getSizeClassName(size),\n        circle ? 'rounded-full' : 'rounded'\n      ),\n    };\n\n    return link ? (\n      <Link {...wrapperProps} to={link}>\n        {renderedAvatar}\n      </Link>\n    ) : (\n      <div {...wrapperProps}>{renderedAvatar}</div>\n    );\n  }\n);\n\nfunction getSizeClassName(size: Size) {\n  switch (size) {\n    case 'xs':\n      return 'w-18 h-18';\n    case 'sm':\n      return 'w-24 h-24';\n    case 'md':\n      return 'w-32 h-32';\n    case 'lg':\n      return 'w-40 h-40';\n    case 'xl':\n      return 'w-60 h-60';\n    // allow overriding with custom classNames\n    default:\n      return size;\n  }\n}\n","import React, {ReactNode} from 'react';\nimport {Avatar, AvatarProps} from '../../ui/images/avatar';\nimport {Skeleton} from '@common/ui/skeleton/skeleton';\nimport clsx from 'clsx';\n\ninterface Props {\n  image?: string;\n  label: ReactNode;\n  description?: ReactNode;\n  labelClassName?: string;\n  avatarSize?: AvatarProps['size'];\n}\nexport function NameWithAvatar({\n  image,\n  label,\n  description,\n  labelClassName,\n  avatarSize = 'md',\n}: Props) {\n  return (\n    <div className=\"flex items-center gap-12\">\n      {image && (\n        <Avatar size={avatarSize} className=\"flex-shrink-0\" src={image} />\n      )}\n      <div className=\"overflow-hidden min-w-0\">\n        <div\n          className={clsx(labelClassName, 'overflow-hidden overflow-ellipsis')}\n        >\n          {label}\n        </div>\n        {description && (\n          <div className=\"text-muted text-xs overflow-hidden overflow-ellipsis\">\n            {description}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport function NameWithAvatarPlaceholder({\n  labelClassName,\n  showDescription,\n}: Partial<Props> & {\n  showDescription?: boolean;\n}) {\n  return (\n    <div className=\"flex items-center gap-12 w-full max-w-4/5\">\n      <Skeleton size=\"w-32 h-32\" />\n      <div className=\"flex-auto\">\n        <div className={clsx(labelClassName, 'leading-3')}>\n          <Skeleton />\n        </div>\n        {showDescription && (\n          <div className=\"text-muted leading-3 mt-4\">{<Skeleton />}</div>\n        )}\n      </div>\n    </div>\n  );\n}\n","export const BackendFiltersUrlKey = 'filters';\n","import {FilterListValue} from './encode-backend-filters';\n\nexport function decodeBackendFilters(\n  encodedFilters: string | null\n): FilterListValue[] {\n  if (!encodedFilters) return [];\n  let filtersFromQuery: FilterListValue[] = [];\n  try {\n    filtersFromQuery = JSON.parse(atob(decodeURIComponent(encodedFilters)));\n    filtersFromQuery.map(filterValue => {\n      // set value key as value so selects work properly\n      if (filterValue.valueKey != null) {\n        filterValue.value = filterValue.valueKey;\n      }\n      return filterValue;\n    });\n  } catch (e) {\n    //\n  }\n  return filtersFromQuery;\n}\n","import {Key} from 'react';\nimport {BackendFilter} from '../backend-filter';\n\nexport interface FilterListValue {\n  key: Key;\n  value: BackendFilter['control']['defaultValue'];\n  operator?: BackendFilter['defaultOperator'];\n  valueKey?: Key;\n  isInactive?: boolean;\n  extraFilters?: {key: string; operator: string; value: any}[];\n}\n\nexport function encodeBackendFilters(\n  filterValues: FilterListValue[] | null,\n  filters?: BackendFilter[]\n): string {\n  if (!filterValues) return '';\n\n  // prepare values for backend\n  filterValues = !filters\n    ? filterValues\n    : filterValues\n        .filter(item => item.value !== '')\n        .map(item => transformValue(item, filters));\n\n  // remove all placeholder filters\n  filterValues = filterValues.filter(fm => !fm.isInactive);\n\n  if (!filterValues.length) {\n    return '';\n  }\n\n  return encodeURIComponent(btoa(JSON.stringify(filterValues)));\n}\n\nfunction transformValue(\n  filterValue: FilterListValue,\n  filters: BackendFilter[]\n) {\n  const filterConfig = filters.find(f => f.key === filterValue.key);\n  // select components will use a key always, because we can't use objects as\n  // value. Map over select options and replace key with actual value\n  if (filterConfig?.control.type === 'select') {\n    const option = (filterConfig.control.options || []).find(\n      o => o.key === filterValue.value\n    );\n    // if it's language or country select, there might not be an option\n    if (option) {\n      return {...filterValue, value: option.value, valueKey: option.key};\n    }\n  }\n\n  if (filterConfig?.extraFilters?.length) {\n    filterValue['extraFilters'] = filterConfig.extraFilters;\n  }\n\n  return filterValue;\n}\n","import {useNavigate, useSearchParams} from 'react-router-dom';\nimport {Key, useCallback, useMemo} from 'react';\nimport {BackendFilter} from './backend-filter';\nimport {BackendFiltersUrlKey} from './backend-filters-url-key';\nimport {decodeBackendFilters} from './utils/decode-backend-filters';\nimport {\n  encodeBackendFilters,\n  FilterListValue,\n} from './utils/encode-backend-filters';\n\nexport function useBackendFilterUrlParams(\n  filters?: BackendFilter[],\n  pinnedFilters?: string[]\n) {\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n\n  const encodedFilters = searchParams.get(BackendFiltersUrlKey);\n\n  const decodedFilters: FilterListValue[] = useMemo(() => {\n    if (!filters) return [];\n    const decoded = decodeBackendFilters(encodedFilters);\n\n    // if filter is pinned, and it is not applied yet, add a placeholder\n    (pinnedFilters || []).forEach(key => {\n      if (!decoded.find(f => f.key === key)) {\n        const config = filters.find(f => f.key === key)!;\n        decoded.push({\n          key,\n          value: config.control.defaultValue,\n          operator: config.defaultOperator,\n          isInactive: true,\n        });\n      }\n    });\n\n    // preserve original filter order from configuration\n    decoded.sort(\n      (a, b) =>\n        filters.findIndex(f => f.key === a.key) -\n        filters.findIndex(f => f.key === b.key)\n    );\n\n    return decoded;\n  }, [encodedFilters, pinnedFilters, filters]);\n\n  const getDecodedWithoutKeys = useCallback(\n    (values: (FilterListValue | Key)[]) => {\n      const newFilters = [...decodedFilters];\n      values.forEach(value => {\n        const key = typeof value === 'object' ? value.key : value;\n        const index = newFilters.findIndex(f => f.key === key);\n        if (index > -1) {\n          newFilters.splice(index, 1);\n        }\n      });\n      return newFilters;\n    },\n    [decodedFilters]\n  );\n\n  const replaceAll = useCallback(\n    (filterValues: FilterListValue[]) => {\n      const encodedFilters = encodeBackendFilters(filterValues, filters);\n      if (encodedFilters) {\n        searchParams.set(BackendFiltersUrlKey, encodedFilters);\n      } else {\n        searchParams.delete(BackendFiltersUrlKey);\n      }\n      navigate({search: `?${searchParams}`}, {replace: true});\n    },\n    [filters, navigate, searchParams]\n  );\n\n  const add = useCallback(\n    (filterValues: FilterListValue[]) => {\n      const existing = getDecodedWithoutKeys(filterValues);\n      const decodedFilters = [...existing, ...filterValues];\n      replaceAll(decodedFilters);\n    },\n    [getDecodedWithoutKeys, replaceAll]\n  );\n\n  const remove = useCallback(\n    (key: Key) => replaceAll(getDecodedWithoutKeys([key])),\n    [getDecodedWithoutKeys, replaceAll]\n  );\n\n  return {\n    add,\n    remove,\n    replaceAll,\n    decodedFilters,\n    encodedFilters,\n  };\n}\n","import {useQuery, UseQueryOptions} from '@tanstack/react-query';\nimport {PaginatedBackendResponse} from '../../http/backend-response/pagination-response';\nimport {apiClient} from '../../http/query-client';\n\nexport interface GetDatatableDataParams {\n  orderBy?: string;\n  orderDir?: 'asc' | 'desc';\n  filters?: string | null;\n  query?: string;\n  with?: string;\n  perPage?: number | string | null;\n  page?: number;\n  [key: string]: string | number | boolean | undefined | null;\n}\n\nexport const DatatableDataQueryKey = (\n  endpoint: string,\n  params?: GetDatatableDataParams | Record<string, string | number | boolean>\n) => {\n  // split endpoint by slash, so we can clear cache from the root later,\n  // for example, 'link-group' will clear 'link-group/1/links' endpoint\n  const key: (string | GetDatatableDataParams)[] = endpoint.split('/');\n  if (params) {\n    key.push(params);\n  }\n  return key;\n};\n\nexport function useDatatableData<T = object>(\n  endpoint: string,\n  params: GetDatatableDataParams,\n  options?: Omit<\n    UseQueryOptions<\n      PaginatedBackendResponse<T>,\n      unknown,\n      PaginatedBackendResponse<T>,\n      any[]\n    >,\n    'queryKey' | 'queryFn'\n  >\n) {\n  return useQuery(\n    DatatableDataQueryKey(endpoint, params),\n    () => paginate<T>(endpoint, params),\n    {\n      ...options,\n      keepPreviousData: true,\n    }\n  );\n}\n\nfunction paginate<T>(\n  endpoint: string,\n  params: GetDatatableDataParams\n): Promise<PaginatedBackendResponse<T>> {\n  return apiClient.get(endpoint, {params}).then(response => response.data);\n}\n","import {isMac} from '@react-aria/utils';\n\ninterface Event {\n  altKey: boolean;\n  ctrlKey: boolean;\n  metaKey: boolean;\n}\n\nexport function isCtrlKeyPressed(e: Event) {\n  if (isMac()) {\n    return e.metaKey;\n  }\n\n  return e.ctrlKey;\n}\n","import React, {KeyboardEventHandler} from 'react';\nimport {getFocusableTreeWalker} from '@react-aria/focus';\nimport {focusWithoutScrolling} from '@react-aria/utils';\nimport {isCtrlKeyPressed} from '../../utils/keybinds/is-ctrl-key-pressed';\n\ninterface Props {\n  cellCount: number;\n  rowCount: number;\n}\nexport function useGridNavigation(props: Props) {\n  const {cellCount, rowCount} = props;\n  const onKeyDown: KeyboardEventHandler<HTMLElement> = e => {\n    switch (e.key) {\n      case 'ArrowLeft':\n        focusSiblingCell(e, {cell: {op: 'decrement'}}, props);\n        break;\n      case 'ArrowRight':\n        focusSiblingCell(e, {cell: {op: 'increment'}}, props);\n        break;\n      case 'ArrowUp':\n        focusSiblingCell(e, {row: {op: 'decrement'}}, props);\n        break;\n      case 'ArrowDown':\n        focusSiblingCell(e, {row: {op: 'increment'}}, props);\n        break;\n      case 'PageUp':\n        focusSiblingCell(e, {row: {op: 'decrement', count: 5}}, props);\n        break;\n      case 'PageDown':\n        focusSiblingCell(e, {row: {op: 'increment', count: 5}}, props);\n        break;\n      case 'Tab':\n        focusFirstElementAfterGrid(e);\n        break;\n      case 'Home':\n        if (isCtrlKeyPressed(e)) {\n          // move to first cell in first row\n          focusSiblingCell(\n            e,\n            {\n              row: {op: 'decrement', count: rowCount},\n              cell: {op: 'decrement', count: cellCount},\n            },\n            props\n          );\n        } else {\n          // move to first cell in current row\n          focusSiblingCell(\n            e,\n            {cell: {op: 'decrement', count: cellCount}},\n            props\n          );\n        }\n        break;\n      case 'End':\n        if (isCtrlKeyPressed(e)) {\n          // move to last cell in last row\n          focusSiblingCell(\n            e,\n            {\n              row: {op: 'increment', count: rowCount},\n              cell: {op: 'increment', count: cellCount},\n            },\n            props\n          );\n        } else {\n          // move to last cell in current row\n          focusSiblingCell(\n            e,\n            {cell: {op: 'increment', count: cellCount}},\n            props\n          );\n        }\n        break;\n    }\n  };\n\n  return {onKeyDown};\n}\n\ninterface Operations {\n  cell?: {\n    op: 'increment' | 'decrement';\n    count?: number;\n  };\n  row?: {\n    op: 'increment' | 'decrement';\n    count?: number;\n  };\n}\nfunction focusSiblingCell(\n  e: React.KeyboardEvent,\n  operations: Operations,\n  {cellCount, rowCount}: Props\n) {\n  if (document.activeElement?.tagName === 'input') return;\n  e.preventDefault();\n  const grid = e.currentTarget as HTMLElement;\n\n  // focused element might be inside the cell and not the cell itself\n  const currentCell = (e.target as HTMLElement).closest('[aria-colindex]');\n  if (!currentCell || !grid) return;\n\n  const row = currentCell.closest('[aria-rowindex]');\n  if (!row) return;\n\n  // grab row and cell index from aria attributes\n  let rowIndex = parseInt(row.getAttribute('aria-rowindex') as string);\n  let cellIndex = parseInt(currentCell.getAttribute('aria-colindex') as string);\n  if (Number.isNaN(rowIndex) || Number.isNaN(cellIndex)) return;\n\n  // adjust row index for next cell selector\n  const rowOpCount = operations.row?.count ?? 1;\n  if (operations.row?.op === 'increment') {\n    rowIndex = Math.min(rowCount, rowIndex + rowOpCount);\n  } else if (operations.row?.op === 'decrement') {\n    rowIndex = Math.max(1, rowIndex - rowOpCount);\n  }\n\n  // adjust cell index for next cell selector\n  const cellOpCount = operations.cell?.count ?? 1;\n  if (operations.cell?.op === 'increment') {\n    cellIndex = Math.min(cellCount, cellIndex + cellOpCount);\n  } else if (operations.cell?.op === 'decrement') {\n    cellIndex = Math.max(1, cellIndex - cellOpCount);\n  }\n\n  // find the next cell that should be focused\n  const nextCell = grid.querySelector(\n    `[aria-rowindex=\"${rowIndex}\"] [aria-colindex=\"${cellIndex}\"]`\n  ) as HTMLElement | undefined;\n  if (!nextCell) return;\n\n  // find any focusable elements inside the cell\n  const walker = getFocusableTreeWalker(nextCell);\n  const nextFocusableElement = (walker.nextNode() || nextCell) as HTMLElement;\n\n  // adjust tab index on current and next cells and focus either next cell or first focusable element inside that cell\n  currentCell.setAttribute('tabindex', '-1');\n  nextFocusableElement.setAttribute('tabindex', '0');\n  nextFocusableElement.focus();\n}\n\n// grid is treated as a single tab stop, focus first element after grid, instead of moving focus withing grid on tab press\nfunction focusFirstElementAfterGrid(e: React.KeyboardEvent) {\n  const grid = e.currentTarget as HTMLElement;\n  if (e.shiftKey) {\n    grid.focus();\n  } else {\n    const walker = getFocusableTreeWalker(grid, {tabbable: true});\n    let next: HTMLElement;\n    let last: HTMLElement;\n    do {\n      last = walker.lastChild() as HTMLElement;\n      if (last) {\n        next = last;\n      }\n    } while (last);\n\n    // @ts-ignore\n    if (next && !next.contains(document.activeElement)) {\n      focusWithoutScrolling(next);\n    }\n  }\n}\n","import {createContext} from 'react';\nimport type {SortDescriptor} from './types/sort-descriptor';\nimport type {TableProps} from './table';\nimport type {ColumnConfig} from '../../datatable/column-config';\nimport type {TableDataItem} from './types/table-data-item';\n\nexport type TableSelectionStyle = 'checkbox' | 'highlight';\n\nexport interface TableContextValue<T extends TableDataItem = TableDataItem> {\n  isCollapsedMode: boolean;\n  selectedRows: (string | number)[];\n  onSelectionChange: (keys: (string | number)[]) => void;\n  sortDescriptor?: SortDescriptor;\n  onSortChange?: (descriptor: SortDescriptor) => any;\n  enableSelection?: boolean;\n  enableSorting?: boolean;\n  selectionStyle: TableSelectionStyle;\n  data: T[];\n  meta?: any;\n  columns: ColumnConfig<T>[];\n  toggleRow: (item: T) => void;\n  selectRow: (item: T | null, merge?: boolean) => void;\n  hideBorder: boolean;\n  hideHeaderRow: boolean;\n  collapseOnMobile: boolean;\n  onAction: TableProps<T>['onAction'];\n  selectRowOnContextMenu: TableProps<T>['selectRowOnContextMenu'];\n  cellHeight: string | undefined;\n}\nexport const TableContext = createContext<TableContextValue>(null!);\n","import clsx from 'clsx';\nimport {useContext} from 'react';\nimport {TableContext} from '@common/ui/tables/table-context';\n\ninterface Props {\n  index: number;\n  isHeader: boolean;\n}\nexport function useTableCellStyle({index, isHeader}: Props) {\n  const {columns, cellHeight = 'h-46'} = useContext(TableContext);\n  const column = columns[index];\n\n  const userPadding = column?.padding;\n\n  let justify = 'justify-start';\n  if (column?.align === 'center') {\n    justify = 'justify-center';\n  } else if (column?.align === 'end') {\n    justify = 'justify-end';\n  }\n\n  return clsx(\n    'flex items-center overflow-hidden whitespace-nowrap overflow-ellipsis outline-none focus-visible:outline focus-visible:outline-offset-2',\n    isHeader ? 'h-46' : cellHeight,\n    column?.width ?? 'flex-1',\n    column?.maxWidth,\n    column?.minWidth,\n    justify,\n    userPadding,\n    column?.className\n  );\n}\n","import {useContext, useMemo} from 'react';\nimport {TableContext} from './table-context';\nimport {TableDataItem} from './types/table-data-item';\nimport {RowContext} from '@common/datatable/column-config';\nimport {useTableCellStyle} from '@common/ui/tables/style/use-table-cell-style';\n\ninterface TableCellProps {\n  rowIsHovered: boolean;\n  rowIndex: number;\n  index: number;\n  item: TableDataItem;\n  id?: string;\n}\nexport function TableCell({\n  rowIndex,\n  rowIsHovered,\n  index,\n  item,\n  id,\n}: TableCellProps) {\n  const {columns} = useContext(TableContext);\n  const column = columns[index];\n\n  const rowContext: RowContext = useMemo(() => {\n    return {\n      index: rowIndex,\n      isHovered: rowIsHovered,\n      isPlaceholder: item.isPlaceholder,\n    };\n  }, [rowIndex, rowIsHovered, item.isPlaceholder]);\n\n  const style = useTableCellStyle({\n    index: index,\n    isHeader: false,\n  });\n\n  return (\n    <div\n      tabIndex={-1}\n      role=\"gridcell\"\n      aria-colindex={index + 1}\n      id={id}\n      className={style}\n    >\n      <div className=\"overflow-x-hidden overflow-ellipsis min-w-0 w-full\">\n        {column.body(item, rowContext)}\n      </div>\n    </div>\n  );\n}\n","import React, {HTMLAttributes, useRef} from 'react';\nimport {createEventHandler} from '../../utils/dom/create-event-handler';\nimport {useGlobalListeners} from '@react-aria/utils';\n\ninterface PointerState {\n  lastPosition: {x: number; y: number};\n  id?: number;\n  started: boolean;\n  el?: HTMLElement;\n  originalTouchAction?: string;\n  originalUserSelect?: string;\n  longPressTimer?: any;\n  longPressTriggered?: boolean;\n}\n\ninterface UsePointerEventsReturn {\n  domProps: HTMLAttributes<HTMLElement>;\n}\n\nexport interface UsePointerEventsProps {\n  onMoveStart?: (e: PointerEvent, el: HTMLElement) => false | void;\n  onMove?: (e: PointerEvent, deltaX: number, deltaY: number) => void;\n  onMoveEnd?: (e: PointerEvent) => void;\n  onPointerDown?: (e: React.PointerEvent) => void | false;\n  onPointerUp?: (e: PointerEvent, el: HTMLElement) => void;\n  onPress?: (e: PointerEvent, el: HTMLElement) => void;\n  onLongPress?: (e: PointerEvent | React.PointerEvent, el: HTMLElement) => void;\n  preventDefault?: boolean;\n  stopPropagation?: boolean;\n  minimumMovement?: number;\n}\nexport function usePointerEvents({\n  onMoveStart,\n  onMove,\n  onMoveEnd,\n  minimumMovement = 0,\n  preventDefault,\n  stopPropagation = true,\n  onPress,\n  onLongPress,\n  ...props\n}: UsePointerEventsProps): UsePointerEventsReturn {\n  const stateRef = useRef<PointerState>({\n    lastPosition: {x: 0, y: 0},\n    started: false,\n    longPressTriggered: false,\n  });\n  const state = stateRef.current;\n\n  const {addGlobalListener, removeGlobalListener} = useGlobalListeners();\n\n  const start = (e: PointerEvent) => {\n    if (!state.el) return;\n    const result = onMoveStart?.(e, state.el);\n\n    // allow user to cancel interaction\n    if (result === false) return;\n\n    state.originalTouchAction = state.el.style.touchAction;\n    state.el.style.touchAction = 'none';\n    state.originalUserSelect = document.documentElement.style.userSelect;\n    document.documentElement.style.userSelect = 'none';\n    state.started = true;\n  };\n\n  const onPointerDown = (e: React.PointerEvent) => {\n    if (e.button === 0 && state.id == null) {\n      state.started = false;\n\n      const result = props.onPointerDown?.(e);\n      if (result === false) return;\n\n      if (stopPropagation) {\n        e.stopPropagation();\n      }\n      if (preventDefault) {\n        e.preventDefault();\n      }\n      state.id = e.pointerId;\n      state.el = e.currentTarget as HTMLElement;\n      state.lastPosition = {x: e.clientX, y: e.clientY};\n\n      // use global listeners, so we don't have to capture pointer,\n      // which would prevent click events on child nodes\n\n      if (onLongPress) {\n        state.longPressTimer = setTimeout(() => {\n          onLongPress(e, state.el!);\n          state.longPressTriggered = true;\n        }, 400);\n      }\n\n      if (onMoveStart || onMove) {\n        addGlobalListener(window, 'pointermove', onPointerMove, false);\n      }\n      addGlobalListener(window, 'pointerup', onPointerUp, false);\n      addGlobalListener(window, 'pointercancel', onPointerUp, false);\n    }\n  };\n\n  const onPointerMove = (e: PointerEvent) => {\n    if (e.pointerId === state.id) {\n      const deltaX = e.clientX - state.lastPosition.x;\n      const deltaY = e.clientY - state.lastPosition.y;\n\n      if (\n        (Math.abs(deltaX) >= minimumMovement ||\n          Math.abs(deltaY) >= minimumMovement) &&\n        !state.started\n      ) {\n        start(e);\n      }\n\n      if (state.started) {\n        onMove?.(e, deltaX, deltaY);\n        state.lastPosition = {x: e.clientX, y: e.clientY};\n      }\n    }\n  };\n\n  const onPointerUp = (e: PointerEvent) => {\n    if (e.pointerId === state.id) {\n      // cancel long press timer, if exists\n      if (state.longPressTimer) {\n        clearTimeout(state.longPressTimer);\n      }\n\n      const longPressTriggered = state.longPressTriggered;\n      state.longPressTriggered = false;\n\n      // only call onMoveEnd if we actually started moving\n      if (state.started) {\n        onMoveEnd?.(e);\n      }\n\n      if (state.el) {\n        // handle press only if event was not cancelled (via touch scroll on mobile for example)\n        if (e.type !== 'pointercancel') {\n          props.onPointerUp?.(e, state.el);\n\n          // only call onPress if pointer did not leave onPointerDown element\n          if (e.target && state.el.contains(e.target as HTMLElement)) {\n            // trigger either onPress or onLongPress\n            if (longPressTriggered) {\n              onLongPress?.(e, state.el);\n            } else {\n              onPress?.(e, state.el);\n            }\n          }\n        }\n\n        document.documentElement.style.userSelect =\n          state.originalUserSelect || '';\n        state.el.style.touchAction = state.originalTouchAction || '';\n      }\n      state.id = undefined;\n      state.started = false;\n      removeGlobalListener(window, 'pointermove', onPointerMove, false);\n      removeGlobalListener(window, 'pointerup', onPointerUp, false);\n      removeGlobalListener(window, 'pointercancel', onPointerUp, false);\n    }\n  };\n\n  return {\n    domProps: {\n      onPointerDown: createEventHandler(onPointerDown),\n    },\n  };\n}\n","import {isCtrlKeyPressed} from './is-ctrl-key-pressed';\n\ninterface Event {\n  altKey: boolean;\n  ctrlKey: boolean;\n  metaKey: boolean;\n  shiftKey: boolean;\n}\n\nexport function isCtrlOrShiftPressed(e: Event) {\n  return e.shiftKey || isCtrlKeyPressed(e);\n}\n","import clsx from 'clsx';\nimport {useContext} from 'react';\nimport {TableContext} from '@common/ui/tables/table-context';\nimport {useIsDarkMode} from '@common/ui/themes/use-is-dark-mode';\nimport {useIsMobileMediaQuery} from '@common/utils/hooks/is-mobile-media-query';\n\ninterface Props {\n  index: number;\n  isSelected: boolean;\n  isHeader?: boolean;\n}\nexport function useTableRowStyle({index, isSelected, isHeader}: Props) {\n  const isDarkMode = useIsDarkMode();\n  const isMobile = useIsMobileMediaQuery();\n  const {hideBorder, enableSelection, collapseOnMobile} =\n    useContext(TableContext);\n  const isFirst = index === 0;\n  return clsx(\n    'flex gap-x-16 break-inside-avoid outline-none border border-transparent',\n    isMobile && collapseOnMobile && hideBorder\n      ? 'mb-8 pl-8 pr-0 rounded'\n      : 'px-16',\n    !hideBorder && 'border-b-divider',\n    !hideBorder && isFirst && 'border-t-divider',\n    isSelected &&\n      !isDarkMode &&\n      'bg-primary/selected hover:bg-primary/focus focus-visible:bg-primary/focus',\n    isSelected &&\n      isDarkMode &&\n      'bg-selected hover:bg-focus focus-visible:bg-focus',\n    !isSelected &&\n      !isHeader &&\n      enableSelection &&\n      'focus-visible:bg-focus hover:bg-hover'\n  );\n}\n","import React, {\n  ComponentPropsWithoutRef,\n  JSXElementConstructor,\n  KeyboardEventHandler,\n  MouseEventHandler,\n  useContext,\n  useRef,\n  useState,\n} from 'react';\nimport {TableContext} from './table-context';\nimport {TableCell} from './table-cell';\nimport {TableDataItem} from './types/table-data-item';\nimport {createEventHandler} from '../../utils/dom/create-event-handler';\nimport {usePointerEvents} from '../interactions/use-pointer-events';\nimport {isCtrlOrShiftPressed} from '../../utils/keybinds/is-ctrl-or-shift-pressed';\nimport {useTableRowStyle} from '@common/ui/tables/style/use-table-row-style';\nimport clsx from 'clsx';\n\nconst interactableElements = ['button', 'a', 'input', 'select', 'textarea'];\n\nexport interface RowElementProps<T = TableDataItem>\n  extends ComponentPropsWithoutRef<'tr'> {\n  item: T & {isPlaceholder?: boolean};\n}\n\ninterface TableRowProps {\n  item: TableDataItem;\n  index: number;\n  renderAs?: JSXElementConstructor<RowElementProps>;\n  className?: string;\n  style?: React.CSSProperties;\n}\nexport function TableRow({\n  item,\n  index,\n  renderAs,\n  className,\n  style,\n}: TableRowProps) {\n  const {\n    selectedRows,\n    columns,\n    toggleRow,\n    selectRow,\n    onAction,\n    selectRowOnContextMenu,\n    enableSelection,\n    selectionStyle,\n    hideHeaderRow,\n  } = useContext(TableContext);\n\n  const isTouchDevice = useRef(false);\n  const isSelected = selectedRows.includes(item.id);\n  const [isHovered, setIsHovered] = useState(false);\n\n  const clickedOnInteractable = (e: React.MouseEvent | PointerEvent) => {\n    return (e.target as HTMLElement).closest(interactableElements.join(','));\n  };\n\n  const doubleClickHandler: MouseEventHandler<HTMLDivElement> = e => {\n    if (\n      selectionStyle === 'highlight' &&\n      onAction &&\n      !isTouchDevice.current &&\n      !clickedOnInteractable(e)\n    ) {\n      e.preventDefault();\n      e.stopPropagation();\n      onAction(item, index);\n    }\n  };\n\n  const anyRowsSelected = !!selectedRows.length;\n\n  const handleRowTap = (e: PointerEvent) => {\n    if (clickedOnInteractable(e)) return;\n    if (selectionStyle === 'checkbox') {\n      if (enableSelection && (anyRowsSelected || !onAction)) {\n        toggleRow(item);\n      } else if (onAction) {\n        onAction(item, index);\n      }\n    } else if (selectionStyle === 'highlight') {\n      if (isTouchDevice.current) {\n        if (enableSelection && anyRowsSelected) {\n          toggleRow(item);\n        } else {\n          onAction?.(item, index);\n        }\n      } else if (enableSelection) {\n        selectRow(item, isCtrlOrShiftPressed(e));\n      }\n    }\n  };\n\n  const {domProps} = usePointerEvents({\n    onPointerDown: e => {\n      isTouchDevice.current = e.pointerType === 'touch';\n    },\n    onPress: handleRowTap,\n    onLongPress: enableSelection\n      ? () => {\n          if (isTouchDevice.current) {\n            toggleRow(item);\n          }\n        }\n      : undefined,\n  });\n\n  const keyboardHandler: KeyboardEventHandler = e => {\n    if (enableSelection && e.key === ' ') {\n      e.preventDefault();\n      e.stopPropagation();\n      if (selectionStyle === 'checkbox') {\n        toggleRow(item);\n      } else {\n        selectRow(item);\n      }\n    } else if (e.key === 'Enter' && !selectedRows.length && onAction) {\n      e.preventDefault();\n      e.stopPropagation();\n      onAction(item, index);\n    }\n  };\n\n  const contextMenuHandler: MouseEventHandler = e => {\n    if (selectRowOnContextMenu && enableSelection) {\n      if (!selectedRows.includes(item.id)) {\n        selectRow(item);\n      }\n    }\n    // prevent context menu on mobile\n    if (isTouchDevice.current) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  const styleClassName = useTableRowStyle({index, isSelected});\n\n  const RowElement = renderAs || 'div';\n  return (\n    <RowElement\n      role=\"row\"\n      aria-rowindex={index + 1 + (hideHeaderRow ? 0 : 1)}\n      aria-selected={isSelected}\n      tabIndex={-1}\n      className={clsx(className, styleClassName)}\n      item={RowElement === 'div' ? (undefined as any) : item}\n      onDoubleClick={createEventHandler(doubleClickHandler)}\n      onKeyDown={createEventHandler(keyboardHandler)}\n      onContextMenu={createEventHandler(contextMenuHandler)}\n      onPointerEnter={createEventHandler(() => setIsHovered(true))}\n      onPointerLeave={createEventHandler(() => setIsHovered(false))}\n      style={style}\n      {...domProps}\n    >\n      {columns.map((column, cellIndex) => (\n        <TableCell\n          rowIndex={index}\n          rowIsHovered={isHovered}\n          index={cellIndex}\n          item={item}\n          key={`${item.id}-${column.key}`}\n        />\n      ))}\n    </RowElement>\n  );\n}\n","import {ColumnConfig} from '@common/datatable/column-config';\nimport {TableDataItem} from '@common/ui/tables/types/table-data-item';\nimport {Skeleton} from '@common/ui/skeleton/skeleton';\nimport React, {useContext} from 'react';\nimport {Checkbox} from '@common/ui/forms/toggle/checkbox';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {TableContext} from '@common/ui/tables/table-context';\n\nexport const CheckboxColumnConfig: ColumnConfig<TableDataItem> = {\n  key: 'checkbox',\n  header: () => <SelectAllCheckbox />,\n  align: 'center',\n  width: 'w-24 flex-shrink-0',\n  body: (item, row) => {\n    if (row.isPlaceholder) {\n      return <Skeleton size=\"w-24 h-24\" variant=\"rect\" />;\n    }\n    return <SelectRowCheckbox item={item} />;\n  },\n};\n\ninterface SelectRowCheckboxProps {\n  item: TableDataItem;\n}\nfunction SelectRowCheckbox({item}: SelectRowCheckboxProps) {\n  const {selectedRows, toggleRow} = useContext(TableContext);\n  return (\n    <Checkbox\n      checked={selectedRows.includes(item.id)}\n      onChange={() => toggleRow(item)}\n    />\n  );\n}\n\nfunction SelectAllCheckbox() {\n  const {trans} = useTrans();\n\n  const {data, selectedRows, onSelectionChange} = useContext(TableContext);\n  const allRowsSelected = !!data.length && data.length === selectedRows.length;\n  const someRowsSelected = !allRowsSelected && !!selectedRows.length;\n\n  return (\n    <Checkbox\n      aria-label={trans({message: 'Select all'})}\n      isIndeterminate={someRowsSelected}\n      checked={allRowsSelected}\n      onChange={() => {\n        if (allRowsSelected) {\n          onSelectionChange([]);\n        } else {\n          onSelectionChange(data.map(d => d.id));\n        }\n      }}\n    />\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ArrowDownwardIcon = createSvgIcon(\n  <path d=\"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z\" />\n, 'ArrowDownwardOutlined');\n","import {useContext, useState} from 'react';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {TableContext} from './table-context';\nimport {SortDescriptor} from './types/sort-descriptor';\nimport {ArrowDownwardIcon} from '../../icons/material/ArrowDownward';\nimport {useTableCellStyle} from '@common/ui/tables/style/use-table-cell-style';\n\ninterface HeaderCellProps {\n  index: number;\n}\nexport function HeaderCell({index}: HeaderCellProps) {\n  const {columns, sortDescriptor, onSortChange, enableSorting} =\n    useContext(TableContext);\n  const column = columns[index];\n\n  const style = useTableCellStyle({\n    index: index,\n    isHeader: true,\n  });\n\n  const [isHovered, setIsHovered] = useState(false);\n\n  const sortingKey = column.sortingKey || column.key;\n  const allowSorting = column.allowsSorting && enableSorting;\n  const {orderBy, orderDir} = sortDescriptor || {};\n\n  const sortActive = allowSorting && orderBy === sortingKey;\n\n  let ariaSort: 'ascending' | 'descending' | 'none' | undefined;\n  if (sortActive && orderDir === 'asc') {\n    ariaSort = 'ascending';\n  } else if (sortActive && orderDir === 'desc') {\n    ariaSort = 'descending';\n  } else if (allowSorting) {\n    ariaSort = 'none';\n  }\n\n  const toggleSorting = () => {\n    if (!allowSorting) return;\n\n    let newSort: SortDescriptor;\n\n    // if this col was sorted desc, go to asc\n    if (sortActive && orderDir === 'desc') {\n      newSort = {orderDir: 'asc', orderBy: sortingKey};\n\n      // if this col was sorted asc, clear sort\n    } else if (sortActive && orderDir === 'asc') {\n      newSort = {orderBy: undefined, orderDir: undefined};\n\n      // if sort was on another col, or no sort was applied yet, start from desc\n    } else {\n      newSort = {orderDir: 'desc', orderBy: sortingKey};\n    }\n\n    onSortChange?.(newSort);\n  };\n\n  const sortVisible = sortActive || isHovered;\n  const sortVariants = {\n    visible: {opacity: 1, y: 0},\n    hidden: {opacity: 0, y: '-25%'},\n  };\n\n  return (\n    <div\n      role=\"columnheader\"\n      tabIndex={-1}\n      aria-colindex={index + 1}\n      aria-sort={ariaSort}\n      className={clsx(\n        style,\n        'text-muted font-medium text-xs',\n        allowSorting && 'cursor-pointer'\n      )}\n      onMouseEnter={() => {\n        setIsHovered(true);\n      }}\n      onMouseLeave={() => {\n        setIsHovered(false);\n      }}\n      onKeyDown={e => {\n        if (e.key === ' ' || e.key === 'Enter') {\n          e.preventDefault();\n          toggleSorting();\n        }\n      }}\n      onClick={toggleSorting}\n    >\n      {column.hideHeader ? (\n        <div className=\"sr-only\">{column.header()}</div>\n      ) : (\n        column.header()\n      )}\n      <AnimatePresence>\n        {allowSorting && (\n          <m.span\n            variants={sortVariants}\n            animate={sortVisible ? 'visible' : 'hidden'}\n            initial={false}\n            transition={{type: 'tween'}}\n            key=\"sort-icon\"\n            className=\"inline-block ml-6 -mt-2\"\n            data-testid=\"table-sort-button\"\n            aria-hidden={!sortVisible}\n          >\n            <ArrowDownwardIcon\n              size=\"xs\"\n              className={clsx(\n                'text-muted',\n                orderDir === 'asc' &&\n                  orderBy === sortingKey &&\n                  'rotate-180 transition-transform'\n              )}\n            />\n          </m.span>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n","import {HeaderCell} from '@common/ui/tables/header-cell';\nimport React, {useContext} from 'react';\nimport {TableContext} from '@common/ui/tables/table-context';\n\nexport function TableHeaderRow() {\n  const {columns} = useContext(TableContext);\n  return (\n    <div\n      role=\"row\"\n      aria-rowindex={1}\n      tabIndex={-1}\n      className=\"flex gap-x-16 px-16\"\n    >\n      {columns.map((column, columnIndex) => (\n        <HeaderCell index={columnIndex} key={column.key} />\n      ))}\n    </div>\n  );\n}\n","import React, {\n  cloneElement,\n  ComponentPropsWithoutRef,\n  Fragment,\n  JSXElementConstructor,\n  MutableRefObject,\n  ReactElement,\n  useCallback,\n  useContext,\n  useMemo,\n} from 'react';\nimport {useControlledState} from '@react-stately/utils';\nimport {SortDescriptor} from './types/sort-descriptor';\nimport {useGridNavigation} from './navigate-grid';\nimport {RowElementProps, TableRow} from './table-row';\nimport {\n  TableContext,\n  TableContextValue,\n  TableSelectionStyle,\n} from './table-context';\nimport {ColumnConfig} from '../../datatable/column-config';\nimport {TableDataItem} from './types/table-data-item';\nimport clsx from 'clsx';\nimport {useInteractOutside} from '@react-aria/interactions';\nimport {mergeProps, useObjectRef} from '@react-aria/utils';\nimport {isCtrlKeyPressed} from '@common/utils/keybinds/is-ctrl-key-pressed';\nimport {useIsMobileMediaQuery} from '@common/utils/hooks/is-mobile-media-query';\nimport {CheckboxColumnConfig} from '@common/ui/tables/checkbox-column-config';\nimport {TableHeaderRow} from '@common/ui/tables/table-header-row';\n\nexport interface TableProps<T extends TableDataItem>\n  extends ComponentPropsWithoutRef<'table'> {\n  className?: string;\n  columns: ColumnConfig<T>[];\n  hideHeaderRow?: boolean;\n  data: T[];\n  meta?: any;\n  tableRef?: MutableRefObject<HTMLTableElement>;\n  selectedRows?: (number | string)[];\n  defaultSelectedRows?: (number | string)[];\n  onSelectionChange?: (keys: (number | string)[]) => void;\n  sortDescriptor?: SortDescriptor;\n  onSortChange?: (descriptor: SortDescriptor) => any;\n  enableSorting?: boolean;\n  onDelete?: (items: T[]) => void;\n  enableSelection?: boolean;\n  selectionStyle?: TableSelectionStyle;\n  ariaLabelledBy?: string;\n  onAction?: (item: T, index: number) => void;\n  selectRowOnContextMenu?: boolean;\n  renderRowAs?: JSXElementConstructor<RowElementProps<T>>;\n  tableBody?: ReactElement<TableBodyProps>;\n  hideBorder?: boolean;\n  closeOnInteractOutside?: boolean;\n  collapseOnMobile?: boolean;\n  cellHeight?: string;\n}\nexport function Table<T extends TableDataItem>({\n  className,\n  columns: userColumns,\n  collapseOnMobile = true,\n  hideHeaderRow = false,\n  hideBorder = false,\n  data,\n  selectedRows: propsSelectedRows,\n  defaultSelectedRows: propsDefaultSelectedRows,\n  onSelectionChange: propsOnSelectionChange,\n  sortDescriptor: propsSortDescriptor,\n  onSortChange: propsOnSortChange,\n  enableSorting = true,\n  onDelete,\n  enableSelection = true,\n  selectionStyle = 'checkbox',\n  ariaLabelledBy,\n  selectRowOnContextMenu,\n  onAction,\n  renderRowAs,\n  tableBody,\n  meta,\n  tableRef: propsTableRef,\n  closeOnInteractOutside = false,\n  cellHeight,\n  ...domProps\n}: TableProps<T>) {\n  const isMobile = useIsMobileMediaQuery();\n  const isCollapsedMode = !!isMobile && collapseOnMobile;\n  if (isCollapsedMode) {\n    hideHeaderRow = true;\n    hideBorder = true;\n  }\n\n  const [selectedRows, onSelectionChange] = useControlledState(\n    propsSelectedRows,\n    propsDefaultSelectedRows || [],\n    propsOnSelectionChange\n  );\n\n  const [sortDescriptor, onSortChange] = useControlledState(\n    propsSortDescriptor,\n    undefined,\n    propsOnSortChange\n  );\n\n  const toggleRow = useCallback(\n    (item: TableDataItem) => {\n      const newValues = [...selectedRows];\n      if (!newValues.includes(item.id)) {\n        newValues.push(item.id);\n      } else {\n        const index = newValues.indexOf(item.id);\n        newValues.splice(index, 1);\n      }\n      onSelectionChange(newValues);\n    },\n    [selectedRows, onSelectionChange]\n  );\n\n  const selectRow = useCallback(\n    // allow deselecting all rows by passing in null\n    (item: TableDataItem | null, merge?: boolean) => {\n      let newValues: (string | number)[] = [];\n      if (item) {\n        newValues = merge\n          ? [...selectedRows?.filter(id => id !== item.id), item.id]\n          : [item.id];\n      }\n      onSelectionChange(newValues);\n    },\n    [selectedRows, onSelectionChange]\n  );\n\n  // add checkbox columns to config, if selection is enabled\n  const columns = useMemo(() => {\n    const filteredColumns = userColumns.filter(c => {\n      const visibleInMode = c.visibleInMode || 'regular';\n      if (visibleInMode === 'all') {\n        return true;\n      }\n      if (visibleInMode === 'compact' && isCollapsedMode) {\n        return true;\n      }\n      if (visibleInMode === 'regular' && !isCollapsedMode) {\n        return true;\n      }\n    });\n    const showCheckboxCell =\n      enableSelection && selectionStyle !== 'highlight' && !isMobile;\n    if (showCheckboxCell) {\n      filteredColumns.unshift(CheckboxColumnConfig);\n    }\n    return filteredColumns;\n  }, [isMobile, userColumns, enableSelection, selectionStyle, isCollapsedMode]);\n\n  const contextValue: TableContextValue<T> = {\n    isCollapsedMode,\n    cellHeight,\n    hideBorder,\n    hideHeaderRow,\n    selectedRows,\n    onSelectionChange,\n    enableSorting,\n    enableSelection,\n    selectionStyle,\n    data,\n    columns,\n    sortDescriptor,\n    onSortChange,\n    toggleRow,\n    selectRow,\n    onAction,\n    selectRowOnContextMenu,\n    meta,\n    collapseOnMobile,\n  };\n\n  const navProps = useGridNavigation({\n    cellCount: enableSelection ? columns.length + 1 : columns.length,\n    rowCount: data.length + 1,\n  });\n\n  const tableBodyProps: TableBodyProps = {\n    renderRowAs: renderRowAs as any,\n  };\n\n  if (!tableBody) {\n    tableBody = <BasicTableBody {...tableBodyProps} />;\n  } else {\n    tableBody = cloneElement(tableBody, tableBodyProps);\n  }\n\n  // deselect rows when clicking outside the table\n  const tableRef = useObjectRef(propsTableRef);\n  useInteractOutside({\n    ref: tableRef,\n    onInteractOutside: e => {\n      if (\n        closeOnInteractOutside &&\n        enableSelection &&\n        selectedRows?.length &&\n        // don't deselect if clicking on a dialog (for example is table row has a context menu)\n        !(e.target as HTMLElement).closest('[role=\"dialog\"]')\n      ) {\n        onSelectionChange([]);\n      }\n    },\n  });\n\n  return (\n    <TableContext.Provider value={contextValue as any}>\n      <div\n        {...mergeProps(domProps, navProps, {\n          onKeyDown: (e: KeyboardEvent) => {\n            if (e.key === 'Escape') {\n              e.preventDefault();\n              e.stopPropagation();\n              if (selectedRows?.length) {\n                onSelectionChange([]);\n              }\n            } else if (e.key === 'Delete') {\n              e.preventDefault();\n              e.stopPropagation();\n              if (selectedRows?.length) {\n                onDelete?.(\n                  data.filter(item => selectedRows?.includes(item.id))\n                );\n              }\n            } else if (isCtrlKeyPressed(e) && e.key === 'a') {\n              e.preventDefault();\n              e.stopPropagation();\n              if (enableSelection) {\n                onSelectionChange(data.map(item => item.id));\n              }\n            }\n          },\n        })}\n        role=\"grid\"\n        tabIndex={0}\n        aria-rowcount={data.length + 1}\n        aria-colcount={columns.length + 1}\n        ref={tableRef}\n        aria-multiselectable={enableSelection ? true : undefined}\n        aria-labelledby={ariaLabelledBy}\n        className={clsx(\n          className,\n          'select-none isolate outline-none text-sm focus-visible:ring-2'\n        )}\n      >\n        {!hideHeaderRow && <TableHeaderRow />}\n        {tableBody}\n      </div>\n    </TableContext.Provider>\n  );\n}\n\nexport interface TableBodyProps {\n  renderRowAs?: TableProps<TableDataItem>['renderRowAs'];\n}\nfunction BasicTableBody({renderRowAs}: TableBodyProps) {\n  const {data} = useContext(TableContext);\n  return (\n    <Fragment>\n      {data.map((item, rowIndex) => (\n        <TableRow\n          item={item}\n          index={rowIndex}\n          key={item.id}\n          renderAs={renderRowAs}\n        />\n      ))}\n    </Fragment>\n  );\n}\n","import {BackendResponse} from './backend-response';\n\nexport interface LengthAwarePaginationResponse<T> {\n  data: T[];\n  from: number;\n  to: number;\n  total: number;\n  per_page: number;\n  current_page: number;\n  last_page: number;\n  next_page: number;\n  prev_page: number;\n}\n\ninterface SimplePaginationResponse<T> {\n  data: T[];\n  from: number;\n  to: number;\n  per_page: number;\n  current_page: number;\n}\n\ninterface CursorPaginationResponse<T> {\n  data: T[];\n  next_cursor: string | null;\n  per_page: number;\n  prev_cursor: string | null;\n}\n\nexport type PaginationResponse<T> =\n  | LengthAwarePaginationResponse<T>\n  | SimplePaginationResponse<T>\n  | CursorPaginationResponse<T>;\n\nexport const EMPTY_PAGINATION_RESPONSE = {\n  pagination: {data: [], from: 0, to: 0, per_page: 15, current_page: 1},\n};\n\nexport interface PaginatedBackendResponse<T> extends BackendResponse {\n  pagination: PaginationResponse<T>;\n}\n\nexport function hasNextPage(pagination: PaginationResponse<unknown>): boolean {\n  if ('next_cursor' in pagination) {\n    return pagination.next_cursor != null;\n  }\n\n  if ('last_page' in pagination) {\n    return pagination.current_page < pagination.last_page;\n  }\n\n  return (\n    pagination.data.length > 0 && pagination.data.length >= pagination.per_page\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const FilterAltIcon = createSvgIcon(\n  <path d=\"M7 6h10l-5.01 6.3L7 6zm-2.75-.39C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z\" />\n, 'FilterAltOutlined');\n","import React, {\n  cloneElement,\n  isValidElement,\n  Key,\n  ReactElement,\n  ReactNode,\n  useId,\n  useRef,\n} from 'react';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {useControlledState} from '@react-stately/utils';\nimport {FocusScope, useFocusManager} from '@react-aria/focus';\nimport {KeyboardArrowDownIcon} from '../../icons/material/KeyboardArrowDown';\n\ntype Props = {\n  variant?: 'outline' | 'default' | 'minimal';\n  children?: ReactNode;\n  mode?: 'single' | 'multiple';\n  expandedValues?: Key[];\n  defaultExpandedValues?: Key[];\n  onExpandedChange?: (key: Key[]) => void;\n  className?: string;\n  isLazy?: boolean;\n};\nexport const Accordion = React.forwardRef<HTMLDivElement, Props>(\n  (\n    {\n      variant = 'default',\n      mode = 'single',\n      children,\n      className,\n      isLazy,\n      ...other\n    },\n    ref\n  ) => {\n    const [expandedValues, setExpandedValues] = useControlledState(\n      other.expandedValues,\n      other.defaultExpandedValues || [],\n      other.onExpandedChange\n    );\n\n    return (\n      <div\n        className={clsx(variant === 'outline' && 'space-y-10', className)}\n        ref={ref}\n        role=\"presentation\"\n      >\n        <AnimatePresence>\n          <FocusScope>\n            {React.Children.map(children, (child, index) => {\n              if (!isValidElement<ClonedItemProps>(child)) return null;\n              return cloneElement<ClonedItemProps>(child, {\n                key: child.key || index,\n                value: child.props.value || index,\n                mode,\n                variant,\n                expandedValues,\n                setExpandedValues,\n                isLazy,\n              });\n            })}\n          </FocusScope>\n        </AnimatePresence>\n      </div>\n    );\n  }\n);\n\ninterface AccordionItemProps {\n  children: ReactNode;\n  disabled?: boolean;\n  label: ReactNode;\n  description?: ReactNode;\n  value?: Key;\n  bodyClassName?: string;\n  labelClassName?: string;\n  buttonPadding?: string;\n  chevronPosition?: 'left' | 'right';\n  startIcon?: ReactElement;\n  endAppend?: ReactElement;\n}\ninterface ClonedItemProps extends AccordionItemProps {\n  variant?: 'outline' | 'default' | 'minimal';\n  expandedValues: Key[];\n  setExpandedValues: (keys: Key[]) => void;\n  mode: 'single' | 'multiple';\n  value: Key;\n  isLazy?: boolean;\n}\nexport function AccordionItem({\n  children,\n  label,\n  disabled,\n  bodyClassName,\n  labelClassName,\n  buttonPadding = 'py-10 pl-14 pr-10',\n  startIcon,\n  description,\n  endAppend,\n  chevronPosition = 'right',\n  ...other\n}: AccordionItemProps) {\n  const {expandedValues, setExpandedValues, variant, value, mode, isLazy} =\n    other as ClonedItemProps;\n  const ref = useRef<HTMLButtonElement>(null);\n  const isExpanded = !disabled && expandedValues.includes(value);\n  const wasExpandedOnce = useRef(false);\n  if (isExpanded) {\n    wasExpandedOnce.current = true;\n  }\n  const focusManager = useFocusManager();\n  const id = useId();\n  const buttonId = `${id}-button`;\n  const panelId = `${id}-panel`;\n\n  const onKeyDown = (e: React.KeyboardEvent<HTMLButtonElement>) => {\n    switch (e.key) {\n      case 'ArrowDown':\n        focusManager.focusNext();\n        break;\n      case 'ArrowUp':\n        focusManager.focusPrevious();\n        break;\n      case 'Home':\n        focusManager.focusFirst();\n        break;\n      case 'End':\n        focusManager.focusLast();\n        break;\n    }\n  };\n\n  const variants = {\n    open: {\n      height: 'auto',\n      visibility: 'visible',\n      transitionEnd: {\n        overflow: 'auto',\n      },\n    },\n    closed: {\n      height: 0,\n      overflow: 'hidden',\n      transitionEnd: {\n        visibility: 'hidden',\n      },\n    },\n  } as const;\n\n  const toggle = () => {\n    const i = expandedValues.indexOf(value);\n    if (i > -1) {\n      const newKeys = [...expandedValues];\n      newKeys.splice(i, 1);\n      setExpandedValues(newKeys);\n    } else if (mode === 'single') {\n      setExpandedValues([value]);\n    } else {\n      setExpandedValues([...expandedValues, value]);\n    }\n  };\n\n  const chevron = (\n    <div className={clsx(variant === 'minimal' && '')}>\n      <KeyboardArrowDownIcon\n        aria-hidden=\"true\"\n        size=\"md\"\n        className={clsx(\n          disabled ? 'text-disabled' : 'text-muted',\n          isExpanded && 'rotate-180 transition-transform'\n        )}\n      />\n    </div>\n  );\n\n  return (\n    <div\n      className={clsx(\n        variant === 'default' && 'border-b',\n        variant === 'outline' && 'border rounded',\n        disabled && 'text-disabled'\n      )}\n    >\n      <h3\n        className={clsx(\n          'flex items-center text-sm justify-between w-full',\n          disabled && 'pointer-events-none',\n          isExpanded && variant !== 'minimal'\n            ? 'border-b'\n            : 'border-b border-b-transparent',\n          variant === 'outline'\n            ? isExpanded\n              ? 'rounded-t'\n              : 'rounded'\n            : undefined\n        )}\n      >\n        <button\n          disabled={disabled}\n          aria-expanded={isExpanded}\n          id={buttonId}\n          aria-controls={panelId}\n          type=\"button\"\n          ref={ref}\n          onKeyDown={onKeyDown}\n          onClick={() => {\n            if (!disabled) {\n              toggle();\n            }\n          }}\n          className={clsx(\n            'flex items-center text-left gap-10 flex-auto outline-none hover:bg-hover focus-visible:bg-primary/focus',\n            buttonPadding\n          )}\n        >\n          {chevronPosition === 'left' && chevron}\n          {startIcon &&\n            cloneElement(startIcon, {\n              size: 'md',\n              className: clsx(\n                startIcon.props.className,\n                disabled ? 'text-disabled' : 'text-muted'\n              ),\n            })}\n          <div className=\"flex-auto overflow-hidden overflow-ellipsis\">\n            <div className={labelClassName} data-testid=\"accordion-label\">\n              {label}\n            </div>\n            {description && (\n              <div className=\"text-muted text-xs\">{description}</div>\n            )}\n          </div>\n          {chevronPosition === 'right' && chevron}\n        </button>\n        {endAppend && (\n          <div className=\"flex-shrink-0 text-sm text-muted px-4\">\n            {endAppend}\n          </div>\n        )}\n      </h3>\n      <m.div\n        aria-labelledby={id}\n        role=\"region\"\n        variants={variants}\n        transition={{type: 'tween', duration: 0.2}}\n        initial={false}\n        animate={isExpanded ? 'open' : 'closed'}\n      >\n        <div className={clsx('p-16', bodyClassName)}>\n          {!isLazy || wasExpandedOnce ? children : null}\n        </div>\n      </m.div>\n    </div>\n  );\n}\n","import {FormSelect} from '@common/ui/forms/select/select';\nimport {Item} from '@common/ui/forms/listbox/item';\nimport {Trans} from '@common/i18n/trans';\nimport {FilterPanelProps} from '@common/datatable/filters/panels/filter-panel-props';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {FilterSelectControl} from '@common/datatable/filters/backend-filter';\n\nexport function SelectFilterPanel({\n  filter,\n}: FilterPanelProps<FilterSelectControl>) {\n  const {trans} = useTrans();\n\n  return (\n    <FormSelect\n      size=\"sm\"\n      name={`${filter.key}.value`}\n      selectionMode=\"single\"\n      showSearchField={filter.control.showSearchField}\n      placeholder={\n        filter.control.placeholder\n          ? trans(filter.control.placeholder)\n          : undefined\n      }\n      searchPlaceholder={\n        filter.control.searchPlaceholder\n          ? trans(filter.control.searchPlaceholder)\n          : undefined\n      }\n    >\n      {filter.control.options.map(option => (\n        <Item key={option.key} value={option.key}>\n          <Trans {...option.label} />\n        </Item>\n      ))}\n    </FormSelect>\n  );\n}\n","import {FormDateRangePicker} from '@common/ui/forms/input-field/date/date-range-picker/form-date-range-picker';\nimport {FilterPanelProps} from '@common/datatable/filters/panels/filter-panel-props';\nimport {DatePickerFilterControl} from '@common/datatable/filters/backend-filter';\n\nexport function DateRangeFilterPanel({\n  filter,\n}: FilterPanelProps<DatePickerFilterControl>) {\n  return (\n    <FormDateRangePicker\n      min={filter.control.min}\n      max={filter.control.max}\n      size=\"sm\"\n      name={`${filter.key}.value`}\n      granularity=\"day\"\n      closeDialogOnSelection={true}\n    />\n  );\n}\n","import {useQuery, UseQueryOptions} from '@tanstack/react-query';\nimport {NormalizedModel} from '../../datatable/filters/normalized-model';\nimport {apiClient} from '../../http/query-client';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\n\nconst buildEndpoint = (model: string, prefix: string = 'normalized-models') => {\n  const parts = [];\n  if (prefix) {\n    parts.push(prefix);\n  }\n  if (model) {\n    parts.push(model);\n  }\n  return parts.join('/');\n};\n\ninterface Response extends BackendResponse {\n  results: NormalizedModel[];\n}\n\ninterface Params {\n  query?: string;\n  perPage?: number;\n  with?: string;\n}\n\nexport function useNormalizedModels(\n  model: string,\n  queryParams: Params,\n  queryOptions?: Omit<\n    UseQueryOptions<Response, unknown, Response, [string, Params]>,\n    'queryKey' | 'queryFn'\n  > | null,\n  userEndpoint?: string\n) {\n  const endpoint = buildEndpoint(model, userEndpoint);\n  return useQuery(\n    [endpoint, queryParams],\n    () => fetchUsers(endpoint, queryParams),\n    {\n      keepPreviousData: true,\n      ...queryOptions,\n    }\n  );\n}\n\nasync function fetchUsers(endpoint: string, params: Params) {\n  return apiClient.get<Response>(endpoint, {params}).then(r => r.data);\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {NormalizedModel} from '../../datatable/filters/normalized-model';\nimport {apiClient} from '../../http/query-client';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\n\nconst buildEndpoint = (\n  modelName: string,\n  modelId: string | number,\n  prefix = 'normalized-models'\n) => {\n  const parts = [];\n  if (prefix) {\n    parts.push(prefix);\n  }\n  if (modelName) {\n    parts.push(modelName);\n  }\n  if (modelId) {\n    parts.push(modelId);\n  }\n  return parts.join('/');\n};\n\ninterface Response extends BackendResponse {\n  model: NormalizedModel;\n}\n\nexport function useNormalizedModel(\n  model: string,\n  modelId: string | number | null,\n  queryParams?: Record<string, string>,\n  userEndpoint?: string\n) {\n  const endpoint = buildEndpoint(model, modelId!, userEndpoint);\n  return useQuery(\n    [endpoint, queryParams],\n    () => fetchModel(endpoint, queryParams),\n    {\n      enabled: model != null && modelId != null,\n    }\n  );\n}\n\nasync function fetchModel(\n  endpoint: string,\n  params?: Record<string, string>\n): Promise<Response> {\n  return apiClient.get(endpoint, {params}).then(r => r.data);\n}\n","import React, {ReactNode, useRef, useState} from 'react';\nimport {useTrans} from '../../i18n/use-trans';\nimport {Trans} from '../../i18n/trans';\nimport {Avatar} from '../images/avatar';\nimport {Tooltip} from '../tooltip/tooltip';\nimport {IconButton} from '../buttons/icon-button';\nimport {EditIcon} from '../../icons/material/Edit';\nimport {message} from '../../i18n/message';\nimport {Item} from './listbox/item';\nimport {useController} from 'react-hook-form';\nimport {useControlledState} from '@react-stately/utils';\nimport {getInputFieldClassNames} from './input-field/get-input-field-class-names';\nimport clsx from 'clsx';\nimport {Skeleton} from '../skeleton/skeleton';\nimport {useNormalizedModels} from '../../users/queries/use-normalized-models';\nimport {useNormalizedModel} from '../../users/queries/use-normalized-model';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {opacityAnimation} from '../animation/opacity-animation';\nimport {Select} from '@common/ui/forms/select/select';\nimport {MessageDescriptor} from '@common/i18n/message-descriptor';\nimport {BaseFieldProps} from '@common/ui/forms/input-field/base-field-props';\n\ninterface NormalizedModelFieldProps {\n  // can be empty string to simplify building custom endpoints\n  modelType: string | '';\n  label?: ReactNode;\n  className?: string;\n  background?: BaseFieldProps['background'];\n  value?: string | number;\n  placeholder?: MessageDescriptor;\n  searchPlaceholder?: MessageDescriptor;\n  defaultValue?: string | number;\n  onChange?: (value: string | number) => void;\n  invalid?: boolean;\n  errorMessage?: string;\n  description?: ReactNode;\n  autoFocus?: boolean;\n  queryParams?: Record<string, string>;\n  customEndpoint?: string;\n  singleEndpoint?: string;\n  multipleEndpoint?: string;\n  disabled?: boolean;\n}\nexport function NormalizedModelField({\n  modelType,\n  label,\n  className,\n  background,\n  value,\n  defaultValue = '',\n  placeholder = message('Select item...'),\n  searchPlaceholder = message('Find an item...'),\n  onChange,\n  description,\n  errorMessage,\n  invalid,\n  autoFocus,\n  queryParams,\n  customEndpoint,\n  singleEndpoint = customEndpoint,\n  multipleEndpoint = customEndpoint,\n  disabled,\n}: NormalizedModelFieldProps) {\n  const inputRef = useRef<HTMLButtonElement>(null);\n  const [inputValue, setInputValue] = useState('');\n  const [selectedValue, setSelectedValue] = useControlledState(\n    value,\n    defaultValue,\n    onChange\n  );\n  const query = useNormalizedModels(\n    modelType,\n    {\n      query: inputValue,\n      ...queryParams,\n    },\n    null,\n    multipleEndpoint\n  );\n  const {trans} = useTrans();\n\n  const fieldClassNames = getInputFieldClassNames({size: 'md'});\n\n  if (selectedValue) {\n    return (\n      <div className={className}>\n        <div className={fieldClassNames.label}>{label}</div>\n        <div\n          className={clsx(\n            'rounded border p-8',\n            background,\n            invalid && 'border-danger'\n          )}\n        >\n          <AnimatePresence initial={false} mode=\"wait\">\n            <SelectedModelPreview\n              disabled={disabled}\n              endpoint={singleEndpoint}\n              modelType={modelType}\n              modelId={selectedValue}\n              queryParams={queryParams}\n              onEditClick={() => {\n                setSelectedValue('');\n                setInputValue('');\n                requestAnimationFrame(() => {\n                  inputRef.current?.focus();\n                  inputRef.current?.click();\n                });\n              }}\n            />\n          </AnimatePresence>\n        </div>\n        {description && !errorMessage && (\n          <div className={fieldClassNames.description}>{description}</div>\n        )}\n        {errorMessage && (\n          <div className={fieldClassNames.error}>{errorMessage}</div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <Select\n      className={className}\n      showSearchField\n      invalid={invalid}\n      errorMessage={errorMessage}\n      description={description}\n      color=\"white\"\n      isAsync\n      background={background}\n      placeholder={trans(placeholder)}\n      searchPlaceholder={trans(searchPlaceholder)}\n      label={label}\n      isLoading={query.isFetching}\n      items={query.data?.results}\n      inputValue={inputValue}\n      onInputValueChange={setInputValue}\n      selectionMode=\"single\"\n      selectedValue={selectedValue}\n      onSelectionChange={setSelectedValue}\n      ref={inputRef}\n      autoFocus={autoFocus}\n      disabled={disabled}\n    >\n      {model => (\n        <Item\n          value={model.id}\n          key={model.id}\n          description={model.description}\n          startIcon={<Avatar src={model.image} />}\n        >\n          {model.name}\n        </Item>\n      )}\n    </Select>\n  );\n}\n\ninterface SelectedModelPreviewProps {\n  modelType: string;\n  modelId: string | number;\n  selectedValue?: number | string;\n  onEditClick?: () => void;\n  endpoint?: string;\n  disabled?: boolean;\n  queryParams?: NormalizedModelFieldProps['queryParams'];\n}\nfunction SelectedModelPreview({\n  modelType,\n  modelId,\n  onEditClick,\n  endpoint,\n  disabled,\n  queryParams,\n}: SelectedModelPreviewProps) {\n  const {data, isLoading} = useNormalizedModel(\n    modelType,\n    modelId,\n    queryParams,\n    endpoint\n  );\n\n  if (isLoading || !data?.model) {\n    return <LoadingSkeleton key=\"skeleton\" />;\n  }\n\n  return (\n    <m.div\n      className={clsx(\n        'flex items-center gap-10',\n        disabled && 'pointer-events-none cursor-not-allowed text-disabled'\n      )}\n      key=\"preview\"\n      {...opacityAnimation}\n    >\n      {data.model.image && <Avatar src={data.model.image} />}\n      <div>\n        <div className=\"text-sm leading-4\">{data.model.name}</div>\n        <div className=\"text-xs text-muted\">{data.model.description}</div>\n      </div>\n      <Tooltip label={<Trans message=\"Change item\" />}>\n        <IconButton\n          className=\"ml-auto text-muted\"\n          size=\"sm\"\n          onClick={onEditClick}\n          disabled={disabled}\n        >\n          <EditIcon />\n        </IconButton>\n      </Tooltip>\n    </m.div>\n  );\n}\n\nfunction LoadingSkeleton() {\n  return (\n    <m.div className=\"flex items-center gap-10\" {...opacityAnimation}>\n      <Skeleton variant=\"rect\" size=\"w-32 h-32\" />\n      <div className=\"max-h-[36px] flex-auto\">\n        <Skeleton className=\"text-xs\" />\n        <Skeleton className=\"max-h-8 text-xs\" />\n      </div>\n      <Skeleton variant=\"icon\" size=\"w-24 h-24\" />\n    </m.div>\n  );\n}\n\ninterface FormNormalizedModelFieldProps extends NormalizedModelFieldProps {\n  name: string;\n}\nexport function FormNormalizedModelField({\n  name,\n  ...fieldProps\n}: FormNormalizedModelFieldProps) {\n  const {\n    field: {onChange, value = ''},\n    fieldState: {invalid, error},\n  } = useController({\n    name,\n  });\n\n  return (\n    <NormalizedModelField\n      value={value}\n      onChange={onChange}\n      invalid={invalid}\n      errorMessage={error?.message}\n      {...fieldProps}\n    />\n  );\n}\n","import {FilterPanelProps} from './filter-panel-props';\nimport {FormNormalizedModelField} from '@common/ui/forms/normalized-model-field';\nimport {FilterSelectModelControl} from '@common/datatable/filters/backend-filter';\n\nexport function NormalizedModelFilterPanel({\n  filter,\n}: FilterPanelProps<FilterSelectModelControl>) {\n  return (\n    <FormNormalizedModelField\n      name={`${filter.key}.value`}\n      modelType={filter.control.model}\n    />\n  );\n}\n","import {FilterOperator} from './backend-filter';\nimport {message} from '../../i18n/message';\nimport {MessageDescriptor} from '../../i18n/message-descriptor';\n\nexport const FilterOperatorNames: {[op in FilterOperator]: MessageDescriptor} =\n  {\n    '=': message('is'),\n    '!=': message('is not'),\n    '>': message('is greater than'),\n    '>=': message('is greater than or equal to'),\n    '<': message('is less than'),\n    '<=': message('is less than or equal to'),\n    has: message('Include'),\n    doesntHave: message('Do not include'),\n    between: message('Is between'),\n    hasAll: message('Include all'),\n  };\n","import {FormTextField} from '@common/ui/forms/input-field/text-field/text-field';\nimport {Trans} from '@common/i18n/trans';\nimport {FormSelect} from '@common/ui/forms/select/select';\nimport {Item} from '@common/ui/forms/listbox/item';\nimport {FilterOperatorNames} from '@common/datatable/filters/filter-operator-names';\nimport {Fragment} from 'react';\nimport {FilterPanelProps} from '@common/datatable/filters/panels/filter-panel-props';\nimport {\n  FilterNumberInputControl,\n  FilterTextInputControl,\n} from '@common/datatable/filters/backend-filter';\n\nexport function InputFilterPanel({\n  filter,\n}: FilterPanelProps<FilterTextInputControl | FilterNumberInputControl>) {\n  const control = filter.control;\n  return (\n    <Fragment>\n      <FormSelect\n        selectionMode=\"single\"\n        name={`${filter.key}.operator`}\n        className=\"mb-14\"\n        size=\"sm\"\n        required\n      >\n        {filter.operators?.map(operator => (\n          <Item key={operator} value={operator}>\n            {<Trans {...FilterOperatorNames[operator]} />}\n          </Item>\n        ))}\n      </FormSelect>\n      <FormTextField\n        size=\"sm\"\n        name={`${filter.key}.value`}\n        type={filter.control.inputType}\n        min={'minValue' in control ? control.minValue : undefined}\n        max={'maxValue' in control ? control.maxValue : undefined}\n        minLength={'minLength' in control ? control.minLength : undefined}\n        maxLength={'maxLength' in control ? control.maxLength : undefined}\n        required\n      />\n    </Fragment>\n  );\n}\n","import {FilterPanelProps} from './filter-panel-props';\nimport {FilterBooleanToggleControl} from '@common/datatable/filters/backend-filter';\n\nexport function BooleanFilterPanel({\n  filter,\n}: FilterPanelProps<FilterBooleanToggleControl>) {\n  // Toggling accordion in the dialog will already apply boolean filter, no need for any extra fields here\n  return null;\n}\n","import React, {Children, cloneElement, isValidElement, ReactElement} from 'react';\nimport clsx from 'clsx';\nimport type {ChipProps} from './chip';\n\ninterface ChipListProps {\n  className?: string;\n  children?: ReactElement | ReactElement[];\n  size?: ChipProps['size'];\n  radius?: ChipProps['radius'];\n  color?: ChipProps['color'];\n  selectable?: ChipProps['selectable'];\n}\nexport function ChipList({\n  className,\n  children,\n  size,\n  color,\n  radius,\n  selectable,\n}: ChipListProps) {\n  return (\n    <div className={clsx(className, 'flex items-center gap-8 flex-wrap')}>\n      {Children.map(children, chip => {\n        if (isValidElement<ChipProps>(chip)) {\n          return cloneElement<ChipProps>(chip, {\n            size,\n            color,\n            selectable,\n            radius,\n          });\n        }\n      })}\n    </div>\n  );\n}\n","import {ChipValue} from './chip-field';\n\nexport function stringToChipValue(value: string | number): ChipValue {\n  // add both name and description so \"validateWith\" works properly in chip field, if it depends on description\n  return {id: value, name: `${value}`, description: `${value}`};\n}\n","import React, {\n  HTMLAttributes,\n  Key,\n  ReactElement,\n  ReactNode,\n  Ref,\n  RefObject,\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport {useFocusManager} from '@react-aria/focus';\nimport clsx from 'clsx';\nimport {mergeProps, useLayoutEffect, useObjectRef} from '@react-aria/utils';\nimport {useControlledState} from '@react-stately/utils';\nimport {ChipList} from './chip-list';\nimport {Field} from '../field';\nimport {Input} from '../input';\nimport {Chip, ChipProps} from './chip';\nimport {NormalizedModel} from '@common/datatable/filters/normalized-model';\nimport {getInputFieldClassNames} from '../get-input-field-class-names';\nimport {ProgressCircle} from '../../../progress/progress-circle';\nimport {useField} from '../use-field';\nimport {Avatar} from '../../../images/avatar';\nimport {Listbox} from '../../listbox/listbox';\nimport {useListbox} from '../../listbox/use-listbox';\nimport {BaseFieldPropsWithDom} from '../base-field-props';\nimport {useListboxKeyboardNavigation} from '../../listbox/use-listbox-keyboard-navigation';\nimport {createEventHandler} from '@common/utils/dom/create-event-handler';\nimport {ListBoxChildren, ListboxProps} from '../../listbox/types';\nimport {stringToChipValue} from './string-to-chip-value';\nimport {Popover} from '../../../overlays/popover';\nimport {KeyboardArrowDownIcon} from '@common/icons/material/KeyboardArrowDown';\n\nexport interface ChipValue extends Omit<NormalizedModel, 'model_type'> {\n  invalid?: boolean;\n  errorMessage?: string;\n}\n\nexport type ChipFieldProps<T> = Omit<\n  ListboxProps,\n  'selectionMode' | 'displayWith'\n> &\n  Omit<\n    BaseFieldPropsWithDom<HTMLInputElement>,\n    'value' | 'onChange' | 'defaultValue'\n  > & {\n    value?: (ChipValue | string)[];\n    defaultValue?: (ChipValue | string)[];\n    displayWith?: (value: ChipValue) => ReactNode;\n    validateWith?: (value: ChipValue) => ChipValue;\n    allowCustomValue?: boolean;\n    showDropdownArrow?: boolean;\n    onChange?: (value: ChipValue[]) => void;\n    suggestions?: T[];\n    children?: ListBoxChildren<T>['children'];\n    placeholder?: string;\n    chipSize?: ChipProps['size'];\n    openMenuOnFocus?: boolean;\n    valueKey?: 'id' | 'name';\n    onChipClick?: (value: ChipValue) => void;\n  };\n\nfunction ChipFieldInner<T>(\n  props: ChipFieldProps<T>,\n  ref: Ref<HTMLInputElement>\n) {\n  const fieldRef = useRef<HTMLDivElement>(null);\n  const inputRef = useObjectRef(ref);\n  const {\n    displayWith = v => v.name,\n    validateWith,\n    children,\n    suggestions,\n    isLoading,\n    inputValue,\n    onInputValueChange,\n    onItemSelected,\n    placeholder,\n    onOpenChange,\n    chipSize = 'md',\n    openMenuOnFocus = true,\n    showEmptyMessage,\n    value: propsValue,\n    defaultValue,\n    onChange: propsOnChange,\n    valueKey,\n    isAsync,\n    allowCustomValue = true,\n    showDropdownArrow,\n    onChipClick,\n    ...inputFieldProps\n  } = props;\n  const fieldClassNames = getInputFieldClassNames({\n    ...props,\n    flexibleHeight: true,\n  });\n\n  const [value, onChange] = useChipFieldValueState(props);\n\n  const [listboxIsOpen, setListboxIsOpen] = useState(false);\n\n  const loadingIndicator = (\n    <ProgressCircle isIndeterminate size=\"sm\" aria-label=\"loading...\" />\n  );\n\n  const dropdownArrow = showDropdownArrow ? <KeyboardArrowDownIcon /> : null;\n\n  const {fieldProps, inputProps} = useField({\n    ...inputFieldProps,\n    focusRef: inputRef,\n    endAdornment: isLoading && listboxIsOpen ? loadingIndicator : dropdownArrow,\n  });\n\n  return (\n    <Field fieldClassNames={fieldClassNames} {...fieldProps}>\n      <Input\n        ref={fieldRef}\n        className={clsx('flex items-center flex-wrap', fieldClassNames.input)}\n        onClick={() => {\n          // refocus input when clicking outside it, but while still inside chip field\n          inputRef.current?.focus();\n        }}\n      >\n        <ListWrapper\n          displayChipUsing={displayWith}\n          onChipClick={onChipClick}\n          items={value}\n          setItems={onChange}\n          chipSize={chipSize}\n        />\n        <ChipInput\n          showEmptyMessage={showEmptyMessage}\n          inputProps={inputProps}\n          inputValue={inputValue}\n          onInputValueChange={onInputValueChange}\n          fieldRef={fieldRef}\n          inputRef={inputRef}\n          chips={value}\n          setChips={onChange}\n          validateWith={validateWith}\n          isLoading={isLoading}\n          suggestions={suggestions}\n          placeholder={placeholder}\n          openMenuOnFocus={openMenuOnFocus}\n          listboxIsOpen={listboxIsOpen}\n          setListboxIsOpen={setListboxIsOpen}\n          allowCustomValue={allowCustomValue}\n        >\n          {children}\n        </ChipInput>\n      </Input>\n    </Field>\n  );\n}\n\ninterface ListWrapperProps {\n  items: ChipValue[];\n  setItems: (items: ChipValue[]) => void;\n  displayChipUsing: (value: ChipValue) => ReactNode;\n  chipSize?: ChipProps['size'];\n  onChipClick?: (value: ChipValue) => void;\n}\nfunction ListWrapper({\n  items,\n  setItems,\n  displayChipUsing,\n  chipSize,\n  onChipClick,\n}: ListWrapperProps) {\n  const manager = useFocusManager();\n  const removeItem = useCallback(\n    (key: Key) => {\n      const i = items.findIndex(cr => cr.id === key);\n      const newItems = [...items];\n      if (i > -1) {\n        newItems.splice(i, 1);\n        setItems(newItems);\n      }\n      return newItems;\n    },\n    [items, setItems]\n  );\n\n  return (\n    <ChipList\n      className=\"flex-shrink-0 flex-wrap max-w-full my-8\"\n      size={chipSize}\n      selectable\n    >\n      {items.map(item => (\n        <Chip\n          key={item.id}\n          errorMessage={item.errorMessage}\n          adornment={item.image ? <Avatar circle src={item.image} /> : null}\n          onClick={() => onChipClick?.(item)}\n          onRemove={() => {\n            const newItems = removeItem(item.id);\n            if (newItems.length) {\n              // focus previous chip\n              manager.focusPrevious({tabbable: true});\n            } else {\n              // focus input\n              manager.focusLast();\n            }\n          }}\n        >\n          {displayChipUsing(item)}\n        </Chip>\n      ))}\n    </ChipList>\n  );\n}\n\ninterface ChipInputProps<T> {\n  showEmptyMessage?: boolean;\n  inputProps: ReturnType<typeof useField>['inputProps'];\n  inputValue?: string;\n  onInputValueChange?: (value: string) => void;\n  fieldRef: RefObject<HTMLDivElement>;\n  inputRef: RefObject<HTMLInputElement>;\n  chips: ChipValue[];\n  setChips: (items: ChipValue[]) => void;\n  validateWith?: (value: ChipValue) => ChipValue;\n  isLoading?: boolean;\n  suggestions?: T[];\n  placeholder?: string;\n  openMenuOnFocus?: boolean;\n  listboxIsOpen: boolean;\n  setListboxIsOpen: (value: boolean) => void;\n  allowCustomValue: boolean;\n  children: ListBoxChildren<T>['children'];\n}\nfunction ChipInput<T>(props: ChipInputProps<T>) {\n  const {\n    inputRef,\n    fieldRef,\n    validateWith,\n    setChips,\n    chips,\n    suggestions,\n    inputProps,\n    placeholder,\n    openMenuOnFocus,\n    listboxIsOpen,\n    setListboxIsOpen,\n    allowCustomValue,\n  } = props;\n  const inputClassName = 'outline-none text-sm mx-8 my-4 h-30 flex-auto';\n  const manager = useFocusManager();\n\n  const addItems = useCallback(\n    (items?: ChipValue[]) => {\n      items = (items || []).filter(item => {\n        const invalid = !item || !item.id || !item.name;\n        const alreadyExists = chips.findIndex(cr => cr.id === item?.id) > -1;\n        return !alreadyExists && !invalid;\n      });\n      if (!items.length) return;\n\n      if (validateWith) {\n        items = items.map(item => validateWith(item));\n      }\n      setChips([...chips, ...items]);\n    },\n    [chips, setChips, validateWith]\n  );\n\n  const listbox = useListbox<T>({\n    ...props,\n    clearInputOnItemSelection: true,\n    isOpen: listboxIsOpen,\n    onOpenChange: setListboxIsOpen,\n    items: suggestions,\n    selectionMode: 'none',\n    role: 'listbox',\n    virtualFocus: true,\n    onItemSelected: value => {\n      handleItemSelection(value as string);\n    },\n  });\n\n  const {\n    state: {\n      activeIndex,\n      setActiveIndex,\n      isOpen,\n      setIsOpen,\n      inputValue,\n      setInputValue,\n    },\n    refs,\n    listboxId,\n    collection,\n    onInputChange,\n  } = listbox;\n\n  const handleItemSelection = (textValue: string) => {\n    const option =\n      collection.size && activeIndex != null\n        ? [...collection.values()][activeIndex]\n        : null;\n    if (option?.item) {\n      addItems([option.item]);\n    } else if (allowCustomValue) {\n      addItems([stringToChipValue(option ? option.value : textValue)]);\n    }\n\n    setInputValue('');\n    setActiveIndex(null);\n    setIsOpen(false);\n  };\n\n  // position dropdown relative to whole chip field, not the input\n  useLayoutEffect(() => {\n    if (fieldRef.current && refs.reference.current !== fieldRef.current) {\n      listbox.reference(fieldRef.current);\n    }\n  }, [fieldRef, listbox, refs]);\n\n  const {handleTriggerKeyDown, handleListboxKeyboardNavigation} =\n    useListboxKeyboardNavigation(listbox);\n\n  const handleFocusAndClick = createEventHandler(() => {\n    if (openMenuOnFocus && !isOpen) {\n      setIsOpen(true);\n    }\n  });\n\n  return (\n    <Listbox\n      listbox={listbox}\n      mobileOverlay={Popover}\n      onPointerDown={e => {\n        // prevent focus from leaving input when scrolling listbox via mouse\n        e.preventDefault();\n      }}\n    >\n      <input\n        type=\"text\"\n        className={clsx(inputClassName, 'bg-transparent')}\n        placeholder={placeholder}\n        {...mergeProps(inputProps, {\n          ref: inputRef,\n          value: inputValue,\n          onChange: onInputChange,\n          onPaste: e => {\n            const paste = e.clipboardData.getData('text');\n            const emails = paste.match(\n              /([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi\n            );\n            if (emails) {\n              e.preventDefault();\n              const selection = window.getSelection();\n              if (selection?.rangeCount) {\n                selection.deleteFromDocument();\n                addItems(emails.map(email => stringToChipValue(email)));\n              }\n            }\n          },\n          'aria-autocomplete': 'list',\n          'aria-controls': isOpen ? listboxId : undefined,\n          autoComplete: 'off',\n          autoCorrect: 'off',\n          spellCheck: 'false',\n          onKeyDown: e => {\n            const input = e.target as HTMLInputElement;\n\n            if (e.key === 'Enter') {\n              // prevent form submitting\n              e.preventDefault();\n              // add chip from selected listbox option or current input text value\n              handleItemSelection(input.value);\n              return;\n            }\n\n            // on escape, clear input and close dropdown\n            if (e.key === 'Escape' && isOpen) {\n              setIsOpen(false);\n              setInputValue('');\n            }\n\n            // move focus to input when focus is on first item and prevent arrow up from cycling listbox\n            if (\n              e.key === 'ArrowUp' &&\n              isOpen &&\n              (activeIndex === 0 || activeIndex == null)\n            ) {\n              setActiveIndex(null);\n              return;\n            }\n\n            // block left and right arrows from navigating in input, if focus is on listbox\n            if (\n              activeIndex != null &&\n              (e.key === 'ArrowLeft' || e.key === 'ArrowRight')\n            ) {\n              e.preventDefault();\n              return;\n            }\n\n            // move focus on the last chip, if focus is at the  start of input\n            if (\n              (e.key === 'ArrowLeft' ||\n                e.key === 'Backspace' ||\n                e.key === 'Delete') &&\n              input.selectionStart === 0 &&\n              activeIndex == null &&\n              chips.length\n            ) {\n              manager.focusPrevious({tabbable: true});\n              return;\n            }\n\n            // fallthrough to listbox navigation handlers for arrow keys\n            const handled = handleTriggerKeyDown(e);\n            if (!handled) {\n              handleListboxKeyboardNavigation(e);\n            }\n          },\n          onFocus: handleFocusAndClick,\n          onClick: handleFocusAndClick,\n        } as HTMLAttributes<HTMLInputElement>)}\n      />\n    </Listbox>\n  );\n}\n\nfunction useChipFieldValueState({\n  onChange,\n  value,\n  defaultValue,\n  valueKey,\n}: ChipFieldProps<any>) {\n  // convert value from string[] to ChipValue[], if needed\n  const propsValue = useMemo(() => {\n    return mixedValueToChipValue(value);\n  }, [value]);\n\n  // convert defaultValue from string[] to ChipValue[], if needed\n  const propsDefaultValue = useMemo(() => {\n    return mixedValueToChipValue(defaultValue);\n  }, [defaultValue]);\n\n  // emit string[] or ChipValue[] on change, based on \"valueKey\" prop\n  const handleChange = useCallback(\n    (value: ChipValue[]) => {\n      const newValue = valueKey ? value.map(v => v[valueKey]) : value;\n      onChange?.(newValue as any);\n    },\n    [onChange, valueKey]\n  );\n\n  return useControlledState<ChipValue[]>(\n    !propsValue ? undefined : propsValue,\n    propsDefaultValue || [],\n    handleChange\n  );\n}\n\nfunction mixedValueToChipValue(\n  value?: (string | number | ChipValue)[] | null\n): ChipValue[] | undefined {\n  if (value == null) {\n    return undefined;\n  }\n\n  return value.map(v => {\n    return typeof v !== 'object' ? stringToChipValue(v as string) : v;\n  });\n}\n\nexport const ChipField = React.forwardRef(ChipFieldInner) as <T>(\n  props: ChipFieldProps<T> & {ref?: Ref<HTMLInputElement>}\n) => ReactElement;\n","import {useController} from 'react-hook-form';\nimport {mergeProps} from '@react-aria/utils';\nimport React from 'react';\nimport {ChipField, ChipFieldProps} from './chip-field';\n\nexport type FormChipFieldProps<T> = ChipFieldProps<T> & {\n  name: string;\n};\n\nexport function FormChipField<T>({children, ...props}: FormChipFieldProps<T>) {\n  const {\n    field: {onChange, onBlur, value = [], ref},\n    fieldState: {invalid, error},\n  } = useController({\n    name: props.name,\n  });\n\n  const formProps: Partial<ChipFieldProps<T>> = {\n    onChange,\n    onBlur,\n    value,\n    invalid,\n    errorMessage: error?.message,\n  };\n\n  return (\n    <ChipField ref={ref} {...mergeProps(formProps, props)}>\n      {children}\n    </ChipField>\n  );\n}\n","import {Item} from '@common/ui/forms/listbox/item';\nimport {FilterPanelProps} from '@common/datatable/filters/panels/filter-panel-props';\nimport {FormChipField} from '@common/ui/forms/input-field/chip-field/form-chip-field';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {FilterChipFieldControl} from '@common/datatable/filters/backend-filter';\nimport {Trans} from '@common/i18n/trans';\n\nexport function ChipFieldFilterPanel({\n  filter,\n}: FilterPanelProps<FilterChipFieldControl>) {\n  const {trans} = useTrans();\n  return (\n    <FormChipField\n      size=\"sm\"\n      name={`${filter.key}.value`}\n      valueKey=\"id\"\n      allowCustomValue={false}\n      showDropdownArrow\n      placeholder={\n        filter.control.placeholder\n          ? trans(filter.control.placeholder)\n          : undefined\n      }\n      displayWith={chip =>\n        filter.control.options.find(o => o.key === chip.id)?.label.message\n      }\n      suggestions={filter.control.options.map(o => ({\n        id: o.key,\n        name: o.label.message,\n      }))}\n    >\n      {chip => (\n        <Item key={chip.id} value={chip.id}>\n          {<Trans message={chip.name} />}\n        </Item>\n      )}\n    </FormChipField>\n  );\n}\n","import {Dialog} from '../../ui/overlays/dialog/dialog';\nimport {\n  BackendFilter,\n  CustomFilterControl,\n  DatePickerFilterControl,\n  FilterBooleanToggleControl,\n  FilterChipFieldControl,\n  FilterControlType,\n  FilterOperator,\n  FilterSelectControl,\n  FilterSelectModelControl,\n  FilterTextInputControl,\n} from './backend-filter';\nimport {Trans} from '../../i18n/trans';\nimport {Key, useState} from 'react';\nimport {DialogHeader} from '../../ui/overlays/dialog/dialog-header';\nimport {DialogBody} from '../../ui/overlays/dialog/dialog-body';\nimport {useBackendFilterUrlParams} from './backend-filter-url-params';\nimport {useDialogContext} from '../../ui/overlays/dialog/dialog-context';\nimport {Accordion, AccordionItem} from '../../ui/accordion/accordion';\nimport {Button} from '../../ui/buttons/button';\nimport {useForm} from 'react-hook-form';\nimport {Form} from '../../ui/forms/form';\nimport {Checkbox} from '../../ui/forms/toggle/checkbox';\nimport {SelectFilterPanel} from './panels/select-filter-panel';\nimport {DateRangeFilterPanel} from './panels/date-range-filter-panel';\nimport {NormalizedModelFilterPanel} from './panels/normalized-model-filter-panel';\nimport {InputFilterPanel} from './panels/input-filter-panel';\nimport {BooleanFilterPanel} from './panels/boolean-filter-panel';\nimport clsx from 'clsx';\nimport {ChipFieldFilterPanel} from '@common/datatable/filters/panels/chip-field-filter-panel';\n\nexport interface FilterItemFormValue<T = any> {\n  value: T;\n  operator?: FilterOperator;\n}\n\ninterface AddFilterDialogProps {\n  filters: BackendFilter[];\n}\nexport function AddFilterDialog({filters}: AddFilterDialogProps) {\n  const {decodedFilters} = useBackendFilterUrlParams(filters);\n  const {formId} = useDialogContext();\n\n  // expand currently active filters\n  const [expandedFilters, setExpandedFilters] = useState<Key[]>(() => {\n    return decodedFilters.map(f => f.key);\n  });\n\n  const clearButton = (\n    <Button\n      size=\"xs\"\n      variant=\"outline\"\n      className=\"mr-auto\"\n      onClick={() => {\n        setExpandedFilters([]);\n      }}\n    >\n      <Trans message=\"Clear\" />\n    </Button>\n  );\n\n  const applyButton = (\n    <Button\n      size=\"xs\"\n      variant=\"flat\"\n      color=\"primary\"\n      className=\"ml-auto\"\n      type=\"submit\"\n      form={formId}\n    >\n      <Trans message=\"Apply\" />\n    </Button>\n  );\n\n  return (\n    <Dialog className=\"min-w-[300px]\" maxWidth=\"max-w-400\" size=\"auto\">\n      <DialogHeader\n        padding=\"px-14 py-10\"\n        leftAdornment={clearButton}\n        rightAdornment={applyButton}\n      >\n        <Trans message=\"Filter\" />\n      </DialogHeader>\n      <DialogBody padding=\"p-0\">\n        <FilterList\n          filters={filters}\n          expandedFilters={expandedFilters}\n          setExpandedFilters={setExpandedFilters}\n        />\n      </DialogBody>\n    </Dialog>\n  );\n}\n\ninterface FilterListProps {\n  filters: BackendFilter[];\n  expandedFilters: Key[];\n  setExpandedFilters: (value: Key[]) => void;\n}\nfunction FilterList({\n  filters,\n  expandedFilters,\n  setExpandedFilters,\n}: FilterListProps) {\n  const {decodedFilters, replaceAll} = useBackendFilterUrlParams(filters);\n\n  // either get value and operator from url params if filter is active, or get defaults from filter config\n  const defaultValues: Record<string, FilterItemFormValue> = {};\n  filters.forEach(filter => {\n    const appliedFilter = decodedFilters.find(f => f.key === filter.key);\n    defaultValues[filter.key] =\n      appliedFilter?.value !== undefined\n        ? // there might be some extra keys set on filter besides\n          // \"value\" and \"operator\", so add the whole object to form\n          appliedFilter\n        : {\n            value: filter.control.defaultValue,\n            operator: filter.defaultOperator,\n          };\n  });\n  const form = useForm<Record<string, FilterItemFormValue>>({defaultValues});\n  const {formId, close} = useDialogContext();\n\n  return (\n    <Form\n      form={form}\n      id={formId}\n      onSubmit={formValue => {\n        const filterValue = Object.entries(formValue)\n          // remove undefined and non-expanded filters, so \"clear\" button will correctly remove active filters\n          .filter(\n            ([key, fieldValue]) =>\n              expandedFilters.includes(key) && fieldValue !== undefined\n          )\n          .map(([key, fieldValue]) => ({\n            key,\n            ...fieldValue, // value and operator from form\n          }));\n\n        replaceAll(filterValue);\n        close();\n      }}\n    >\n      <Accordion\n        mode=\"multiple\"\n        expandedValues={expandedFilters}\n        onExpandedChange={setExpandedFilters}\n      >\n        {filters.map(filter => (\n          <AccordionItem\n            startIcon={\n              <Checkbox checked={expandedFilters.includes(filter.key)} />\n            }\n            key={filter.key}\n            value={filter.key}\n            label={<Trans {...filter.label} />}\n            bodyClassName=\"max-h-288 overflow-y-auto compact-scrollbar\"\n          >\n            {filter.description && (\n              <div\n                className={clsx(\n                  'text-xs text-muted',\n                  // boolean filter will have nothing in the panel, no need to add margin\n                  filter.control.type !== FilterControlType.BooleanToggle &&\n                    'mb-14'\n                )}\n              >\n                <Trans {...filter.description} />\n              </div>\n            )}\n            <AddFilterDialogPanel filter={filter} />\n          </AccordionItem>\n        ))}\n      </Accordion>\n    </Form>\n  );\n}\n\ninterface ActiveFilterPanelProps {\n  filter: BackendFilter;\n}\nexport function AddFilterDialogPanel({filter}: ActiveFilterPanelProps) {\n  switch (filter.control.type) {\n    case FilterControlType.Select:\n      return (\n        <SelectFilterPanel\n          filter={filter as BackendFilter<FilterSelectControl>}\n        />\n      );\n    case FilterControlType.ChipField:\n      return (\n        <ChipFieldFilterPanel\n          filter={filter as BackendFilter<FilterChipFieldControl>}\n        />\n      );\n    case FilterControlType.DateRangePicker:\n      return (\n        <DateRangeFilterPanel\n          filter={filter as BackendFilter<DatePickerFilterControl>}\n        />\n      );\n    case FilterControlType.SelectModel:\n      return (\n        <NormalizedModelFilterPanel\n          filter={filter as BackendFilter<FilterSelectModelControl>}\n        />\n      );\n    case FilterControlType.Input:\n      return (\n        <InputFilterPanel\n          filter={filter as BackendFilter<FilterTextInputControl>}\n        />\n      );\n    case FilterControlType.BooleanToggle:\n      return (\n        <BooleanFilterPanel\n          filter={filter as BackendFilter<FilterBooleanToggleControl>}\n        />\n      );\n    case 'custom':\n      const CustomComponent = filter.control.panel;\n      return (\n        <CustomComponent\n          filter={filter as BackendFilter<CustomFilterControl>}\n        />\n      );\n    default:\n      return null;\n  }\n}\n","import {Button, ButtonProps} from '../../ui/buttons/button';\nimport {BackendFilter} from './backend-filter';\nimport {FilterAltIcon} from '../../icons/material/FilterAlt';\nimport {Trans} from '../../i18n/trans';\nimport {useIsMobileMediaQuery} from '../../utils/hooks/is-mobile-media-query';\nimport {IconButton} from '../../ui/buttons/icon-button';\nimport {DialogTrigger} from '../../ui/overlays/dialog/dialog-trigger';\nimport {AddFilterDialog} from './add-filter-dialog';\nimport {ReactElement} from 'react';\n\ninterface AddFilterButtonProps {\n  filters: BackendFilter[];\n  icon?: ReactElement;\n  color?: ButtonProps['color'];\n  variant?: ButtonProps['variant'];\n  disabled?: boolean;\n  size?: ButtonProps['size'];\n}\nexport function AddFilterButton({\n  filters,\n  icon = <FilterAltIcon />,\n  color = 'primary',\n  variant = 'outline',\n  size = 'sm',\n  disabled,\n}: AddFilterButtonProps) {\n  const isMobile = useIsMobileMediaQuery();\n\n  const desktopButton = (\n    <Button\n      variant={variant}\n      color={color}\n      startIcon={icon}\n      disabled={disabled}\n      size={size}\n    >\n      <Trans message=\"Filter\" />\n    </Button>\n  );\n\n  const mobileButton = (\n    <IconButton\n      color={color}\n      size=\"sm\"\n      variant={variant}\n      disabled={disabled}\n      radius=\"rounded\"\n    >\n      {icon}\n    </IconButton>\n  );\n\n  return (\n    <DialogTrigger type=\"popover\">\n      {isMobile ? mobileButton : desktopButton}\n      <AddFilterDialog filters={filters} />\n    </DialogTrigger>\n  );\n}\n","import {BackendFilter, FilterControlType} from '../backend-filter';\nimport {ComponentPropsWithRef, forwardRef, ReactNode} from 'react';\nimport {Button} from '@common/ui/buttons/button';\nimport {KeyboardArrowDownIcon} from '@common/icons/material/KeyboardArrowDown';\nimport {Trans} from '@common/i18n/trans';\nimport clsx from 'clsx';\n\ninterface TriggerButtonProps\n  extends Omit<ComponentPropsWithRef<'button'>, 'color'> {\n  isInactive?: boolean;\n  filter: BackendFilter;\n  children?: ReactNode;\n}\nexport const FilterListTriggerButton = forwardRef<\n  HTMLButtonElement,\n  TriggerButtonProps\n>((props, ref) => {\n  // pass through all props from menu trigger and dialog trigger to button\n  const {isInactive, filter, ...domProps} = props;\n\n  if (isInactive) {\n    return <InactiveFilterButton filter={filter} {...domProps} ref={ref} />;\n  }\n\n  return <ActiveFilterButton filter={filter} {...domProps} ref={ref} />;\n});\n\ninterface InactiveFilterButtonProps\n  extends Omit<ComponentPropsWithRef<'button'>, 'color'> {\n  filter: BackendFilter;\n}\nexport const InactiveFilterButton = forwardRef<\n  HTMLButtonElement,\n  InactiveFilterButtonProps\n>(({filter, ...domProps}, ref) => {\n  return (\n    <Button\n      variant=\"outline\"\n      size=\"xs\"\n      color=\"paper\"\n      radius=\"rounded-md\"\n      border=\"border\"\n      ref={ref}\n      endIcon={<KeyboardArrowDownIcon />}\n      {...domProps}\n    >\n      <Trans {...filter.label} />\n    </Button>\n  );\n});\n\nexport const ActiveFilterButton = forwardRef<\n  HTMLButtonElement,\n  InactiveFilterButtonProps\n>(({filter, children, ...domProps}, ref) => {\n  const isBoolean = filter.control.type === FilterControlType.BooleanToggle;\n  return (\n    <Button\n      variant=\"outline\"\n      size=\"xs\"\n      color=\"primary\"\n      radius=\"rounded-r-md\"\n      border=\"border-y border-r\"\n      endIcon={!isBoolean && <KeyboardArrowDownIcon />}\n      ref={ref}\n      {...domProps}\n    >\n      <span\n        className={clsx(\n          !isBoolean && 'border-r border-r-primary-light mr-8 pr-8'\n        )}\n      >\n        <Trans {...filter.label} />\n      </span>\n      {children}\n    </Button>\n  );\n});\n","import {DialogTrigger} from '../../../ui/overlays/dialog/dialog-trigger';\nimport {FilterListTriggerButton} from './filter-list-trigger-button';\nimport {ReactNode} from 'react';\nimport {useForm} from 'react-hook-form';\nimport {FilterItemFormValue} from '../add-filter-dialog';\nimport {useDialogContext} from '../../../ui/overlays/dialog/dialog-context';\nimport {Dialog} from '../../../ui/overlays/dialog/dialog';\nimport {DialogHeader} from '../../../ui/overlays/dialog/dialog-header';\nimport {Trans} from '../../../i18n/trans';\nimport {DialogBody} from '../../../ui/overlays/dialog/dialog-body';\nimport {Form} from '../../../ui/forms/form';\nimport {DialogFooter} from '../../../ui/overlays/dialog/dialog-footer';\nimport {Button} from '../../../ui/buttons/button';\nimport {FilterListControlProps} from './filter-list-control';\n\ninterface FilterListItemDialogTriggerProps extends FilterListControlProps<any> {\n  label: ReactNode;\n  panel: ReactNode;\n}\nexport function FilterListItemDialogTrigger(\n  props: FilterListItemDialogTriggerProps\n) {\n  const {onValueChange, isInactive, filter, label} = props;\n  return (\n    <DialogTrigger\n      offset={10}\n      type=\"popover\"\n      onClose={(value?: FilterItemFormValue) => {\n        if (value !== undefined) {\n          onValueChange(value);\n        }\n      }}\n    >\n      <FilterListTriggerButton isInactive={isInactive} filter={filter}>\n        {label}\n      </FilterListTriggerButton>\n      <FilterListControlDialog {...props} />\n    </DialogTrigger>\n  );\n}\n\nexport function FilterListControlDialog({\n  filter,\n  panel,\n  value,\n  operator,\n}: FilterListItemDialogTriggerProps) {\n  const form = useForm<Record<string, FilterItemFormValue>>({\n    defaultValues: {\n      [filter.key]: {value, operator},\n    },\n  });\n  const {close, formId} = useDialogContext();\n  return (\n    <Dialog size=\"xs\">\n      <DialogHeader>\n        <Trans {...filter.label} />\n      </DialogHeader>\n      <DialogBody padding=\"px-14 pt-14 pb-4 max-h-288\">\n        <Form\n          form={form}\n          id={formId}\n          onSubmit={formValue => {\n            close(formValue[filter.key]);\n          }}\n        >\n          {filter.description && (\n            <div className=\"text-muted text-xs mb-14\">\n              <Trans {...filter.description} />\n            </div>\n          )}\n          {panel}\n        </Form>\n      </DialogBody>\n      <DialogFooter>\n        <Button\n          form={formId}\n          type=\"submit\"\n          variant=\"flat\"\n          color=\"primary\"\n          size=\"xs\"\n        >\n          <Trans message=\"Apply\" />\n        </Button>\n      </DialogFooter>\n    </Dialog>\n  );\n}\n","import {Fragment, memo} from 'react';\nimport {useNumberFormatter} from './use-number-formatter';\nimport {NumberFormatOptions} from '@internationalized/number';\nimport {shallowEqual} from '../utils/shallow-equal';\n\ninterface FormattedNumberProps extends NumberFormatOptions {\n  value: number;\n}\nexport const FormattedNumber = memo(\n  ({value, ...options}: FormattedNumberProps) => {\n    const formatter = useNumberFormatter(options);\n\n    if (isNaN(value)) {\n      value = 0;\n    }\n\n    return <Fragment>{formatter.format(value)}</Fragment>;\n  },\n  shallowEqual\n);\n","import {\n  BackendFilter,\n  CustomFilterControl,\n  DatePickerFilterControl,\n  FilterBooleanToggleControl,\n  FilterChipFieldControl,\n  FilterControl,\n  FilterControlType,\n  FilterNumberInputControl,\n  FilterOperator,\n  FilterSelectControl,\n  FilterSelectModelControl,\n  FilterTextInputControl,\n} from '../backend-filter';\nimport {FilterListTriggerButton} from './filter-list-trigger-button';\nimport {Trans} from '@common/i18n/trans';\nimport {SelectFilterPanel} from '../panels/select-filter-panel';\nimport {FilterListItemDialogTrigger} from './filter-list-item-dialog-trigger';\nimport {Avatar} from '@common/ui/images/avatar';\nimport {NormalizedModelFilterPanel} from '../panels/normalized-model-filter-panel';\nimport {DateRangeFilterPanel} from '../panels/date-range-filter-panel';\nimport {Fragment, Key, ReactNode} from 'react';\nimport {DateRangePresets} from '@common/ui/forms/input-field/date/date-range-picker/dialog/date-range-presets';\nimport {FormattedDateTimeRange} from '@common/i18n/formatted-date-time-range';\nimport {AbsoluteDateRange} from '@common/ui/forms/input-field/date/date-range-picker/form-date-range-picker';\nimport {InputFilterPanel} from '../panels/input-filter-panel';\nimport {FilterOperatorNames} from '../filter-operator-names';\nimport {FilterItemFormValue} from '../add-filter-dialog';\nimport {useNormalizedModel} from '@common/users/queries/use-normalized-model';\nimport {Skeleton} from '@common/ui/skeleton/skeleton';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {ChipFieldFilterPanel} from '@common/datatable/filters/panels/chip-field-filter-panel';\nimport {FormattedNumber} from '@common/i18n/formatted-number';\n\nexport interface FilterListControlProps<T = unknown, E = FilterControl> {\n  filter: BackendFilter<E>;\n  onValueChange: (value: FilterItemFormValue<T>) => void;\n  value: T;\n  operator?: FilterOperator;\n  isInactive?: boolean;\n}\nexport function FilterListControl(props: FilterListControlProps<any, any>) {\n  switch (props.filter.control.type) {\n    case FilterControlType.DateRangePicker:\n      return <DatePickerControl {...props} />;\n    case FilterControlType.BooleanToggle:\n      return <BooleanToggleControl {...props} />;\n    case FilterControlType.Select:\n      return <SelectControl {...props} />;\n    case FilterControlType.ChipField:\n      return <ChipFieldControl {...props} />;\n    case FilterControlType.Input:\n      return <InputControl {...props} />;\n    case FilterControlType.SelectModel:\n      return <SelectModelControl {...props} />;\n    case FilterControlType.Custom:\n      const Control = (props.filter.control as CustomFilterControl).listItem;\n      return <Control {...props} />;\n    default:\n      return null;\n  }\n}\n\nfunction DatePickerControl(\n  props: FilterListControlProps<\n    Required<AbsoluteDateRange>,\n    DatePickerFilterControl\n  >\n) {\n  const {value, filter} = props;\n\n  let valueLabel: ReactNode;\n  if (value.preset !== undefined) {\n    valueLabel = <Trans {...DateRangePresets[value.preset].label} />;\n  } else {\n    valueLabel = (\n      <FormattedDateTimeRange\n        start={new Date(value.start)}\n        end={new Date(value.end)}\n        options={{dateStyle: 'medium'}}\n      />\n    );\n  }\n\n  return (\n    <FilterListItemDialogTrigger\n      {...props}\n      label={valueLabel}\n      panel={<DateRangeFilterPanel filter={filter} />}\n    />\n  );\n}\n\nfunction BooleanToggleControl({\n  filter,\n  isInactive,\n  onValueChange,\n}: FilterListControlProps<\n  FilterBooleanToggleControl['defaultValue'],\n  FilterBooleanToggleControl\n>) {\n  // todo: toggle control on or off here\n  return (\n    <FilterListTriggerButton\n      onClick={() => {\n        onValueChange({value: filter.control.defaultValue});\n      }}\n      filter={filter}\n      isInactive={isInactive}\n    />\n  );\n}\n\nfunction SelectControl(\n  props: FilterListControlProps<Key, FilterSelectControl>\n) {\n  const {filter, value} = props;\n  const option = filter.control.options.find(o => o.key === value);\n  return (\n    <FilterListItemDialogTrigger\n      {...props}\n      label={option ? <Trans {...option.label} /> : null}\n      panel={<SelectFilterPanel filter={filter} />}\n    />\n  );\n}\n\nfunction ChipFieldControl(\n  props: FilterListControlProps<string[], FilterChipFieldControl>\n) {\n  return (\n    <FilterListItemDialogTrigger\n      {...props}\n      label={<MultipleValues {...props} />}\n      panel={<ChipFieldFilterPanel filter={props.filter} />}\n    />\n  );\n}\n\nfunction MultipleValues(\n  props: FilterListControlProps<string[], FilterChipFieldControl>\n) {\n  const {trans} = useTrans();\n  const {filter, value} = props;\n  const options = value.map(v => filter.control.options.find(o => o.key === v));\n  const maxShownCount = 3;\n  const notShownCount = value.length - maxShownCount;\n\n  // translate names, add commas and limit to 3\n  const names = (\n    <Fragment>\n      {options\n        .filter(Boolean)\n        .slice(0, maxShownCount)\n        .map((o, i) => {\n          let name = '';\n          if (i !== 0) {\n            name += ', ';\n          }\n          name += trans(o!.label);\n          return name;\n        })}\n    </Fragment>\n  );\n\n  // indicate that there are some names not shown\n  return notShownCount > 0 ? (\n    <Trans\n      message=\":names + :count more\"\n      values={{names: names, count: notShownCount}}\n    />\n  ) : (\n    names\n  );\n}\n\nfunction InputControl(\n  props: FilterListControlProps<\n    string,\n    FilterTextInputControl | FilterNumberInputControl\n  >\n) {\n  const {filter, value, operator} = props;\n\n  const operatorLabel = operator ? (\n    <Trans {...FilterOperatorNames[operator]} />\n  ) : null;\n\n  const formattedValue =\n    filter.control.inputType === 'number' ? (\n      <FormattedNumber value={value as any} />\n    ) : (\n      value\n    );\n\n  return (\n    <FilterListItemDialogTrigger\n      {...props}\n      label={\n        <Fragment>\n          {operatorLabel} {formattedValue}\n        </Fragment>\n      }\n      panel={<InputFilterPanel filter={filter} />}\n    />\n  );\n}\n\nfunction SelectModelControl(\n  props: FilterListControlProps<string, FilterSelectModelControl>\n) {\n  const {value, filter} = props;\n  const {isLoading, data} = useNormalizedModel(filter.control.model!, value);\n\n  const skeleton = (\n    <Fragment>\n      <Skeleton variant=\"avatar\" size=\"w-18 h-18 mr-6\" />\n      <Skeleton variant=\"rect\" size=\"w-50\" />\n    </Fragment>\n  );\n  const modelPreview = (\n    <Fragment>\n      <Avatar size=\"xs\" src={data?.model.image} className=\"mr-6\" />\n      {data?.model.name}\n    </Fragment>\n  );\n\n  const label = isLoading || !data ? skeleton : modelPreview;\n\n  return (\n    <FilterListItemDialogTrigger\n      {...props}\n      label={label}\n      panel={<NormalizedModelFilterPanel filter={filter} />}\n    />\n  );\n}\n","import clsx from 'clsx';\nimport {BackendFilter} from '../backend-filter';\nimport {useBackendFilterUrlParams} from '../backend-filter-url-params';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {CloseIcon} from '@common/icons/material/Close';\nimport {FilterListControl} from './filter-list-control';\nimport {FilterItemFormValue} from '../add-filter-dialog';\n\ninterface FilterListProps {\n  filters: BackendFilter[];\n  // these filters will always be shown, even if value is not yet selected for filter\n  pinnedFilters?: string[];\n  className?: string;\n}\nexport function FilterList({\n  filters,\n  pinnedFilters,\n  className,\n}: FilterListProps) {\n  const {decodedFilters, remove, replaceAll} = useBackendFilterUrlParams(\n    filters,\n    pinnedFilters\n  );\n\n  if (!decodedFilters.length) return null;\n\n  return (\n    <div className={clsx('flex items-center gap-6 overflow-x-auto', className)}>\n      {decodedFilters.map((field, index) => {\n        const filter = filters.find(f => f.key === field.key);\n\n        if (!filter) return null;\n\n        const handleValueChange = (payload: FilterItemFormValue) => {\n          const newFilters = [...decodedFilters];\n          newFilters.splice(index, 1, {\n            key: filter.key,\n            value: payload.value,\n            isInactive: false,\n            operator: payload.operator || filter.defaultOperator,\n          });\n          replaceAll(newFilters);\n        };\n\n        return (\n          <div key={field.key}>\n            {!field.isInactive && (\n              <IconButton\n                variant=\"outline\"\n                color=\"primary\"\n                size=\"xs\"\n                radius=\"rounded-l-md\"\n                onClick={() => {\n                  remove(field.key);\n                }}\n              >\n                <CloseIcon />\n              </IconButton>\n            )}\n            <FilterListControl\n              filter={filter}\n              isInactive={field.isInactive}\n              value={field.valueKey != null ? field.valueKey : field.value}\n              operator={field.operator}\n              onValueChange={handleValueChange}\n            />\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n","import {m} from 'framer-motion';\nimport {opacityAnimation} from '@common/ui/animation/opacity-animation';\nimport {Skeleton} from '@common/ui/skeleton/skeleton';\nimport React from 'react';\n\nexport function FilterListSkeleton() {\n  return (\n    <m.div\n      className=\"flex items-center gap-6 h-30\"\n      key=\"filter-list-skeleton\"\n      {...opacityAnimation}\n    >\n      <Skeleton variant=\"rect\" size=\"h-full w-144\" radius=\"rounded-md\" />\n      <Skeleton variant=\"rect\" size=\"h-full w-112\" radius=\"rounded-md\" />\n      <Skeleton variant=\"rect\" size=\"h-full w-172\" radius=\"rounded-md\" />\n    </m.div>\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const AddIcon = createSvgIcon(\n  <path d=\"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\" />\n, 'AddOutlined');\n","import React, {ComponentPropsWithoutRef, ReactNode, useId} from 'react';\nimport clsx from 'clsx';\nimport {useController} from 'react-hook-form';\nimport {mergeProps, useObjectRef} from '@react-aria/utils';\nimport {InputSize} from '../input-field/input-size';\nimport {getInputFieldClassNames} from '../input-field/get-input-field-class-names';\nimport {AutoFocusProps, useAutoFocus} from '../../focus/use-auto-focus';\n\ninterface SwitchProps\n  extends AutoFocusProps,\n    Omit<ComponentPropsWithoutRef<'input'>, 'size'> {\n  size?: InputSize;\n  className?: string;\n  description?: ReactNode;\n  invalid?: boolean;\n  errorMessage?: string;\n}\nexport const Switch = React.forwardRef<HTMLInputElement, SwitchProps>(\n  (props, ref) => {\n    const {\n      children,\n      size = 'sm',\n      description,\n      className,\n      invalid,\n      autoFocus,\n      errorMessage,\n      ...domProps\n    } = props;\n\n    const inputRef = useObjectRef(ref);\n    useAutoFocus({autoFocus}, inputRef);\n\n    const style = getSizeClassName(size);\n    const fieldClassNames = getInputFieldClassNames(props);\n\n    const descriptionId = useId();\n\n    return (\n      <div className={clsx(className, 'isolate')}>\n        <label className=\"flex items-center select-none\">\n          <input\n            {...domProps}\n            type=\"checkbox\"\n            role=\"switch\"\n            aria-invalid={invalid || undefined}\n            aria-describedby={description ? descriptionId : undefined}\n            ref={inputRef}\n            aria-checked={domProps.checked}\n            className={clsx(\n              style,\n              !invalid &&\n                'checked:bg-primary dark:checked:bg-primary-dark checked:border-primary dark:checked:border-primary-dark',\n              invalid && 'checked:bg-danger checked:border-danger',\n              'outline-none cursor-pointer bg-chip border-chip border checked:bg-primary checked:border-primary p-0 overflow-hidden relative rounded-3xl appearance-none transition-colors flex-shrink-0 flex items-center outline-none',\n              'before:z-10 before:border before:rounded-3xl before:block before:bg-white before:transition-transform before:translate-x-2',\n              'checked:before:border-white',\n              'focus-visible:ring',\n              props.disabled && 'opacity-80 cursor-not-allowed'\n            )}\n          />\n          {children && (\n            <span\n              className={clsx(\n                fieldClassNames.size.font,\n                'ml-12',\n                invalid && 'text-danger',\n                props.disabled && 'text-disabled'\n              )}\n            >\n              {children}\n            </span>\n          )}\n        </label>\n        {description && !errorMessage && (\n          <div id={descriptionId} className={fieldClassNames.description}>\n            {description}\n          </div>\n        )}\n        {errorMessage && (\n          <div id={descriptionId} className={fieldClassNames.error}>\n            {errorMessage}\n          </div>\n        )}\n      </div>\n    );\n  }\n);\n\ninterface FormSwitchProps extends SwitchProps {\n  name: string;\n}\nexport function FormSwitch(props: FormSwitchProps) {\n  const {\n    field: {onChange, onBlur, value = false, ref},\n    fieldState: {invalid, error},\n  } = useController({\n    name: props.name,\n  });\n\n  const formProps: Partial<SwitchProps> = {\n    onChange: e => {\n      if (e.target.value && e.target.value !== 'on') {\n        onChange(e.target.checked ? e.target.value : false);\n      } else {\n        onChange(e);\n      }\n    },\n    onBlur,\n    checked: !!value,\n    invalid,\n    errorMessage: error?.message,\n    name: props.name,\n  };\n\n  return <Switch ref={ref} {...mergeProps(props, formProps)} />;\n}\n\nfunction getSizeClassName(size: InputSize): string {\n  switch (size) {\n    case 'xl':\n      return 'w-68 h-36 before:w-28 before:h-28 checked:before:translate-x-36';\n    case 'lg':\n      return 'w-56 h-30 before:w-22 before:h-22 checked:before:translate-x-30';\n    case 'md':\n      return 'w-46 h-24 before:w-18 before:h-18 checked:before:translate-x-24';\n    case 'xs':\n      return 'w-30 h-16 before:w-12 before:h-12 checked:before:translate-x-16';\n    default:\n      return 'w-38 h-20 before:w-14 before:h-14 checked:before:translate-x-20';\n  }\n}\n","const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...a) => api.dispatch(...a), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api)\n    return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (e) {\n  }\n  if (!extensionConnector) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && enabled) {\n      console.warn(\n        \"[zustand devtools middleware] Please install/enable Redux devtools extension\"\n      );\n    }\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = (state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording)\n      return r;\n    const action = nameOrAction === void 0 ? { type: anonymousActionType || \"anonymous\" } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...a) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && a[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...a);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools)\n              return;\n            if (typeof api.dispatch !== \"function\")\n              return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState)\n              return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, f) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0)\n    f(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = (selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  };\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nconst combine = (initialState, create) => (...a) => Object.assign({}, initialState, create(...a));\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(\n      name,\n      JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n    ),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst oldImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    getStorage: () => localStorage,\n    serialize: JSON.stringify,\n    deserialize: JSON.parse,\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage;\n  try {\n    storage = options.getStorage();\n  } catch (e) {\n  }\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const thenableSerialize = toThenable(options.serialize);\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    let errorInSync;\n    const thenable = thenableSerialize({ state, version: options.version }).then(\n      (serializedValue) => storage.setItem(options.name, serializedValue)\n    ).catch((e) => {\n      errorInSync = e;\n    });\n    if (errorInSync) {\n      throw errorInSync;\n    }\n    return thenable;\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a;\n    if (!storage)\n      return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => cb(get()));\n    const postRehydrationCallback = ((_a = options.onRehydrateStorage) == null ? void 0 : _a.call(options, get())) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((storageValue) => {\n      if (storageValue) {\n        return options.deserialize(storageValue);\n      }\n    }).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return deserializedStorageValue.state;\n        }\n      }\n    }).then((migratedState) => {\n      var _a2;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      return setItem();\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.getStorage) {\n        storage = newOptions.getStorage();\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  hydrate();\n  return stateFromStorage || configResult;\n};\nconst newImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage)\n      return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return deserializedStorageValue.state;\n        }\n      }\n    }).then((migratedState) => {\n      var _a2;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      return setItem();\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persistImpl = (config, baseOptions) => {\n  if (\"getStorage\" in baseOptions || \"serialize\" in baseOptions || \"deserialize\" in baseOptions) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead.\"\n      );\n    }\n    return oldImpl(config, baseOptions);\n  }\n  return newImpl(config, baseOptions);\n};\nconst persist = persistImpl;\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector };\n","import React, {ReactNode} from 'react';\nimport clsx from 'clsx';\nimport {getInputFieldClassNames} from '../input-field/get-input-field-class-names';\nimport {UseSliderProps, UseSliderReturn} from './use-slider';\n\nexport interface BaseSliderProps extends UseSliderProps {\n  slider: UseSliderReturn;\n  children: ReactNode;\n}\n\nexport function BaseSlider(props: BaseSliderProps) {\n  const {\n    size = 'md',\n    inline,\n    label,\n    showValueLabel = !!label,\n    className,\n    width = 'w-full',\n    slider,\n    children,\n    trackColor = 'primary',\n    fillColor = 'primary',\n  } = props;\n\n  const {\n    domProps,\n    trackRef,\n    getThumbPercent,\n    getThumbValueLabel,\n    labelId,\n    groupId,\n    thumbIds,\n    isDisabled,\n    numberFormatter,\n    minValue,\n    maxValue,\n    step,\n    values,\n    getValueLabel,\n  } = slider;\n\n  let outputValue = '';\n  let maxLabelLength = Math.max(\n    [...numberFormatter.format(minValue)].length,\n    [...numberFormatter.format(maxValue)].length,\n    [...numberFormatter.format(step)].length\n  );\n\n  if (getValueLabel) {\n    outputValue = getValueLabel(values[0]);\n  } else if (values.length === 1) {\n    outputValue = getThumbValueLabel(0);\n  } else if (values.length === 2) {\n    // This should really use the NumberFormat#formatRange proposal...\n    // https://github.com/tc39/ecma402/issues/393\n    // https://github.com/tc39/proposal-intl-numberformat-v3#formatrange-ecma-402-393\n    outputValue = `${getThumbValueLabel(0)}  ${getThumbValueLabel(1)}`;\n    maxLabelLength =\n      3 +\n      2 *\n        Math.max(\n          maxLabelLength,\n          [...numberFormatter.format(minValue)].length,\n          [...numberFormatter.format(maxValue)].length\n        );\n  }\n  const style = getInputFieldClassNames({\n    size,\n    disabled: isDisabled,\n    labelDisplay: 'flex',\n  });\n\n  const wrapperClassname = clsx('touch-none', className, width, {\n    'flex items-center': inline,\n  });\n\n  return (\n    <div className={wrapperClassname} role=\"group\" id={groupId}>\n      {(label || showValueLabel) && (\n        <div className={clsx(style.label, 'select-none')}>\n          {label && (\n            <label\n              onClick={() => {\n                // Safari does not focus <input type=\"range\"> elements when clicking on an associated <label>,\n                // so do it manually. In addition, make sure we show the focus ring.\n                document.getElementById(thumbIds[0])?.focus();\n              }}\n              id={labelId}\n              htmlFor={groupId}\n            >\n              {label}\n            </label>\n          )}\n          {showValueLabel && (\n            <output\n              htmlFor={thumbIds[0]}\n              className=\"ml-auto text-right\"\n              aria-live=\"off\"\n              style={\n                !maxLabelLength\n                  ? undefined\n                  : {\n                      width: `${maxLabelLength}ch`,\n                      minWidth: `${maxLabelLength}ch`,\n                    }\n              }\n            >\n              {outputValue}\n            </output>\n          )}\n        </div>\n      )}\n      <div\n        ref={trackRef}\n        className=\"h-30 relative\"\n        {...domProps}\n        role=\"presentation\"\n      >\n        <div\n          className={`absolute inset-0 m-auto h-4 rounded ${getTrackColor(\n            trackColor,\n            isDisabled\n          )}`}\n        />\n        <div\n          className={`absolute inset-0 my-auto h-4 rounded ${getFillColor(\n            fillColor,\n            isDisabled\n          )}`}\n          style={{width: `${getThumbPercent(0) * 100}%`}}\n        />\n        {children}\n      </div>\n    </div>\n  );\n}\n\nfunction getTrackColor(color: string, isDisabled: boolean): string {\n  if (isDisabled) {\n    color = 'disabled';\n  }\n  switch (color) {\n    case 'disabled':\n      return 'bg-slider-disabled/60';\n    case 'primary':\n      return 'bg-primary-light';\n    case 'neutral':\n      return 'bg-divider';\n    default:\n      return color;\n  }\n}\n\nfunction getFillColor(color: string, isDisabled: boolean): string {\n  if (isDisabled) {\n    color = 'disabled';\n  }\n  switch (color) {\n    case 'disabled':\n      return 'bg-slider-disabled';\n    case 'primary':\n      return 'bg-primary';\n    default:\n      return color;\n  }\n}\n","import {\n  mergeProps,\n  snapValueToStep,\n  useGlobalListeners,\n} from '@react-aria/utils';\nimport {useControlledState} from '@react-stately/utils';\nimport React, {\n  HTMLAttributes,\n  ReactNode,\n  RefObject,\n  useId,\n  useRef,\n  useState,\n} from 'react';\nimport {clamp} from '@common/utils/number/clamp';\nimport {usePointerEvents} from '../../interactions/use-pointer-events';\nimport {useNumberFormatter} from '@common/i18n/use-number-formatter';\nimport type {NumberFormatOptions} from '@internationalized/number';\nimport {InputSize} from '../input-field/input-size';\n\nexport interface UseSliderProps<T = number[]> {\n  formatOptions?: NumberFormatOptions;\n  onPointerDown?: () => void;\n  onPointerMove?: (e: React.PointerEvent) => void;\n  onChange?: (value: T) => void;\n  onChangeEnd?: (value: T) => void;\n  value?: T;\n  defaultValue?: T;\n  getValueLabel?: (value: number) => string;\n  minValue?: number;\n  maxValue?: number;\n  step?: number;\n  isDisabled?: boolean;\n  size?: InputSize;\n  label?: ReactNode;\n  inline?: boolean;\n  className?: string;\n  width?: string;\n  showValueLabel?: boolean;\n  fillColor?: 'primary' | string;\n  trackColor?: 'primary' | 'neutral' | string;\n  showThumbOnHoverOnly?: boolean;\n  thumbSize?: string;\n}\n\nexport interface UseSliderReturn {\n  domProps: HTMLAttributes<HTMLElement>;\n  trackRef: RefObject<HTMLDivElement>;\n  isPointerOver: boolean;\n  showThumbOnHoverOnly?: boolean;\n  thumbSize?: string;\n  step: number;\n  isDisabled: boolean;\n  values: number[];\n  minValue: number;\n  maxValue: number;\n  focusedThumb: number | undefined;\n  labelId: string | undefined;\n  groupId: string;\n  thumbIds: string[];\n  numberFormatter: Intl.NumberFormat;\n  getThumbPercent: (index: number) => number;\n  getThumbMinValue: (index: number) => number;\n  getThumbMaxValue: (index: number) => number;\n  getThumbValueLabel: (index: number) => string;\n  setThumbValue: (index: number, value: number) => void;\n  updateDraggedThumbs: (index: number, dragging: boolean) => void;\n  isThumbDragging: (index: number) => boolean;\n  setThumbEditable: (index: number, editable: boolean) => void;\n  setFocusedThumb: (index: number | undefined) => void;\n  getValueLabel?: (value: number) => string;\n}\n\nexport function useSlider({\n  minValue = 0,\n  maxValue = 100,\n  isDisabled = false,\n  step = 1,\n  formatOptions,\n  onChangeEnd,\n  onPointerDown,\n  label,\n  getValueLabel,\n  showThumbOnHoverOnly,\n  thumbSize,\n  onPointerMove,\n  ...props\n}: UseSliderProps): UseSliderReturn {\n  const [isPointerOver, setIsPointerOver] = useState(false);\n  const numberFormatter = useNumberFormatter(formatOptions);\n  const {addGlobalListener, removeGlobalListener} = useGlobalListeners();\n  const trackRef = useRef<HTMLDivElement>(null);\n\n  // values will be stored in internal state as an array for both slider and range slider\n  const [values, setValues] = useControlledState<number[]>(\n    props.value ? props.value : undefined,\n    props.defaultValue ?? ([minValue] as any),\n    props.onChange as any\n  );\n  // need to also store values in ref, because state value would\n  // lag behind by one between pointer down and move callbacks\n  const valuesRef = useRef<number[] | null>(null);\n  valuesRef.current = values;\n\n  // indices of thumbs that are being dragged currently (state and ref for same reasons as above)\n  const [draggedThumbs, setDraggedThumbs] = useState<boolean[]>(\n    new Array(values.length).fill(false)\n  );\n  const draggedThumbsRef = useRef<boolean[] | null>(null);\n  draggedThumbsRef.current = draggedThumbs;\n\n  // formatted value for <output> and thumb aria labels\n  function getFormattedValue(value: number) {\n    return numberFormatter.format(value);\n  }\n\n  const isThumbDragging = (index: number) => {\n    return draggedThumbsRef.current?.[index] || false;\n  };\n\n  const getThumbValueLabel = (index: number) =>\n    getFormattedValue(values[index]);\n\n  const getThumbMinValue = (index: number) =>\n    index === 0 ? minValue : values[index - 1];\n  const getThumbMaxValue = (index: number) =>\n    index === values.length - 1 ? maxValue : values[index + 1];\n\n  const setThumbValue = (index: number, value: number) => {\n    if (isDisabled || !isThumbEditable(index) || !valuesRef.current) {\n      return;\n    }\n    const thisMin = getThumbMinValue(index);\n    const thisMax = getThumbMaxValue(index);\n\n    // Round value to multiple of step, clamp value between min and max\n    value = snapValueToStep(value, thisMin, thisMax, step);\n    valuesRef.current = replaceIndex(valuesRef.current, index, value);\n    setValues(valuesRef.current);\n  };\n\n  // update \"dragging\" status of specified thumb\n  const updateDraggedThumbs = (index: number, dragging: boolean) => {\n    if (isDisabled || !isThumbEditable(index)) {\n      return;\n    }\n\n    const wasDragging = draggedThumbsRef.current?.[index];\n    draggedThumbsRef.current = replaceIndex(\n      draggedThumbsRef.current || [],\n      index,\n      dragging\n    );\n    setDraggedThumbs(draggedThumbsRef.current);\n\n    // Call onChangeEnd if no handles are dragging.\n    if (onChangeEnd && wasDragging && !draggedThumbsRef.current.some(Boolean)) {\n      onChangeEnd(valuesRef.current || []);\n    }\n  };\n\n  const [focusedThumb, setFocusedThumb] = useState<number | undefined>(\n    undefined\n  );\n\n  const getValuePercent = (value: number) => {\n    const x = Math.min(1, (value - minValue) / (maxValue - minValue));\n    if (isNaN(x)) {\n      return 0;\n    }\n    return x;\n  };\n\n  const getThumbPercent = (index: number) =>\n    getValuePercent(valuesRef.current![index]);\n\n  const setThumbPercent = (index: number, percent: number) => {\n    setThumbValue(index, getPercentValue(percent));\n  };\n\n  const getRoundedValue = (value: number) =>\n    Math.round((value - minValue) / step) * step + minValue;\n\n  const getPercentValue = (percent: number) => {\n    const val = percent * (maxValue - minValue) + minValue;\n    return clamp(getRoundedValue(val), minValue, maxValue);\n  };\n\n  // allows disabling individual thumbs in range slider, instead of disable the whole slider\n  const editableThumbsRef = useRef<boolean[]>(\n    new Array(values.length).fill(true)\n  );\n  const isThumbEditable = (index: number) => editableThumbsRef.current[index];\n  const setThumbEditable = (index: number, editable: boolean) => {\n    editableThumbsRef.current[index] = editable;\n  };\n\n  // When the user clicks or drags the track, we want the motion to set and drag the\n  // closest thumb. Hence, we also need to install useMove() on the track element.\n  // Here, we keep track of which index is the \"closest\" to the drag start point.\n  // It is set onMouseDown/onTouchDown; see trackProps below.\n  const realTimeTrackDraggingIndex = useRef<number | null>(null);\n\n  const currentPointer = useRef<number | null | undefined>(undefined);\n  const handlePointerDown = (e: React.PointerEvent) => {\n    if (\n      e.pointerType === 'mouse' &&\n      (e.button !== 0 || e.altKey || e.ctrlKey || e.metaKey)\n    ) {\n      return;\n    }\n\n    onPointerDown?.();\n\n    // We only trigger track-dragging if the user clicks on the track itself and nothing is currently being dragged.\n    if (\n      trackRef.current &&\n      !isDisabled &&\n      values.every((_, i) => !draggedThumbs[i])\n    ) {\n      const size = trackRef.current.offsetWidth;\n      // Find the closest thumb\n      const trackPosition = trackRef.current.getBoundingClientRect().left;\n      const offset = e.clientX - trackPosition;\n      const percent = offset / size;\n      const value = getPercentValue(percent);\n\n      // to find the closet thumb we split the array based on the first thumb position to the \"right/end\" of the click.\n      let closestThumb;\n      const split = values.findIndex(v => value - v < 0);\n      if (split === 0) {\n        // If the index is zero then the closest thumb is the first one\n        closestThumb = split;\n      } else if (split === -1) {\n        // If no index is found they've clicked past all the thumbs\n        closestThumb = values.length - 1;\n      } else {\n        const lastLeft = values[split - 1];\n        const firstRight = values[split];\n        // Pick the last left/start thumb, unless they are stacked on top of each other, then pick the right/end one\n        if (Math.abs(lastLeft - value) < Math.abs(firstRight - value)) {\n          closestThumb = split - 1;\n        } else {\n          closestThumb = split;\n        }\n      }\n\n      // Confirm that the found closest thumb is editable, not disabled, and move it\n      if (closestThumb >= 0 && isThumbEditable(closestThumb)) {\n        // Don't un-focus anything\n        e.preventDefault();\n\n        realTimeTrackDraggingIndex.current = closestThumb;\n        setFocusedThumb(closestThumb);\n        currentPointer.current = e.pointerId;\n\n        updateDraggedThumbs(realTimeTrackDraggingIndex.current, true);\n        setThumbValue(closestThumb, value);\n\n        addGlobalListener(window, 'pointerup', onUpTrack, false);\n      } else {\n        realTimeTrackDraggingIndex.current = null;\n      }\n    }\n  };\n\n  const currentPosition = useRef<number | null>(null);\n  const {domProps: moveDomProps} = usePointerEvents({\n    onPointerDown: handlePointerDown,\n    onMoveStart() {\n      currentPosition.current = null;\n    },\n    onMove(e, deltaX) {\n      const size = trackRef.current?.offsetWidth || 0;\n\n      if (currentPosition.current == null) {\n        currentPosition.current =\n          getThumbPercent(realTimeTrackDraggingIndex.current || 0) * size;\n      }\n\n      currentPosition.current += deltaX;\n\n      if (realTimeTrackDraggingIndex.current != null && trackRef.current) {\n        const percent = clamp(currentPosition.current / size, 0, 1);\n        setThumbPercent(realTimeTrackDraggingIndex.current, percent);\n      }\n    },\n    onMoveEnd() {\n      if (realTimeTrackDraggingIndex.current != null) {\n        updateDraggedThumbs(realTimeTrackDraggingIndex.current, false);\n        realTimeTrackDraggingIndex.current = null;\n      }\n    },\n  });\n\n  const domProps = mergeProps(moveDomProps, {\n    onPointerEnter: () => {\n      setIsPointerOver(true);\n    },\n    onPointerLeave: () => {\n      setIsPointerOver(false);\n    },\n    onPointerMove: (e: React.PointerEvent) => {\n      onPointerMove?.(e);\n    },\n  });\n\n  const onUpTrack = (e: PointerEvent) => {\n    const id = e.pointerId;\n    if (id === currentPointer.current) {\n      if (realTimeTrackDraggingIndex.current != null) {\n        updateDraggedThumbs(realTimeTrackDraggingIndex.current, false);\n        realTimeTrackDraggingIndex.current = null;\n      }\n\n      removeGlobalListener(window, 'pointerup', onUpTrack, false);\n    }\n  };\n\n  const id = useId();\n  const labelId = label ? `${id}-label` : undefined;\n  const groupId = `${id}-group`;\n  const thumbIds = [...Array(values.length)].map((v, i) => {\n    return `${id}-thumb-${i}`;\n  });\n\n  return {\n    domProps,\n    trackRef,\n    isDisabled,\n    step,\n    values,\n    minValue,\n    maxValue,\n    focusedThumb,\n    labelId,\n    groupId,\n    thumbIds,\n    numberFormatter,\n    getThumbPercent,\n    getThumbMinValue,\n    getThumbMaxValue,\n    getThumbValueLabel,\n    isThumbDragging,\n    setThumbValue,\n    updateDraggedThumbs,\n    setThumbEditable,\n    setFocusedThumb,\n    getValueLabel,\n    isPointerOver,\n    showThumbOnHoverOnly,\n    thumbSize,\n  };\n}\n\nfunction replaceIndex<T>(array: T[], index: number, value: T) {\n  if (array[index] === value) {\n    return array;\n  }\n\n  return [...array.slice(0, index), value, ...array.slice(index + 1)];\n}\n","import React, {Ref, useCallback, useEffect, useRef} from 'react';\nimport clsx from 'clsx';\nimport {UseSliderReturn} from './use-slider';\nimport {useGlobalListeners, useObjectRef} from '@react-aria/utils';\nimport {createEventHandler} from '@common/utils/dom/create-event-handler';\nimport {BaseSliderProps} from '@common/ui/forms/slider/base-slider';\n\ninterface SliderThumb {\n  index: number;\n  slider: UseSliderReturn;\n  isDisabled?: boolean;\n  ariaLabel?: string;\n  inputRef?: Ref<HTMLInputElement>;\n  onBlur?: React.FocusEventHandler;\n  fillColor?: BaseSliderProps['fillColor'];\n}\n\nexport function SliderThumb({\n  index,\n  slider,\n  isDisabled: isThumbDisabled,\n  ariaLabel,\n  inputRef,\n  onBlur,\n  fillColor = 'primary',\n}: SliderThumb) {\n  const inputObjRef = useObjectRef(inputRef);\n  const {addGlobalListener, removeGlobalListener} = useGlobalListeners();\n\n  const {\n    step,\n    values,\n    focusedThumb,\n    labelId,\n    thumbIds,\n    isDisabled: isSliderDisabled,\n    getThumbPercent,\n    getThumbMinValue,\n    getThumbMaxValue,\n    getThumbValueLabel,\n    setThumbValue,\n    updateDraggedThumbs,\n    isThumbDragging,\n    setThumbEditable,\n    setFocusedThumb,\n    isPointerOver,\n    showThumbOnHoverOnly,\n    thumbSize = 'w-18 h-18',\n  } = slider;\n\n  const isDragging = isThumbDragging(index);\n  const value = values[index];\n\n  // Immediately register editability with the state\n  setThumbEditable(index, !isThumbDisabled);\n  const isDisabled = isThumbDisabled || isSliderDisabled;\n\n  const focusInput = useCallback(() => {\n    if (inputObjRef.current) {\n      inputObjRef.current.focus({preventScroll: true});\n    }\n  }, [inputObjRef]);\n\n  // we will focus the native range input when slider is clicked or thumb is\n  // focused in some other way, and let browser handle keyboard interactions\n  const isFocused = focusedThumb === index;\n  useEffect(() => {\n    if (isFocused) {\n      focusInput();\n    }\n  }, [isFocused, focusInput]);\n\n  const currentPointer = useRef<number | undefined>(undefined);\n  const handlePointerUp = (e: PointerEvent) => {\n    if (e.pointerId === currentPointer.current) {\n      focusInput();\n      updateDraggedThumbs(index, false);\n      removeGlobalListener(window, 'pointerup', handlePointerUp, false);\n    }\n  };\n\n  const className = clsx(\n    'outline-none rounded-full top-1/2 -translate-y-1/2 -translate-x-1/2 absolute inset-0 transition-button duration-200',\n    thumbSize,\n    !isDisabled && 'shadow-md',\n    thumbColor({fillColor, isDisabled, isDragging: isDragging}),\n    // show thumb on hover and while dragging, otherwise \"blur\" event will fire on thumb and dragging will stop\n    (showThumbOnHoverOnly && isDragging) || isPointerOver\n      ? 'visible'\n      : 'invisible'\n  );\n\n  return (\n    <div\n      role=\"presentation\"\n      className={className}\n      style={{\n        left: `${Math.max(getThumbPercent(index) * 100, 0)}%`,\n      }}\n      onPointerDown={e => {\n        if (e.button !== 0 || e.altKey || e.ctrlKey || e.metaKey) {\n          return;\n        }\n        focusInput();\n        currentPointer.current = e.pointerId;\n        updateDraggedThumbs(index, true);\n\n        addGlobalListener(window, 'pointerup', handlePointerUp, false);\n      }}\n    >\n      <input\n        id={thumbIds[index]}\n        onKeyDown={createEventHandler(() => {\n          updateDraggedThumbs(index, true);\n        })}\n        onKeyUp={createEventHandler(() => {\n          // make sure \"onChangeEnd\" is fired on keyboard navigation\n          updateDraggedThumbs(index, false);\n        })}\n        ref={inputObjRef}\n        tabIndex={!isDisabled ? 0 : undefined}\n        min={getThumbMinValue(index)}\n        max={getThumbMaxValue(index)}\n        step={step}\n        value={value}\n        disabled={isDisabled}\n        aria-label={ariaLabel}\n        aria-labelledby={labelId}\n        aria-orientation=\"horizontal\"\n        aria-valuetext={getThumbValueLabel(index)}\n        onFocus={() => {\n          setFocusedThumb(index);\n        }}\n        onBlur={e => {\n          setFocusedThumb(undefined);\n          updateDraggedThumbs(index, false);\n          onBlur?.(e);\n        }}\n        onChange={e => {\n          setThumbValue(index, parseFloat(e.target.value));\n        }}\n        type=\"range\"\n        className=\"sr-only\"\n      />\n    </div>\n  );\n}\n\ninterface SliderThumbColorProps {\n  isDisabled?: boolean;\n  isDragging: boolean;\n  fillColor?: BaseSliderProps['fillColor'];\n}\n\nfunction thumbColor({\n  isDisabled,\n  isDragging,\n  fillColor,\n}: SliderThumbColorProps): string {\n  if (isDisabled) {\n    return 'bg-slider-disabled cursor-default';\n  }\n\n  if (fillColor && fillColor !== 'primary') {\n    return fillColor;\n  }\n\n  return clsx(\n    'hover:bg-primary-dark',\n    isDragging ? 'bg-primary-dark' : 'bg-primary'\n  );\n}\n","import {BaseSlider} from './base-slider';\nimport {useSlider, UseSliderProps} from './use-slider';\nimport React, {Ref} from 'react';\nimport {SliderThumb} from './slider-thumb';\nimport {useController} from 'react-hook-form';\nimport {mergeProps} from '@react-aria/utils';\n\ninterface SliderProps extends UseSliderProps<number> {\n  inputRef?: Ref<HTMLInputElement>;\n  onBlur?: React.FocusEventHandler;\n}\nexport function Slider({inputRef, onBlur, ...props}: SliderProps) {\n  const {onChange, onChangeEnd, value, defaultValue, ...otherProps} = props;\n\n  const baseProps: UseSliderProps = {\n    ...otherProps,\n    // Normalize `value: number[]` to `value: number`\n    value: value != null ? [value] : undefined,\n    defaultValue: defaultValue != null ? [defaultValue] : undefined,\n    onChange: (v: number[]): void => {\n      onChange?.(v[0]);\n    },\n    onChangeEnd: (v: number[]): void => {\n      onChangeEnd?.(v[0]);\n    },\n  };\n\n  const slider = useSlider(baseProps);\n\n  return (\n    <BaseSlider {...baseProps} slider={slider}>\n      <SliderThumb\n        fillColor={props.fillColor}\n        index={0}\n        slider={slider}\n        inputRef={inputRef}\n        onBlur={onBlur}\n      />\n    </BaseSlider>\n  );\n}\n\nexport interface FormSliderProps extends SliderProps {\n  name: string;\n}\n\nexport function FormSlider({name, ...props}: FormSliderProps) {\n  const {\n    field: {onChange, onBlur, value = '', ref},\n  } = useController({\n    name,\n  });\n\n  const formProps: SliderProps = {\n    onChange,\n    onBlur,\n    value: value || '', // avoid issues with \"null\" value when setting form defaults from backend model\n  };\n\n  return <Slider inputRef={ref} {...mergeProps(formProps, props)} />;\n}\n","import {useEffect, useRef} from 'react';\n\nexport function usePrevious(value: any) {\n  const ref = useRef();\n  // Store current value in ref\n  useEffect(() => {\n    ref.current = value;\n  }, [value]); // Only re-run if value changes\n  // Return previous value (happens before update in useEffect above)\n  return ref.current;\n}\n","import {DragMonitor} from './use-drag-monitor';\nimport {ConnectedDraggable, DraggableId} from './use-draggable';\nimport {ConnectedDroppable} from './use-droppable';\n\nexport type DragSessionStatus =\n  | 'dropSuccess'\n  | 'dropFail'\n  | 'dragging'\n  | 'inactive';\n\nexport interface DragSession {\n  dragTargetId?: DraggableId;\n  status: DragSessionStatus;\n}\n\nexport const draggables = new Map<DraggableId, ConnectedDraggable>();\nexport const droppables = new Map<DraggableId, ConnectedDroppable>();\nexport const dragMonitors = new Map<DraggableId, DragMonitor>();\nexport const dragSession: DragSession = {\n  status: 'inactive',\n};\n","import React from 'react';\n\ntype NativeEvent =\n  | React.PointerEvent\n  | PointerEvent\n  | React.DragEvent<HTMLElement>\n  | DragEvent;\n\nexport interface InteractableEvent {\n  x: number;\n  y: number;\n  deltaX: number;\n  deltaY: number;\n  rect: InteractableRect;\n  nativeEvent: NativeEvent;\n}\n\nexport interface InteractableRect {\n  left: number;\n  top: number;\n  width: number;\n  height: number;\n  angle?: number;\n}\n\nexport function interactableEvent({\n  e,\n  rect,\n  deltaX,\n  deltaY,\n}: {\n  e: NativeEvent;\n  rect: InteractableRect;\n  deltaX?: number;\n  deltaY?: number;\n}): InteractableEvent {\n  return {\n    rect,\n    x: e.clientX,\n    y: e.clientY,\n    deltaX: deltaX ?? 0,\n    deltaY: deltaY ?? 0,\n    nativeEvent: e,\n  };\n}\n","type InteractionName = null | 'resize' | 'rotate' | 'drag' | 'move';\n\nexport let activeInteraction: InteractionName = null;\n\nexport function setActiveInteraction(name: InteractionName) {\n  activeInteraction = name;\n}\n","import {InteractableRect} from '../interactable-event';\n\nexport function domRectToObj(rect: DOMRect): InteractableRect {\n  return {\n    left: rect.left,\n    top: rect.top,\n    width: rect.width,\n    height: rect.height,\n  };\n}\n","// use intersection observer instead of getBoundingClientRect for better performance as this will be called in onPointerMove event\nimport {InteractableRect} from '../interactable-event';\nimport {ConnectedMouseSelectable} from './mouse-selection/use-mouse-selectable';\nimport {DraggableId} from './use-draggable';\nimport {ConnectedDroppable} from './use-droppable';\n\nexport function updateRects(\n  targets: Map<DraggableId, ConnectedDroppable | ConnectedMouseSelectable>\n) {\n  const observer = new IntersectionObserver(entries => {\n    entries.forEach(entry => {\n      const {width, height, left, top} = entry.boundingClientRect;\n      const [id, target] =\n        [...targets].find(\n          ([, target]) => target.ref.current === entry.target\n        ) || [];\n      if (id == null || target == null) return;\n\n      const rect: InteractableRect = {\n        width,\n        height,\n        left,\n        top,\n      };\n      targets.set(id, {...target, rect});\n    });\n    observer.disconnect();\n  });\n\n  [...targets.values()].forEach(target => {\n    if (target.ref.current) {\n      observer.observe(target.ref.current);\n    }\n  });\n}\n","import React, {RefObject, useLayoutEffect, useRef} from 'react';\nimport {draggables, dragMonitors, dragSession, droppables} from './drag-state';\nimport {\n  InteractableEvent,\n  interactableEvent,\n  InteractableRect,\n} from '../interactable-event';\nimport {activeInteraction, setActiveInteraction} from '../active-interaction';\nimport {domRectToObj} from '../utils/dom-rect-to-obj';\nimport {updateRects} from './update-rects';\nimport {useGlobalListeners} from '@react-aria/utils';\nimport {DragMonitor} from './use-drag-monitor';\nimport {NativeFileDraggable} from './use-droppable';\n\ninterface DragState {\n  currentRect?: InteractableRect;\n  lastPosition: {x: number; y: number};\n  clickedEl?: HTMLElement;\n}\n\nexport type DragPreviewRenderer = (\n  draggable: ConnectedDraggable,\n  callback: (node: HTMLElement) => void\n) => void;\n\nexport type DraggableId = string | number | object;\n\nexport interface ConnectedDraggable<T = any> {\n  type: string;\n  id: DraggableId;\n  getData: () => T;\n  ref: RefObject<HTMLElement>;\n}\n\n// Either draggable from within the app, or file dragged in from the desktop\nexport type MixedDraggable = ConnectedDraggable | NativeFileDraggable;\n\ninterface UseDragProps extends ConnectedDraggable {\n  disabled?: boolean;\n  onDragStart?: (e: InteractableEvent, target: ConnectedDraggable) => void;\n  onDragMove?: (e: InteractableEvent, target: ConnectedDraggable) => void;\n  onDragEnd?: (e: InteractableEvent, target: ConnectedDraggable) => void;\n  preview?: RefObject<DragPreviewRenderer>;\n  hidePreview?: boolean;\n}\nexport function useDraggable({\n  id,\n  disabled,\n  ref,\n  preview,\n  hidePreview,\n  ...options\n}: UseDragProps) {\n  const dragHandleRef = useRef<HTMLButtonElement>(null);\n  const {addGlobalListener, removeAllGlobalListeners} = useGlobalListeners();\n\n  const state = useRef<DragState>({\n    lastPosition: {x: 0, y: 0},\n  }).current;\n\n  const optionsRef = useRef(options);\n  optionsRef.current = options;\n\n  useLayoutEffect(() => {\n    if (!disabled) {\n      draggables.set(id, {\n        ...draggables.get(id),\n        id,\n        ref,\n        type: optionsRef.current.type,\n        getData: optionsRef.current.getData,\n      });\n    } else {\n      draggables.delete(id);\n    }\n    return () => {\n      draggables.delete(id);\n    };\n  }, [id, disabled, optionsRef, ref]);\n\n  // notify monitors connected to the same drag type as this draggable\n  const notifyMonitors = (callback: (m: DragMonitor) => void) => {\n    dragMonitors.forEach(monitor => {\n      if (monitor.type === draggables.get(id)?.type) {\n        callback(monitor);\n      }\n    });\n  };\n\n  const onDragStart = (e: React.DragEvent<HTMLElement>) => {\n    const draggable = draggables.get(id);\n    const el = ref.current;\n    const clickedOnHandle =\n      !dragHandleRef.current ||\n      !state.clickedEl ||\n      dragHandleRef.current.contains(state.clickedEl);\n\n    // if another interaction is in progress (rotate, resize, drag etc.), bail\n    if (activeInteraction || !el || !draggable || !clickedOnHandle) {\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n\n    updateRects(droppables);\n    setActiveInteraction('drag');\n\n    // hide default browser ghost image\n    if (hidePreview) {\n      hideNativeGhostImage(e);\n    }\n    // this will hide default browser cursor icon, if \"dropEffect\" is not set in dragOver/dragEnter\n    e.dataTransfer.effectAllowed = 'move';\n\n    state.lastPosition = {x: e.clientX, y: e.clientY};\n    state.currentRect = domRectToObj(el.getBoundingClientRect());\n    const ie = interactableEvent({rect: state.currentRect!, e});\n\n    // If there is a preview option, use it to render a custom preview image that will\n    // appear under the pointer while dragging. If not, the element itself is dragged by the browser.\n    if (preview?.current) {\n      preview.current(draggable, node => {\n        e.dataTransfer.setDragImage(node, 0, 0);\n      });\n    }\n\n    dragSession.status = 'dragging';\n    dragSession.dragTargetId = id;\n    if (ref.current) {\n      ref.current.dataset.dragging = 'true';\n    }\n\n    optionsRef.current.onDragStart?.(ie, draggable);\n\n    // wait until next frame so changes made in \"onDragStart\" are reflected in drag monitors\n    requestAnimationFrame(() => {\n      notifyMonitors(m => m.onDragStart?.(ie, draggable));\n    });\n\n    // firefox does not provide clientX/clientY in \"onDrag\", need to listen for dragOver on window instead\n    addGlobalListener(window, 'dragover', onDragOver, true);\n  };\n\n  const onDragOver = (e: React.DragEvent<HTMLElement> | DragEvent) => {\n    e.preventDefault();\n\n    if (!state.currentRect) return;\n\n    const deltaX = e.clientX - state.lastPosition.x;\n    const deltaY = e.clientY - state.lastPosition.y;\n\n    const newRect = {\n      ...state.currentRect,\n      left: state.currentRect.left + deltaX,\n      top: state.currentRect.top + deltaY,\n    };\n\n    const ie = interactableEvent({rect: newRect, e, deltaX, deltaY});\n\n    const target = draggables.get(id);\n    if (target) {\n      optionsRef.current.onDragMove?.(ie, target);\n      notifyMonitors(m => m.onDragMove?.(ie, target));\n    }\n\n    state.lastPosition = {x: e.clientX, y: e.clientY};\n    state.currentRect = newRect;\n  };\n\n  const onDragEnd = (e: React.DragEvent<HTMLElement>) => {\n    removeAllGlobalListeners();\n    if (!state.currentRect) return;\n\n    setActiveInteraction(null);\n    if (emptyImage) {\n      emptyImage.remove();\n    }\n\n    const ie = interactableEvent({rect: state.currentRect, e});\n\n    const draggable = draggables.get(id);\n    if (draggable) {\n      optionsRef.current.onDragEnd?.(ie, draggable);\n      notifyMonitors(m => m.onDragEnd?.(ie, draggable, dragSession!.status));\n    }\n\n    // wait a frame before clearing so monitors have a chance to use drag session status\n    requestAnimationFrame(() => {\n      dragSession.dragTargetId = undefined;\n      dragSession.status = 'inactive';\n      if (ref.current) {\n        delete ref.current.dataset.dragging;\n      }\n    });\n  };\n\n  const draggableProps = {\n    draggable: !disabled,\n    onDragStart,\n    onDragEnd,\n    onPointerDown: (e: React.PointerEvent) => {\n      state.clickedEl = e.target as HTMLElement;\n    },\n  };\n\n  return {draggableProps, dragHandleRef};\n}\n\nlet emptyImage: HTMLImageElement | undefined;\nfunction hideNativeGhostImage(e: React.DragEvent) {\n  if (!emptyImage) {\n    emptyImage = new Image();\n    // image needs to be in the dom to prevent \"globe\" icon in chrome\n    document.body.append(emptyImage);\n    emptyImage.src =\n      'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n\n  e.dataTransfer.setDragImage(emptyImage, 0, 0);\n}\n","import {UploadedFile} from '../../../uploads/uploaded-file';\n\nexport async function* readFilesFromDataTransfer(dataTransfer: DataTransfer) {\n  for (const item of dataTransfer.items) {\n    if (item.kind === 'file') {\n      if (typeof item.webkitGetAsEntry === 'function') {\n        const entry: FileSystemEntry | null = item.webkitGetAsEntry();\n        if (!entry) continue;\n\n        if (entry.isFile) {\n          if (entry.name === '.DS_Store') continue;\n          yield new UploadedFile(item.getAsFile()!, entry.fullPath);\n        } else if (entry.isDirectory) {\n          yield* getEntries(entry as FileSystemDirectoryEntry);\n        }\n      } else {\n        const file = item.getAsFile();\n        if (!file || file.name === '.DS_Store') continue;\n        yield new UploadedFile(file, (item as any).fullPath);\n      }\n    }\n  }\n}\n\nasync function* getEntries(item: FileSystemDirectoryEntry): AsyncIterable<any> {\n  const reader = item.createReader();\n\n  // We must call readEntries repeatedly because there may be a limit to the\n  // number of entries that are returned at once.\n  let entries: FileSystemEntry[];\n  do {\n    entries = await new Promise((resolve, reject) => {\n      reader.readEntries(resolve, reject);\n    });\n\n    for (const entry of entries) {\n      if (entry.isFile) {\n        if (entry.name === '.DS_Store') continue;\n        const file = await getEntryFile(entry as FileSystemFileEntry);\n        yield new UploadedFile(file, entry.fullPath);\n      } else if (entry.isDirectory) {\n        yield* getEntries(entry as FileSystemDirectoryEntry);\n      }\n    }\n  } while (entries.length > 0);\n}\n\nfunction getEntryFile(entry: FileSystemFileEntry): Promise<File> {\n  return new Promise((resolve, reject) => entry.file(resolve, reject));\n}\n","export async function asyncIterableToArray<T>(\n  iterator: AsyncIterable<T>\n): Promise<T[]> {\n  const items: T[] = [];\n  for await (const item of iterator) {\n    items.push(item);\n  }\n  return items;\n}\n","import React, {RefObject, useLayoutEffect, useRef} from 'react';\nimport {draggables, dragSession, droppables} from './drag-state';\nimport {readFilesFromDataTransfer} from './read-files-from-data-transfer';\nimport {asyncIterableToArray} from '@common/utils/array/async-iterable-to-array';\nimport {InteractableRect} from '../interactable-event';\nimport {DraggableId, MixedDraggable} from './use-draggable';\nimport {Simulate} from 'react-dom/test-utils';\nimport {UploadedFile} from '@common/uploads/uploaded-file';\n\nexport interface ConnectedDroppable {\n  id: DraggableId;\n  rect?: InteractableRect;\n  disabled?: boolean;\n  ref: RefObject<HTMLElement>;\n}\n\n// File dragged in from desktop\nexport interface NativeFileDraggable {\n  type: 'nativeFile';\n  el: null;\n  ref: null;\n  getData: () => Promise<UploadedFile[]>;\n}\n\ninterface UseDroppableProps<T extends HTMLElement> {\n  id: DraggableId;\n  disabled?: boolean;\n  types: ('nativeFile' | string)[];\n  ref: RefObject<T>;\n  // this will fire dragEnter/dragLeave/dragOver events when same element is both draggable and drop target and dragging target over itself. Used for showing line previews before/after element during sort.\n  allowDragEventsFromItself?: boolean;\n  onDragEnter?: (target: MixedDraggable) => void;\n  onDragLeave?: (target: MixedDraggable) => void;\n  onDragOver?: (\n    target: MixedDraggable,\n    e: React.DragEvent<HTMLElement>\n  ) => void;\n  // Handler that is called after draggable is held over droppable for a period of time.\n  // This typically opens the item so that the user can drop within it.\n  onDropActivate?: (e: MixedDraggable) => void;\n  onDrop?: (target: MixedDraggable) => void | Promise<void> | false;\n  acceptsDrop?: (target: MixedDraggable) => boolean;\n}\n\ninterface DroppableState {\n  dragOverElements: Set<Element>;\n  dropActivateTimer: ReturnType<typeof setTimeout> | undefined;\n}\n\nconst DROP_ACTIVATE_TIMEOUT = 400;\n\nexport function useDroppable<T extends HTMLElement>({\n  id,\n  disabled,\n  ref,\n  ...options\n}: UseDroppableProps<T>) {\n  const state = useRef<DroppableState>({\n    dragOverElements: new Set<Element>(),\n    dropActivateTimer: undefined,\n  }).current;\n\n  const optionsRef = useRef(options);\n  optionsRef.current = options;\n\n  useLayoutEffect(() => {\n    droppables.set(id, {\n      ...droppables.get(id),\n      disabled,\n      id,\n      ref,\n    });\n    return () => {\n      droppables.delete(id);\n    };\n  }, [id, optionsRef, disabled, ref]);\n\n  // check if drop target accepts drag target\n  const canDrop = (draggable: MixedDraggable): boolean => {\n    const options = optionsRef.current;\n\n    const allowEventsOnSelf =\n      options.allowDragEventsFromItself ||\n      ref.current !== draggable.ref?.current;\n\n    return !!(\n      draggable?.type &&\n      allowEventsOnSelf &&\n      options.types.includes(draggable.type) &&\n      (!options.acceptsDrop || options.acceptsDrop(draggable))\n    );\n  };\n\n  const fireDragLeave = (e: React.DragEvent<HTMLElement>) => {\n    const draggable = getDraggable(e);\n    if (draggable) {\n      optionsRef.current.onDragLeave?.(draggable);\n    }\n  };\n\n  const onDragEnter = (e: React.DragEvent<HTMLElement>) => {\n    e.stopPropagation();\n\n    state.dragOverElements.add(e.target as Element);\n    if (state.dragOverElements.size > 1) {\n      return;\n    }\n\n    const draggable = getDraggable(e);\n    if (draggable && canDrop(draggable)) {\n      optionsRef.current.onDragEnter?.(draggable);\n\n      clearTimeout(state.dropActivateTimer);\n      if (typeof optionsRef.current.onDropActivate === 'function') {\n        state.dropActivateTimer = setTimeout(() => {\n          if (draggable) {\n            optionsRef.current.onDropActivate?.(draggable);\n          }\n        }, DROP_ACTIVATE_TIMEOUT);\n      }\n    }\n  };\n\n  const onDragLeave = (e: React.DragEvent<HTMLElement>) => {\n    e.stopPropagation();\n\n    // Track all the targets of dragenter events in a set, and remove them\n    // in dragleave. When the set becomes empty, we've left the drop target completely.\n    // We must also remove any elements that are no longer in the DOM, because dragleave\n    // events will never be fired for these. This can happen, for example, with drop\n    // indicators between items, which disappear when the drop target changes.\n    state.dragOverElements.delete(e.target as Element);\n    for (const element of state.dragOverElements) {\n      if (!e.currentTarget.contains(element)) {\n        state.dragOverElements.delete(element);\n      }\n    }\n\n    if (state.dragOverElements.size > 0) {\n      return;\n    }\n\n    const draggable = getDraggable(e);\n    if (draggable && canDrop(draggable)) {\n      fireDragLeave(e);\n      clearTimeout(state.dropActivateTimer);\n    }\n  };\n\n  const onDrop = async (e: React.DragEvent<HTMLElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    state.dragOverElements.clear();\n\n    fireDragLeave(e);\n    clearTimeout(state.dropActivateTimer);\n\n    const draggable = getDraggable(e);\n    if (draggable) {\n      optionsRef.current.onDragLeave?.(draggable);\n\n      // drop target does not accept this type of droppable\n      if (!canDrop(draggable)) {\n        if (dragSession.status !== 'inactive') {\n          dragSession.status = 'dropFail';\n        }\n        // drop target accepts this type, but it might still reject the drop in callback\n      } else {\n        // allow callback to mark drop as failed\n        const dropResult = optionsRef.current.onDrop?.(draggable);\n\n        // drag session will only be active for draggables within the app, never for files dragged in from desktop\n        if (dragSession.status !== 'inactive') {\n          dragSession.status =\n            dropResult === false ? 'dropFail' : 'dropSuccess';\n        }\n      }\n    }\n  };\n\n  const droppableProps = {\n    onDragOver: (e: React.DragEvent<HTMLElement>) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const draggable = getDraggable(e);\n      if (draggable && canDrop(draggable)) {\n        optionsRef.current.onDragOver?.(draggable, e);\n      }\n    },\n    onDragEnter,\n    onDragLeave,\n    onDrop,\n  };\n\n  return {\n    droppableProps: disabled ? {} : droppableProps,\n  };\n}\n\nfunction getDraggable(\n  e: React.DragEvent<HTMLElement>\n): MixedDraggable | undefined {\n  if (dragSession.dragTargetId != null) {\n    return draggables.get(dragSession.dragTargetId);\n  } else if (e.dataTransfer.types.includes('Files')) {\n    return {\n      type: 'nativeFile',\n      el: null,\n      ref: null,\n      getData: () => {\n        return asyncIterableToArray(readFilesFromDataTransfer(e.dataTransfer));\n      },\n    };\n  }\n}\n","import {clamp} from '../number/clamp';\n\nexport function moveItemInArray<T = any>(\n  array: T[],\n  fromIndex: number,\n  toIndex: number\n): T[] {\n  const from = clamp(fromIndex, 0, array.length - 1);\n  const to = clamp(toIndex, 0, array.length - 1);\n\n  if (from === to) {\n    return array;\n  }\n\n  const target = array[from];\n  const delta = to < from ? -1 : 1;\n\n  for (let i = from; i !== to; i += delta) {\n    array[i] = array[i + delta];\n  }\n\n  array[to] = target;\n\n  return array;\n}\n","export function moveItemInNewArray<T>(\n  array: T[],\n  from: number,\n  to: number\n): T[] {\n  const newArray = array.slice();\n  newArray.splice(\n    to < 0 ? newArray.length + to : to,\n    0,\n    newArray.splice(from, 1)[0]\n  );\n\n  return newArray;\n}\n","import {DraggableId, DragPreviewRenderer, useDraggable} from './use-draggable';\nimport {useDroppable} from './use-droppable';\nimport {RefObject, useEffect, useRef} from 'react';\nimport {getScrollParent, mergeProps} from '@react-aria/utils';\nimport {moveItemInArray} from '@common/utils/array/move-item-in-array';\nimport {droppables} from './drag-state';\nimport {moveItemInNewArray} from '@common/utils/array/move-item-in-new-array';\nimport {updateRects} from '@common/ui/interactions/dnd/update-rects';\n\nlet sortSession: null | {\n  // items in this list will be moved when user is sorting\n  sortables: DraggableId[];\n\n  // sortable user started dragging to start this session\n  activeSortable: DraggableId;\n  activeIndex: number;\n\n  // final index sortable was dropped in and should be moved to\n  finalIndex: number;\n\n  // drop position for displaying line preview\n  dropPosition: DropPosition;\n  // element that currently has a line preview at the top or bottom\n  linePreviewEl?: HTMLElement;\n  scrollParent?: Element;\n  scrollListener: () => void;\n} = null;\n\nexport type DropPosition = 'before' | 'after' | null;\n\nexport interface UseSortableProps {\n  item: DraggableId;\n  items: DraggableId[];\n  onSortStart?: () => void;\n  onSortEnd?: (oldIndex: number, newIndex: number) => void;\n  onDragEnd?: () => void;\n  onDropPositionChange?: (dropPosition: DropPosition) => void;\n  ref: RefObject<HTMLElement>;\n  type: string;\n  preview?: RefObject<DragPreviewRenderer>;\n  previewVariant?: 'line' | 'liveSort';\n  disabled?: boolean;\n}\nexport function useSortable({\n  item,\n  items,\n  type,\n  ref,\n  onSortEnd,\n  onSortStart,\n  onDragEnd,\n  preview,\n  disabled,\n  onDropPositionChange,\n  previewVariant = 'liveSort',\n}: UseSortableProps) {\n  const dropPosition = useRef<DropPosition>(null);\n\n  // todo: issue with sorting after scrolling menu editor item list\n\n  // update sortables and active index, in case we lazy load more items while sorting\n  useEffect(() => {\n    if (sortSession && sortSession.sortables.length !== items.length) {\n      sortSession.sortables = [...items];\n      sortSession.activeIndex = items.indexOf(item);\n    }\n  }, [items, item]);\n\n  const {draggableProps, dragHandleRef} = useDraggable({\n    id: item,\n    ref,\n    type,\n    preview,\n    disabled,\n    onDragStart: () => {\n      dropPosition.current = null;\n      sortSession = {\n        sortables: [...items],\n        activeSortable: item,\n        activeIndex: items.indexOf(item),\n        finalIndex: items.indexOf(item),\n        dropPosition: null,\n        scrollParent: ref.current ? getScrollParent(ref.current) : undefined,\n        scrollListener: () => {\n          updateRects(droppables);\n        },\n      };\n\n      if (previewVariant === 'liveSort') {\n        addSortStyles();\n      }\n      onSortStart?.();\n      sortSession.scrollParent?.addEventListener(\n        'scroll',\n        sortSession.scrollListener\n      );\n    },\n    onDragEnd: () => {\n      if (!sortSession) return;\n\n      if (previewVariant === 'liveSort') {\n        removeSortStyles();\n      }\n\n      sortSession.dropPosition = null;\n      onDropPositionChange?.(sortSession.dropPosition);\n      if (sortSession.activeIndex !== sortSession.finalIndex) {\n        onSortEnd?.(sortSession.activeIndex, sortSession.finalIndex);\n      }\n      sortSession.scrollParent?.removeEventListener(\n        'scroll',\n        sortSession.scrollListener\n      );\n      clearLinePreview();\n      // call \"onDragEnd\" after \"onSortEnd\", so listener has a chance to use sort session data\n      onDragEnd?.();\n      sortSession = null;\n    },\n    getData: () => {},\n  });\n\n  const {droppableProps} = useDroppable({\n    id: item,\n    ref,\n    types: [type],\n    disabled,\n    allowDragEventsFromItself: true,\n    onDragOver: (target, e) => {\n      if (!sortSession || previewVariant !== 'line') {\n        return;\n      }\n\n      const previousPosition = sortSession.dropPosition;\n      let newPosition: DropPosition = null;\n\n      const rect = droppables.get(item)?.rect;\n      if (rect) {\n        const midY = rect.top + rect.height / 2;\n        if (e.clientY <= midY) {\n          newPosition = 'before';\n        } else if (e.clientY >= midY) {\n          newPosition = 'after';\n        }\n      }\n\n      if (newPosition !== previousPosition) {\n        const overIndex = sortSession.sortables.indexOf(item);\n        sortSession.dropPosition = newPosition;\n        onDropPositionChange?.(sortSession.dropPosition);\n\n        clearLinePreview();\n        if (ref.current) {\n          if (sortSession.dropPosition === 'after') {\n            addLinePreview(ref.current, 'bottom');\n          } else {\n            // if it's the first row, add preview to the top border, as there's no previous element\n            if (overIndex === 0) {\n              addLinePreview(ref.current, 'top');\n              // otherwise add preview to the bottom border of the previous row\n            } else {\n              const droppableId = sortSession.sortables[overIndex - 1];\n              const droppable = droppables.get(droppableId);\n              if (droppable?.ref.current) {\n                addLinePreview(droppable.ref.current, 'bottom');\n              }\n            }\n          }\n        }\n\n        const itemIndex = items.indexOf(item);\n\n        // don't move item at all if hovering over itself\n        if (sortSession.activeIndex === itemIndex) {\n          sortSession.finalIndex = sortSession.activeIndex;\n          return;\n        }\n\n        // adjust final drop index based on whether we're dropping drag target after or before it's original index\n        // this is needed, so we get the same index if target is dropped after current item or before next item\n        const dragDirection =\n          overIndex > sortSession.activeIndex ? 'after' : 'before';\n        if (dragDirection === 'after') {\n          sortSession.finalIndex =\n            sortSession.dropPosition === 'before' ? itemIndex - 1 : itemIndex;\n        } else {\n          sortSession.finalIndex =\n            sortSession.dropPosition === 'after' ? itemIndex + 1 : itemIndex;\n        }\n      }\n    },\n    onDragEnter: () => {\n      if (!sortSession || previewVariant === 'line') return;\n\n      const overIndex = sortSession.sortables.indexOf(item);\n      const oldIndex = sortSession.sortables.indexOf(\n        sortSession.activeSortable\n      );\n\n      moveItemInArray(sortSession.sortables, oldIndex, overIndex);\n      const rects = sortSession.sortables.map(s => droppables.get(s)?.rect);\n\n      sortSession.sortables.forEach((sortable, index) => {\n        if (!sortSession) return;\n\n        const newRects = moveItemInNewArray(\n          rects,\n          overIndex,\n          sortSession.activeIndex\n        );\n        const oldRect = rects[index];\n        const newRect = newRects[index];\n        const sortableTarget = droppables.get(sortable);\n\n        if (sortableTarget?.ref.current && newRect && oldRect) {\n          const x = newRect.left - oldRect.left;\n          const y = newRect.top - oldRect.top;\n          sortableTarget.ref.current.style.transform = `translate3d(${x}px, ${y}px, 0)`;\n        }\n      });\n\n      sortSession.finalIndex = overIndex;\n    },\n    onDragLeave: () => {\n      if (!sortSession || previewVariant !== 'line') {\n        return;\n      }\n      sortSession.dropPosition = null;\n      onDropPositionChange?.(sortSession.dropPosition);\n    },\n  });\n\n  return {\n    sortableProps: {...mergeProps(draggableProps, droppableProps)},\n    dragHandleRef,\n  };\n}\n\nconst transition = 'transform 0.2s cubic-bezier(0.2, 0, 0, 1)';\n\nfunction addSortStyles() {\n  if (!sortSession) return;\n  sortSession.sortables.forEach((sortable, index) => {\n    const droppable = droppables.get(sortable);\n    if (!droppable?.ref.current) return;\n\n    droppable.ref.current.style.transition = transition;\n\n    if (sortSession?.activeIndex === index) {\n      droppable.ref.current.style.opacity = '0.4';\n    }\n  });\n}\n\n// clear any styles and transforms applied to sortables during sorting\nfunction removeSortStyles() {\n  if (!sortSession) return;\n  sortSession.sortables.forEach(sortable => {\n    const droppable = droppables.get(sortable);\n    if (droppable?.ref.current) {\n      droppable.ref.current.style.transform = '';\n      droppable.ref.current.style.transition = '';\n      droppable.ref.current.style.opacity = '';\n      droppable.ref.current.style.zIndex = '';\n    }\n  });\n}\n\nfunction clearLinePreview() {\n  if (sortSession?.linePreviewEl) {\n    sortSession.linePreviewEl.style.borderBottomColor = '';\n    sortSession.linePreviewEl.style.borderTopColor = '';\n    sortSession.linePreviewEl = undefined;\n  }\n}\n\nfunction addLinePreview(el: HTMLElement, side: 'top' | 'bottom') {\n  const color = 'rgb(var(--be-primary))';\n  if (side === 'top') {\n    el.style.borderTopColor = color;\n  } else {\n    el.style.borderBottomColor = color;\n  }\n  if (sortSession) {\n    sortSession.linePreviewEl = el;\n  }\n}\n","'use strict'\n\nfunction _process (v, mod) {\n  var i\n  var r\n\n  if (typeof mod === 'function') {\n    r = mod(v)\n    if (r !== undefined) {\n      v = r\n    }\n  } else if (Array.isArray(mod)) {\n    for (i = 0; i < mod.length; i++) {\n      r = mod[i](v)\n      if (r !== undefined) {\n        v = r\n      }\n    }\n  }\n\n  return v\n}\n\nfunction parseKey (key, val) {\n  // detect negative index notation\n  if (key[0] === '-' && Array.isArray(val) && /^-\\d+$/.test(key)) {\n    return val.length + parseInt(key, 10)\n  }\n  return key\n}\n\nfunction isIndex (k) {\n  return /^\\d+$/.test(k)\n}\n\nfunction isObject (val) {\n  return Object.prototype.toString.call(val) === '[object Object]'\n}\n\nfunction isArrayOrObject (val) {\n  return Object(val) === val\n}\n\nfunction isEmptyObject (val) {\n  return Object.keys(val).length === 0\n}\n\nvar blacklist = ['__proto__', 'prototype', 'constructor']\nvar blacklistFilter = function (part) { return blacklist.indexOf(part) === -1 }\n\nfunction parsePath (path, sep) {\n  if (path.indexOf('[') >= 0) {\n    path = path.replace(/\\[/g, sep).replace(/]/g, '')\n  }\n\n  var parts = path.split(sep)\n\n  var check = parts.filter(blacklistFilter)\n\n  if (check.length !== parts.length) {\n    throw Error('Refusing to update blacklisted property ' + path)\n  }\n\n  return parts\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty\n\nfunction DotObject (separator, override, useArray, useBrackets) {\n  if (!(this instanceof DotObject)) {\n    return new DotObject(separator, override, useArray, useBrackets)\n  }\n\n  if (typeof override === 'undefined') override = false\n  if (typeof useArray === 'undefined') useArray = true\n  if (typeof useBrackets === 'undefined') useBrackets = true\n  this.separator = separator || '.'\n  this.override = override\n  this.useArray = useArray\n  this.useBrackets = useBrackets\n  this.keepArray = false\n\n  // contains touched arrays\n  this.cleanup = []\n}\n\nvar dotDefault = new DotObject('.', false, true, true)\nfunction wrap (method) {\n  return function () {\n    return dotDefault[method].apply(dotDefault, arguments)\n  }\n}\n\nDotObject.prototype._fill = function (a, obj, v, mod) {\n  var k = a.shift()\n\n  if (a.length > 0) {\n    obj[k] = obj[k] || (this.useArray && isIndex(a[0]) ? [] : {})\n\n    if (!isArrayOrObject(obj[k])) {\n      if (this.override) {\n        obj[k] = {}\n      } else {\n        if (!(isArrayOrObject(v) && isEmptyObject(v))) {\n          throw new Error(\n            'Trying to redefine `' + k + '` which is a ' + typeof obj[k]\n          )\n        }\n\n        return\n      }\n    }\n\n    this._fill(a, obj[k], v, mod)\n  } else {\n    if (!this.override && isArrayOrObject(obj[k]) && !isEmptyObject(obj[k])) {\n      if (!(isArrayOrObject(v) && isEmptyObject(v))) {\n        throw new Error(\"Trying to redefine non-empty obj['\" + k + \"']\")\n      }\n\n      return\n    }\n\n    obj[k] = _process(v, mod)\n  }\n}\n\n/**\n *\n * Converts an object with dotted-key/value pairs to it's expanded version\n *\n * Optionally transformed by a set of modifiers.\n *\n * Usage:\n *\n *   var row = {\n *     'nr': 200,\n *     'doc.name': '  My Document  '\n *   }\n *\n *   var mods = {\n *     'doc.name': [_s.trim, _s.underscored]\n *   }\n *\n *   dot.object(row, mods)\n *\n * @param {Object} obj\n * @param {Object} mods\n */\nDotObject.prototype.object = function (obj, mods) {\n  var self = this\n\n  Object.keys(obj).forEach(function (k) {\n    var mod = mods === undefined ? null : mods[k]\n    // normalize array notation.\n    var ok = parsePath(k, self.separator).join(self.separator)\n\n    if (ok.indexOf(self.separator) !== -1) {\n      self._fill(ok.split(self.separator), obj, obj[k], mod)\n      delete obj[k]\n    } else {\n      obj[k] = _process(obj[k], mod)\n    }\n  })\n\n  return obj\n}\n\n/**\n * @param {String} path dotted path\n * @param {String} v value to be set\n * @param {Object} obj object to be modified\n * @param {Function|Array} mod optional modifier\n */\nDotObject.prototype.str = function (path, v, obj, mod) {\n  var ok = parsePath(path, this.separator).join(this.separator)\n\n  if (path.indexOf(this.separator) !== -1) {\n    this._fill(ok.split(this.separator), obj, v, mod)\n  } else {\n    obj[path] = _process(v, mod)\n  }\n\n  return obj\n}\n\n/**\n *\n * Pick a value from an object using dot notation.\n *\n * Optionally remove the value\n *\n * @param {String} path\n * @param {Object} obj\n * @param {Boolean} remove\n */\nDotObject.prototype.pick = function (path, obj, remove, reindexArray) {\n  var i\n  var keys\n  var val\n  var key\n  var cp\n\n  keys = parsePath(path, this.separator)\n  for (i = 0; i < keys.length; i++) {\n    key = parseKey(keys[i], obj)\n    if (obj && typeof obj === 'object' && key in obj) {\n      if (i === keys.length - 1) {\n        if (remove) {\n          val = obj[key]\n          if (reindexArray && Array.isArray(obj)) {\n            obj.splice(key, 1)\n          } else {\n            delete obj[key]\n          }\n          if (Array.isArray(obj)) {\n            cp = keys.slice(0, -1).join('.')\n            if (this.cleanup.indexOf(cp) === -1) {\n              this.cleanup.push(cp)\n            }\n          }\n          return val\n        } else {\n          return obj[key]\n        }\n      } else {\n        obj = obj[key]\n      }\n    } else {\n      return undefined\n    }\n  }\n  if (remove && Array.isArray(obj)) {\n    obj = obj.filter(function (n) {\n      return n !== undefined\n    })\n  }\n  return obj\n}\n/**\n *\n * Delete value from an object using dot notation.\n *\n * @param {String} path\n * @param {Object} obj\n * @return {any} The removed value\n */\nDotObject.prototype.delete = function (path, obj) {\n  return this.remove(path, obj, true)\n}\n\n/**\n *\n * Remove value from an object using dot notation.\n *\n * Will remove multiple items if path is an array.\n * In this case array indexes will be retained until all\n * removals have been processed.\n *\n * Use dot.delete() to automatically  re-index arrays.\n *\n * @param {String|Array<String>} path\n * @param {Object} obj\n * @param {Boolean} reindexArray\n * @return {any} The removed value\n */\nDotObject.prototype.remove = function (path, obj, reindexArray) {\n  var i\n\n  this.cleanup = []\n  if (Array.isArray(path)) {\n    for (i = 0; i < path.length; i++) {\n      this.pick(path[i], obj, true, reindexArray)\n    }\n    if (!reindexArray) {\n      this._cleanup(obj)\n    }\n    return obj\n  } else {\n    return this.pick(path, obj, true, reindexArray)\n  }\n}\n\nDotObject.prototype._cleanup = function (obj) {\n  var ret\n  var i\n  var keys\n  var root\n  if (this.cleanup.length) {\n    for (i = 0; i < this.cleanup.length; i++) {\n      keys = this.cleanup[i].split('.')\n      root = keys.splice(0, -1).join('.')\n      ret = root ? this.pick(root, obj) : obj\n      ret = ret[keys[0]].filter(function (v) {\n        return v !== undefined\n      })\n      this.set(this.cleanup[i], ret, obj)\n    }\n    this.cleanup = []\n  }\n}\n\n/**\n * Alias method  for `dot.remove`\n *\n * Note: this is not an alias for dot.delete()\n *\n * @param {String|Array<String>} path\n * @param {Object} obj\n * @param {Boolean} reindexArray\n * @return {any} The removed value\n */\nDotObject.prototype.del = DotObject.prototype.remove\n\n/**\n *\n * Move a property from one place to the other.\n *\n * If the source path does not exist (undefined)\n * the target property will not be set.\n *\n * @param {String} source\n * @param {String} target\n * @param {Object} obj\n * @param {Function|Array} mods\n * @param {Boolean} merge\n */\nDotObject.prototype.move = function (source, target, obj, mods, merge) {\n  if (typeof mods === 'function' || Array.isArray(mods)) {\n    this.set(target, _process(this.pick(source, obj, true), mods), obj, merge)\n  } else {\n    merge = mods\n    this.set(target, this.pick(source, obj, true), obj, merge)\n  }\n\n  return obj\n}\n\n/**\n *\n * Transfer a property from one object to another object.\n *\n * If the source path does not exist (undefined)\n * the property on the other object will not be set.\n *\n * @param {String} source\n * @param {String} target\n * @param {Object} obj1\n * @param {Object} obj2\n * @param {Function|Array} mods\n * @param {Boolean} merge\n */\nDotObject.prototype.transfer = function (\n  source,\n  target,\n  obj1,\n  obj2,\n  mods,\n  merge\n) {\n  if (typeof mods === 'function' || Array.isArray(mods)) {\n    this.set(\n      target,\n      _process(this.pick(source, obj1, true), mods),\n      obj2,\n      merge\n    )\n  } else {\n    merge = mods\n    this.set(target, this.pick(source, obj1, true), obj2, merge)\n  }\n\n  return obj2\n}\n\n/**\n *\n * Copy a property from one object to another object.\n *\n * If the source path does not exist (undefined)\n * the property on the other object will not be set.\n *\n * @param {String} source\n * @param {String} target\n * @param {Object} obj1\n * @param {Object} obj2\n * @param {Function|Array} mods\n * @param {Boolean} merge\n */\nDotObject.prototype.copy = function (source, target, obj1, obj2, mods, merge) {\n  if (typeof mods === 'function' || Array.isArray(mods)) {\n    this.set(\n      target,\n      _process(\n        // clone what is picked\n        JSON.parse(JSON.stringify(this.pick(source, obj1, false))),\n        mods\n      ),\n      obj2,\n      merge\n    )\n  } else {\n    merge = mods\n    this.set(target, this.pick(source, obj1, false), obj2, merge)\n  }\n\n  return obj2\n}\n\n/**\n *\n * Set a property on an object using dot notation.\n *\n * @param {String} path\n * @param {any} val\n * @param {Object} obj\n * @param {Boolean} merge\n */\nDotObject.prototype.set = function (path, val, obj, merge) {\n  var i\n  var k\n  var keys\n  var key\n\n  // Do not operate if the value is undefined.\n  if (typeof val === 'undefined') {\n    return obj\n  }\n  keys = parsePath(path, this.separator)\n\n  for (i = 0; i < keys.length; i++) {\n    key = keys[i]\n    if (i === keys.length - 1) {\n      if (merge && isObject(val) && isObject(obj[key])) {\n        for (k in val) {\n          if (hasOwnProperty.call(val, k)) {\n            obj[key][k] = val[k]\n          }\n        }\n      } else if (merge && Array.isArray(obj[key]) && Array.isArray(val)) {\n        for (var j = 0; j < val.length; j++) {\n          obj[keys[i]].push(val[j])\n        }\n      } else {\n        obj[key] = val\n      }\n    } else if (\n      // force the value to be an object\n      !hasOwnProperty.call(obj, key) ||\n      (!isObject(obj[key]) && !Array.isArray(obj[key]))\n    ) {\n      // initialize as array if next key is numeric\n      if (/^\\d+$/.test(keys[i + 1])) {\n        obj[key] = []\n      } else {\n        obj[key] = {}\n      }\n    }\n    obj = obj[key]\n  }\n  return obj\n}\n\n/**\n *\n * Transform an object\n *\n * Usage:\n *\n *   var obj = {\n *     \"id\": 1,\n *    \"some\": {\n *      \"thing\": \"else\"\n *    }\n *   }\n *\n *   var transform = {\n *     \"id\": \"nr\",\n *    \"some.thing\": \"name\"\n *   }\n *\n *   var tgt = dot.transform(transform, obj)\n *\n * @param {Object} recipe Transform recipe\n * @param {Object} obj Object to be transformed\n * @param {Array} mods modifiers for the target\n */\nDotObject.prototype.transform = function (recipe, obj, tgt) {\n  obj = obj || {}\n  tgt = tgt || {}\n  Object.keys(recipe).forEach(\n    function (key) {\n      this.set(recipe[key], this.pick(key, obj), tgt)\n    }.bind(this)\n  )\n  return tgt\n}\n\n/**\n *\n * Convert object to dotted-key/value pair\n *\n * Usage:\n *\n *   var tgt = dot.dot(obj)\n *\n *   or\n *\n *   var tgt = {}\n *   dot.dot(obj, tgt)\n *\n * @param {Object} obj source object\n * @param {Object} tgt target object\n * @param {Array} path path array (internal)\n */\nDotObject.prototype.dot = function (obj, tgt, path) {\n  tgt = tgt || {}\n  path = path || []\n  var isArray = Array.isArray(obj)\n\n  Object.keys(obj).forEach(\n    function (key) {\n      var index = isArray && this.useBrackets ? '[' + key + ']' : key\n      if (\n        isArrayOrObject(obj[key]) &&\n        ((isObject(obj[key]) && !isEmptyObject(obj[key])) ||\n          (Array.isArray(obj[key]) && !this.keepArray && obj[key].length !== 0))\n      ) {\n        if (isArray && this.useBrackets) {\n          var previousKey = path[path.length - 1] || ''\n          return this.dot(\n            obj[key],\n            tgt,\n            path.slice(0, -1).concat(previousKey + index)\n          )\n        } else {\n          return this.dot(obj[key], tgt, path.concat(index))\n        }\n      } else {\n        if (isArray && this.useBrackets) {\n          tgt[path.join(this.separator).concat('[' + key + ']')] = obj[key]\n        } else {\n          tgt[path.concat(index).join(this.separator)] = obj[key]\n        }\n      }\n    }.bind(this)\n  )\n  return tgt\n}\n\nDotObject.pick = wrap('pick')\nDotObject.move = wrap('move')\nDotObject.transfer = wrap('transfer')\nDotObject.transform = wrap('transform')\nDotObject.copy = wrap('copy')\nDotObject.object = wrap('object')\nDotObject.str = wrap('str')\nDotObject.set = wrap('set')\nDotObject.delete = wrap('delete')\nDotObject.del = DotObject.remove = wrap('remove')\nDotObject.dot = wrap('dot');\n['override', 'overwrite'].forEach(function (prop) {\n  Object.defineProperty(DotObject, prop, {\n    get: function () {\n      return dotDefault.override\n    },\n    set: function (val) {\n      dotDefault.override = !!val\n    }\n  })\n});\n['useArray', 'keepArray', 'useBrackets'].forEach(function (prop) {\n  Object.defineProperty(DotObject, prop, {\n    get: function () {\n      return dotDefault[prop]\n    },\n    set: function (val) {\n      dotDefault[prop] = val\n    }\n  })\n})\n\nDotObject._process = _process\n\nmodule.exports = DotObject\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const TuneIcon = createSvgIcon(\n  <path d=\"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z\" />\n, 'TuneOutlined');\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const MoreVertIcon = createSvgIcon(\n  <path d=\"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\" />\n, 'MoreVertOutlined');\n","import React, {RefObject} from 'react';\n\nexport interface TabsContext {\n  selectedTab: number;\n  setSelectedTab: (newTab: number) => void;\n  tabsRef: RefObject<HTMLElement[]>;\n  size: 'sm' | 'md';\n  isLazy?: boolean;\n  id: string;\n}\n\nexport const TabContext = React.createContext<TabsContext>(null!);\n","import React, {ReactElement, useId, useMemo, useRef} from 'react';\nimport clsx from 'clsx';\nimport {useControlledState} from '@react-stately/utils';\nimport {TabContext, TabsContext} from './tabs-context';\nimport {TabListProps} from './tab-list';\nimport {TabPanelsProps} from './tab-panels';\n\nexport interface TabsProps {\n  children: [ReactElement<TabListProps>, ReactElement<TabPanelsProps>];\n  size?: 'sm' | 'md';\n  className?: string;\n  selectedTab?: number;\n  defaultSelectedTab?: number;\n  onTabChange?: (newTab: number) => void;\n  isLazy?: boolean;\n  overflow?: string;\n}\n\nexport function Tabs(props: TabsProps) {\n  const {\n    size = 'md',\n    children,\n    className,\n    isLazy,\n    overflow = 'overflow-hidden',\n  } = props;\n\n  const tabsRef = useRef<HTMLButtonElement[]>([]);\n  const id = useId();\n\n  const [selectedTab, setSelectedTab] = useControlledState(\n    props.selectedTab,\n    props.defaultSelectedTab || 0,\n    props.onTabChange\n  );\n\n  const ContextValue: TabsContext = useMemo(() => {\n    return {\n      selectedTab,\n      setSelectedTab,\n      tabsRef,\n      size,\n      isLazy,\n      id,\n    };\n  }, [selectedTab, id, isLazy, setSelectedTab, size]);\n\n  return (\n    <TabContext.Provider value={ContextValue}>\n      <div className={clsx(className, overflow, 'max-w-full')}>{children}</div>\n    </TabContext.Provider>\n  );\n}\n","import React, {useContext, useState} from 'react';\nimport {useLayoutEffect} from '@react-aria/utils';\nimport clsx from 'clsx';\nimport {TabContext} from './tabs-context';\n\ninterface TabLineStyle {\n  width?: string;\n  transform?: string;\n  className?: string;\n}\n\nexport function TabLine() {\n  const {tabsRef, selectedTab} = useContext(TabContext);\n  const [style, setStyle] = useState<TabLineStyle>({\n    width: undefined,\n    transform: undefined,\n    className: undefined,\n  });\n\n  useLayoutEffect(() => {\n    if (selectedTab != null && tabsRef.current) {\n      const el = tabsRef.current[selectedTab];\n      if (!el) return;\n\n      setStyle(prevState => {\n        return {\n          width: `${el.offsetWidth}px`,\n          transform: `translateX(${el.offsetLeft}px)`,\n          // disable initial transition for tabline\n          className: prevState.width === undefined ? '' : 'transition-all',\n        };\n      });\n    }\n  }, [setStyle, selectedTab, tabsRef]);\n\n  return (\n    <div\n      className={clsx(\n        'absolute bottom-0 left-0 h-2 bg-primary',\n        style.className\n      )}\n      role=\"presentation\"\n      style={{width: style.width, transform: style.transform}}\n    />\n  );\n}\n","import React, {Children, cloneElement, isValidElement, ReactNode} from 'react';\nimport clsx from 'clsx';\nimport {FocusScope} from '@react-aria/focus';\nimport {TabProps} from './tab';\nimport {TabLine} from './tab-line';\n\nexport interface TabListProps {\n  children: ReactNode;\n  // center tabs within tablist\n  center?: boolean;\n  // expand tabs to fill in tablist space fully. By default, tabs are only as wide as their content.\n  expand?: boolean;\n  className?: string;\n}\nexport function TabList({children, center, expand, className}: TabListProps) {\n  const childrenArray = Children.toArray(children);\n\n  return (\n    <FocusScope>\n      <div\n        className={clsx(\n          // hide scrollbar completely on mobile, show compact one on desktop\n          'flex relative max-w-full overflow-auto border-b max-sm:hidden-scrollbar md:compact-scrollbar',\n          className\n        )}\n        role=\"tablist\"\n        aria-orientation=\"horizontal\"\n      >\n        {childrenArray.map((child, index) => {\n          if (isValidElement<TabProps>(child)) {\n            return cloneElement<TabProps>(child, {\n              index,\n              className: clsx(\n                child.props.className,\n                expand && 'flex-auto',\n                center && index === 0 && 'ml-auto',\n                center && index === childrenArray.length - 1 && 'mr-auto'\n              ),\n            });\n          }\n          return null;\n        })}\n        <TabLine />\n      </div>\n    </FocusScope>\n  );\n}\n","import React, {JSXElementConstructor, ReactNode, useContext} from 'react';\nimport clsx from 'clsx';\nimport {useFocusManager} from '@react-aria/focus';\nimport {TabContext} from './tabs-context';\nimport {LinkProps} from 'react-router-dom';\n\nexport interface TabProps {\n  className?: string;\n  index?: number;\n  children: ReactNode;\n  isDisabled?: boolean;\n  padding?: string;\n  elementType?: 'button' | 'a' | JSXElementConstructor<any>;\n  to?: LinkProps['to'];\n  relative?: LinkProps['relative'];\n  replace?: LinkProps['replace'];\n  width?: string;\n}\nexport function Tab({\n  index,\n  className,\n  isDisabled,\n  children,\n  padding: paddingProp,\n  elementType = 'button',\n  to,\n  relative,\n  width = 'min-w-min',\n}: TabProps) {\n  const {\n    selectedTab,\n    setSelectedTab,\n    tabsRef,\n    size = 'md',\n    id,\n  } = useContext(TabContext);\n  const isSelected = index === selectedTab;\n  const focusManager = useFocusManager();\n  const padding = paddingProp || (size === 'sm' ? 'px-12' : 'px-18');\n\n  const mergedClassname = clsx(\n    'tracking-wide overflow-hidden capitalize text-sm flex items-center justify-center outline-none transition-colors',\n    'focus-visible:ring focus-visible:ring-2 ring-inset rounded whitespace-nowrap cursor-pointer',\n    width,\n    textColor({isDisabled, isSelected}),\n    className,\n    size === 'md' && `${padding} h-48`,\n    size === 'sm' && `${padding} h-32`,\n    isDisabled && 'pointer-events-none'\n  );\n\n  const onKeyDown = (e: React.KeyboardEvent<HTMLButtonElement>) => {\n    switch (e.key) {\n      case 'ArrowLeft':\n        focusManager.focusPrevious();\n        break;\n      case 'ArrowRight':\n        focusManager.focusNext();\n        break;\n      case 'Home':\n        focusManager.focusFirst();\n        break;\n      case 'End':\n        focusManager.focusLast();\n        break;\n    }\n  };\n\n  const tabIndex = isSelected ? 0 : -1;\n  const Element = elementType;\n\n  return (\n    <Element\n      disabled={isDisabled}\n      id={`${id}-${index}-tab`}\n      aria-controls={`${id}-${index}-tabpanel`}\n      type=\"button\"\n      role=\"tab\"\n      aria-selected={isSelected}\n      tabIndex={isDisabled ? undefined : tabIndex}\n      onKeyDown={onKeyDown}\n      onClick={() => {\n        setSelectedTab(index!);\n      }}\n      to={to}\n      relative={relative}\n      className={mergedClassname}\n      ref={(el: HTMLElement) => {\n        if (tabsRef.current && el) {\n          tabsRef.current[index!] = el;\n        }\n      }}\n    >\n      {children}\n    </Element>\n  );\n}\n\ninterface TextColorProps {\n  isDisabled?: boolean;\n  isSelected: boolean;\n}\nfunction textColor({isDisabled, isSelected}: TextColorProps): string {\n  if (isDisabled) {\n    return 'text-disabled cursor-default';\n  }\n  if (isSelected) {\n    return 'text-primary';\n  }\n  return 'text-muted hover:text-main';\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const DragHandleIcon = createSvgIcon(\n  <path d=\"M20 9H4v2h16V9zM4 15h16v-2H4v2z\" />\n, 'DragHandleOutlined');\n","import {createPortal, flushSync} from 'react-dom';\nimport React, {useImperativeHandle, useRef, useState} from 'react';\nimport {ConnectedDraggable, DragPreviewRenderer} from './use-draggable';\nimport {rootEl} from '@common/core/root-el';\n\nexport interface DragPreviewProps {\n  children: (draggable: ConnectedDraggable) => JSX.Element;\n}\nexport const DragPreview = React.forwardRef<\n  DragPreviewRenderer,\n  DragPreviewProps\n>((props, ref) => {\n  const render = props.children;\n  const [children, setChildren] = useState<JSX.Element | null>(null);\n  const domRef = useRef<HTMLDivElement>(null!);\n\n  useImperativeHandle(\n    ref,\n    () =>\n      (\n        draggable: ConnectedDraggable,\n        callback: (node: HTMLElement) => void\n      ) => {\n        // This will be called during the onDragStart event by useDrag. We need to render the\n        // preview synchronously before this event returns so we can call event.dataTransfer.setDragImage.\n        flushSync(() => {\n          setChildren(render(draggable));\n        });\n\n        // Yield back to useDrag to set the drag image.\n        callback(domRef.current);\n\n        // Remove the preview from the DOM after a frame so the browser has time to paint.\n        requestAnimationFrame(() => {\n          setChildren(null);\n        });\n      },\n    [render]\n  );\n\n  if (!children) {\n    return null;\n  }\n\n  // portal preview, in case in needs to be used in <tr> or another element that does not accept div as child\n  return createPortal(\n    <div\n      style={{zIndex: -100, position: 'absolute', top: 0, left: -100000}}\n      ref={domRef}\n    >\n      {children}\n    </div>,\n    rootEl\n  );\n});\n","import {useCallback, useRef, useState} from 'react';\n\nexport function useStickySentinel() {\n  const [isSticky, setIsSticky] = useState(false);\n\n  const observerRef = useRef<IntersectionObserver>();\n\n  const sentinelRef = useCallback((sentinel: HTMLDivElement | null) => {\n    if (sentinel) {\n      const observer = new IntersectionObserver(\n        ([e]) => setIsSticky(e.intersectionRatio < 1),\n        {threshold: [1]}\n      );\n      observerRef.current = observer;\n      observer.observe(sentinel);\n    } else if (observerRef.current) {\n      observerRef.current?.disconnect();\n    }\n  }, []);\n\n  return {isSticky, sentinelRef};\n}\n","import {FieldValues, SubmitHandler, UseFormReturn} from 'react-hook-form';\nimport clsx from 'clsx';\nimport React, {ReactNode} from 'react';\nimport {useStickySentinel} from '../utils/hooks/sticky-sentinel';\nimport {Form} from '../ui/forms/form';\nimport {Button} from '../ui/buttons/button';\nimport {Trans} from '../i18n/trans';\n\ninterface Props<T extends FieldValues> {\n  onSubmit: SubmitHandler<T>;\n  form: UseFormReturn<T>;\n  title: ReactNode;\n  isLoading: boolean;\n  children: ReactNode;\n  actions?: ReactNode;\n  backButton?: ReactNode;\n  disableSaveWhenNotDirty?: boolean;\n  wrapInContainer?: boolean;\n}\nexport function CrupdateResourceLayout<T extends FieldValues>({\n  onSubmit,\n  form,\n  title,\n  children,\n  actions,\n  backButton,\n  isLoading = false,\n  disableSaveWhenNotDirty = false,\n  wrapInContainer = true,\n}: Props<T>) {\n  const {isSticky, sentinelRef} = useStickySentinel();\n  const isDirty = !disableSaveWhenNotDirty\n    ? true\n    : Object.keys(form.formState.dirtyFields).length;\n\n  return (\n    <Form\n      onSubmit={onSubmit}\n      onBeforeSubmit={() => form.clearErrors()}\n      form={form}\n    >\n      <div ref={sentinelRef} />\n      <div\n        className={clsx(\n          'sticky top-0 my-12 md:my-24 z-10 transition-shadow',\n          isSticky && 'bg-paper shadow'\n        )}\n      >\n        <div\n          className={clsx(\n            'flex items-center md:items-start gap-24 py-14',\n            wrapInContainer && 'container mx-auto px-24'\n          )}\n        >\n          {backButton}\n          <h1 className=\"text-xl md:text-3xl whitespace-nowrap overflow-hidden overflow-ellipsis md:mr-64\">\n            {title}\n          </h1>\n          <div className=\"mr-auto\"></div>\n          {actions}\n          <Button\n            variant=\"flat\"\n            color=\"primary\"\n            type=\"submit\"\n            disabled={isLoading || !isDirty}\n          >\n            <Trans message=\"Save\" />\n          </Button>\n        </div>\n      </div>\n      <div\n        className={\n          wrapInContainer ? 'container mx-auto px-24 pb-24' : undefined\n        }\n      >\n        <div className=\"rounded\">{children}</div>\n      </div>\n    </Form>\n  );\n}\n","import React from 'react';\nimport {useDialogContext} from './dialog-context';\nimport {Dialog} from './dialog';\nimport {DialogBody} from './dialog-body';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {CloseIcon} from '@common/icons/material/Close';\nimport {KeyboardArrowLeftIcon} from '@common/icons/material/KeyboardArrowLeft';\nimport {KeyboardArrowRightIcon} from '@common/icons/material/KeyboardArrowRight';\nimport {useControlledState} from '@react-stately/utils';\n\ninterface Props {\n  image?: string;\n  images?: string[];\n  activeIndex?: number;\n  onActiveIndexChange?: (index: number) => void;\n  defaultActiveIndex?: number;\n}\nexport function ImageZoomDialog(props: Props) {\n  const {close} = useDialogContext();\n  const {image, images} = props;\n  const [activeIndex, setActiveIndex] = useControlledState(\n    props.activeIndex,\n    props.defaultActiveIndex,\n    props.onActiveIndexChange\n  );\n  const src = image || images?.[activeIndex];\n\n  return (\n    <Dialog size=\"fullscreenTakeover\" background=\"bg-black/80\">\n      <DialogBody padding=\"p-0\" className=\"w-full h-full\">\n        <IconButton\n          size=\"lg\"\n          color=\"paper\"\n          className=\"absolute top-0 right-0 text-white z-20\"\n          onClick={() => {\n            close();\n          }}\n        >\n          <CloseIcon />\n        </IconButton>\n        <div className=\"relative p-40 flex items-center justify-center w-full h-full\">\n          {images?.length ? (\n            <IconButton\n              size=\"lg\"\n              color=\"white\"\n              variant=\"flat\"\n              className=\"absolute my-auto top-0 bottom-0 left-20\"\n              radius=\"rounded\"\n              disabled={activeIndex < 1}\n              onClick={() => {\n                setActiveIndex(activeIndex - 1);\n              }}\n            >\n              <KeyboardArrowLeftIcon />\n            </IconButton>\n          ) : null}\n          <img\n            src={src}\n            alt=\"\"\n            className=\"max-h-full w-auto shadow object-contain\"\n          />\n          {images?.length ? (\n            <IconButton\n              size=\"lg\"\n              color=\"white\"\n              variant=\"flat\"\n              className=\"absolute my-auto top-0 bottom-0 right-20\"\n              radius=\"rounded\"\n              disabled={activeIndex + 1 === images?.length}\n              onClick={() => {\n                setActiveIndex(activeIndex + 1);\n              }}\n            >\n              <KeyboardArrowRightIcon />\n            </IconButton>\n          ) : null}\n        </div>\n      </DialogBody>\n    </Dialog>\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ChevronLeftIcon = createSvgIcon(\n  <path d=\"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z\" />\n, 'ChevronLeftOutlined');\n","export default \"__VITE_ASSET__ceea0447__\"","import {Channel} from '@common/channels/channel';\nimport {useParams, useSearchParams} from 'react-router-dom';\nimport {useBackendFilterUrlParams} from '@common/datatable/filters/backend-filter-url-params';\nimport {BackendFiltersUrlKey} from '@common/datatable/filters/backend-filters-url-key';\n\nexport function useChannelQueryParams(\n  channel?: Channel,\n  userParams?: Record<string, string | null>\n) {\n  const params = useParams();\n  const [searchParams] = useSearchParams();\n  const {encodedFilters} = useBackendFilterUrlParams();\n\n  const queryParams = {\n    ...userParams,\n    restriction: params.restriction || '',\n    order: searchParams.get('order'),\n    [BackendFiltersUrlKey]: encodedFilters,\n    paginate: 'simple',\n  };\n\n  // always set default channel order to keep query key stable\n  if (!queryParams.order && channel) {\n    queryParams.order = channel.config.contentOrder || 'popularity:desc';\n  }\n\n  return queryParams;\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {useParams} from 'react-router-dom';\nimport {Channel} from '@common/channels/channel';\nimport {useChannelQueryParams} from '@common/channels/use-channel-query-params';\nimport {isSsr} from '@common/utils/dom/is-ssr';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\n\nexport interface GetChannelResponse extends BackendResponse {\n  channel: Channel;\n}\n\nexport function useChannel(\n  slugOrId: string | number | undefined,\n  loader: 'channelPage' | 'editChannelPage' | 'editUserListPage',\n  userParams?: Record<string, string | null>\n) {\n  const params = useParams();\n  const channelId = slugOrId || params.slugOrId!;\n  const queryParams = useChannelQueryParams(undefined, userParams);\n  return useQuery<GetChannelResponse>(\n    // only refetch when channel ID or restriction changes and not query params.\n    // content will be re-fetched in channel content components\n    // on SSR use query params as well, to avoid caching wrong data when query params change\n    isSsr()\n      ? channelQueryKey(channelId, queryParams)\n      : channelQueryKey(channelId, {restriction: queryParams.restriction}),\n    () => fetchChannel(channelId, {...queryParams, loader}),\n    {\n      initialData: () => {\n        // @ts-ignore\n        const data = getBootstrapData().loaders?.[loader];\n        if (data?.channel.id == channelId || data?.channel.slug == channelId) {\n          return data;\n        }\n      },\n    }\n  );\n}\n\nexport function channelQueryKey(\n  slugOrId: number | string,\n  params?: Record<string, string | null>\n) {\n  return ['channel', `${slugOrId}`, params];\n}\n\nexport function channelEndpoint(slugOrId: number | string) {\n  return `channel/${slugOrId}`;\n}\n\nfunction fetchChannel(\n  slugOrId: number | string,\n  params: Record<string, string | number | undefined | null> = {}\n): Promise<GetChannelResponse> {\n  return apiClient\n    .get(channelEndpoint(slugOrId), {params})\n    .then(response => response.data);\n}\n","import {useFormContext} from 'react-hook-form';\nimport {FormSelect, Option} from '@common/ui/forms/select/select';\nimport {Trans} from '@common/i18n/trans';\nimport {UpdateChannelPayload} from '@common/admin/channels/requests/use-update-channel';\nimport React from 'react';\nimport {ChannelContentConfig} from '@common/admin/channels/channel-editor/channel-content-config';\n\ninterface Props {\n  config: ChannelContentConfig;\n  className?: string;\n  exclude?: string[];\n}\nexport function ContentModelField({config, className, exclude}: Props) {\n  const {setValue, getValues} = useFormContext<UpdateChannelPayload>();\n  return (\n    <FormSelect\n      className={className}\n      selectionMode=\"single\"\n      name=\"config.contentModel\"\n      label={<Trans message=\"Type of content\" />}\n      onSelectionChange={newValue => {\n        const modelConfig = config.models[newValue];\n        if (\n          getValues('config.contentType') === 'autoUpdate' &&\n          !modelConfig.autoUpdateMethods?.length\n        ) {\n          setValue('config.contentType', 'manual');\n        }\n        setValue('config.autoUpdateMethod', modelConfig.autoUpdateMethods?.[0]);\n        setValue(\n          'config.contentOrder',\n          modelConfig.sortMethods[0] || 'channelables.order:asc'\n        );\n        setValue('config.layout', modelConfig.layoutMethods[0]);\n      }}\n    >\n      {Object.entries(config.models)\n        .filter(([model]) => !exclude?.includes(model))\n        .map(([model, {label}]) => (\n          <Option value={model} key={model}>\n            <Trans {...label} />\n          </Option>\n        ))}\n    </FormSelect>\n  );\n}\n","import {useMediaQuery} from './use-media-query';\n\nexport function useIsTouchDevice() {\n  return useMediaQuery('((pointer: coarse))');\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const RefreshIcon = createSvgIcon(\n  <path d=\"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z\" />\n, 'RefreshOutlined');\n","import {useMutation} from '@tanstack/react-query';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {toast} from '@common/ui/toast/toast';\nimport {message} from '@common/i18n/message';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {showHttpErrorToast} from '@common/utils/http/show-http-error-toast';\nimport {NormalizedModel} from '@common/datatable/filters/normalized-model';\nimport {Channel, ChannelConfig} from '@common/channels/channel';\n\ninterface Response extends BackendResponse {\n  channel: Channel<NormalizedModel>;\n}\n\ninterface Payload {\n  channelConfig?: Partial<ChannelConfig>;\n}\n\nexport function useUpdateChannelContent(channelId: number | string) {\n  const {trans} = useTrans();\n  return useMutation((payload: Payload) => updateChannel(channelId, payload), {\n    onSuccess: () => {\n      toast(trans(message('Channel content updated')));\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n\nfunction updateChannel(channelId: number | string, payload: Payload) {\n  return apiClient\n    .post<Response>(`channel/${channelId}/update-content`, {\n      ...payload,\n      normalizeContent: true,\n    })\n    .then(r => r.data);\n}\n","import {\n  useFieldArray,\n  UseFieldArrayReturn,\n  useFormContext,\n} from 'react-hook-form';\nimport {NormalizedModel} from '@common/datatable/filters/normalized-model';\nimport {Trans} from '@common/i18n/trans';\nimport {Table} from '@common/ui/tables/table';\nimport {RowElementProps} from '@common/ui/tables/table-row';\nimport {useIsTouchDevice} from '@common/utils/hooks/is-touch-device';\nimport React, {\n  cloneElement,\n  ReactElement,\n  ReactNode,\n  useContext,\n  useRef,\n  useState,\n} from 'react';\nimport {TableContext} from '@common/ui/tables/table-context';\nimport {DragPreviewRenderer} from '@common/ui/interactions/dnd/use-draggable';\nimport {\n  DropPosition,\n  useSortable,\n} from '@common/ui/interactions/dnd/use-sortable';\nimport clsx from 'clsx';\nimport {mergeProps} from '@react-aria/utils';\nimport {ColumnConfig} from '@common/datatable/column-config';\nimport {DragHandleIcon} from '@common/icons/material/DragHandle';\nimport {NameWithAvatar} from '@common/datatable/column-templates/name-with-avatar';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {CloseIcon} from '@common/icons/material/Close';\nimport {DragPreview} from '@common/ui/interactions/dnd/drag-preview';\nimport {WarningIcon} from '@common/icons/material/Warning';\nimport {IllustratedMessage} from '@common/ui/images/illustrated-message';\nimport playlist from '../playlist.svg';\nimport {SvgImage} from '@common/ui/images/svg-image/svg-image';\nimport {useParams} from 'react-router-dom';\nimport {Button} from '@common/ui/buttons/button';\nimport {RefreshIcon} from '@common/icons/material/Refresh';\nimport {UpdateChannelPayload} from '@common/admin/channels/requests/use-update-channel';\nimport {useUpdateChannelContent} from '@common/admin/channels/requests/use-update-channel-content';\nimport {ChannelContentSearchFieldProps} from '@common/admin/channels/channel-editor/channel-content-search-field';\n\nconst columnConfig: ColumnConfig<NormalizedModel>[] = [\n  {\n    key: 'dragHandle',\n    width: 'w-42 flex-shrink-0',\n    header: () => <Trans message=\"Drag handle\" />,\n    hideHeader: true,\n    body: () => (\n      <DragHandleIcon className=\"cursor-pointer text-muted hover:text\" />\n    ),\n  },\n  {\n    key: 'name',\n    header: () => <Trans message=\"Content item\" />,\n    visibleInMode: 'all',\n    body: item => (\n      <NameWithAvatar\n        image={item.image}\n        label={item.name}\n        description={item.description}\n      />\n    ),\n  },\n  {\n    key: 'type',\n    header: () => <Trans message=\"Content type\" />,\n    width: 'w-100 flex-shrink-0',\n    body: item => <span className=\"capitalize\">{item.model_type}</span>,\n  },\n  {\n    key: 'actions',\n    header: () => <Trans message=\"Actions\" />,\n    hideHeader: true,\n    align: 'end',\n    width: 'w-42 flex-shrink-0',\n    visibleInMode: 'all',\n    body: (item, {index}) => <RemoveItemColumn index={index} />,\n  },\n];\n\ninterface Props {\n  searchField: ReactElement<ChannelContentSearchFieldProps>;\n  title?: ReactNode;\n  noResultsMessage?: ReactNode;\n}\nexport function ChannelContentEditor({\n  searchField,\n  title,\n  noResultsMessage,\n}: Props) {\n  const {watch, getValues} = useFormContext<UpdateChannelPayload>();\n  const contentType = watch('config.contentType');\n  const fieldArray = useFieldArray<UpdateChannelPayload, 'content.data'>({\n    name: 'content.data',\n  });\n  // need to watch this and use it in table, otherwise content will not update when using \"update content now\" button\n  const content = watch('content');\n\n  // only show delete and drag buttons when channel content is managed manually\n  const filteredColumns = columnConfig.filter(col => {\n    return !(\n      contentType !== 'manual' &&\n      (col.key === 'actions' || col.key === 'dragHandle')\n    );\n  });\n\n  return (\n    <div className=\"mt-40 pt-40 border-t\">\n      <div className=\"mb-40\">\n        <h2 className=\"text-2xl mb-10\">\n          {title || <Trans message=\"Channel content\" />}\n        </h2>\n        <ContentNotEditableWarning />\n        <UpdateContentButton />\n        {contentType === 'manual'\n          ? cloneElement<ChannelContentSearchFieldProps>(searchField, {\n              onResultSelected: result => {\n                const alreadyAttached = getValues('content.data').find(\n                  x => x.id === result.id && x.model_type === result.model_type\n                );\n                if (!alreadyAttached) {\n                  fieldArray.prepend(result);\n                }\n              },\n            })\n          : null}\n      </div>\n      <Table\n        className=\"mt-24\"\n        columns={filteredColumns}\n        data={content.data}\n        meta={fieldArray}\n        renderRowAs={contentType === 'manual' ? ContentTableRow : undefined}\n        enableSelection={false}\n        hideHeaderRow\n      />\n      {!fieldArray.fields.length && contentType === 'manual'\n        ? noResultsMessage || (\n            <IllustratedMessage\n              title={<Trans message=\"Channel is empty\" />}\n              description={\n                <Trans message=\"No content is attached to this channel yet.\" />\n              }\n              image={<SvgImage src={playlist} />}\n            />\n          )\n        : null}\n    </div>\n  );\n}\n\nfunction ContentTableRow({\n  item,\n  children,\n  className,\n  ...domProps\n}: RowElementProps<NormalizedModel>) {\n  const isTouchDevice = useIsTouchDevice();\n  const {data, meta} = useContext(TableContext);\n  const domRef = useRef<HTMLTableRowElement>(null);\n  const previewRef = useRef<DragPreviewRenderer>(null);\n  const [dropPosition, setDropPosition] = useState<DropPosition>(null);\n  const fieldArray = meta as UseFieldArrayReturn;\n\n  const {sortableProps} = useSortable({\n    ref: domRef,\n    disabled: isTouchDevice ?? false,\n    item,\n    items: data,\n    type: 'channelContentItem',\n    preview: previewRef,\n    previewVariant: 'line',\n    onDropPositionChange: position => {\n      setDropPosition(position);\n    },\n    onSortEnd: (oldIndex, newIndex) => {\n      fieldArray.move(oldIndex, newIndex);\n    },\n  });\n\n  return (\n    <div\n      className={clsx(\n        className,\n        dropPosition === 'before' && 'sort-preview-before',\n        dropPosition === 'after' && 'sort-preview-after'\n      )}\n      ref={domRef}\n      {...mergeProps(sortableProps, domProps)}\n    >\n      {children}\n      {!item.isPlaceholder && <RowDragPreview item={item} ref={previewRef} />}\n    </div>\n  );\n}\n\ninterface RowDragPreviewProps {\n  item: NormalizedModel;\n}\nconst RowDragPreview = React.forwardRef<\n  DragPreviewRenderer,\n  RowDragPreviewProps\n>(({item}, ref) => {\n  return (\n    <DragPreview ref={ref}>\n      {() => (\n        <div className=\"p-8 rounded shadow bg-chip text-base\">{item.name}</div>\n      )}\n    </DragPreview>\n  );\n});\n\ninterface RemoveItemColumnProps {\n  index: number;\n}\nfunction RemoveItemColumn({index}: RemoveItemColumnProps) {\n  const {meta} = useContext(TableContext);\n  const fieldArray = meta as UseFieldArrayReturn;\n  return (\n    <IconButton\n      size=\"md\"\n      className=\"text-muted\"\n      onClick={() => {\n        fieldArray.remove(index);\n      }}\n    >\n      <CloseIcon />\n    </IconButton>\n  );\n}\n\nfunction ContentNotEditableWarning() {\n  const {watch} = useFormContext<UpdateChannelPayload>();\n  const contentType = watch('config.contentType');\n\n  if (contentType === 'manual') {\n    return null;\n  }\n\n  return (\n    <div className=\"flex items-center gap-8 mt-4 mb-20\">\n      <WarningIcon size=\"xs\" />\n      <div className=\"text-xs text-muted\">\n        {contentType === 'listAll' ? (\n          <Trans message=\"This channel is listing all available content of specified type, and can't be curated manually.\" />\n        ) : null}\n        {contentType === 'autoUpdate' ? (\n          <Trans message=\"This channel content is set to update automatically and can't be curated manually.\" />\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\nfunction UpdateContentButton() {\n  const {slugOrId} = useParams();\n  const updateContent = useUpdateChannelContent(slugOrId!);\n  const {setValue, watch, getValues} = useFormContext<UpdateChannelPayload>();\n\n  if (watch('config.contentType') !== 'autoUpdate') {\n    return null;\n  }\n\n  return (\n    <Button\n      size=\"xs\"\n      variant=\"outline\"\n      color=\"primary\"\n      startIcon={<RefreshIcon />}\n      onClick={() => {\n        updateContent.mutate(\n          {\n            channelConfig: getValues('config'),\n          },\n          {\n            onSuccess: response => {\n              if (response.channel.content) {\n                setValue('content', response.channel.content);\n              }\n            },\n          }\n        );\n      }}\n      disabled={\n        updateContent.isLoading ||\n        !watch('config.autoUpdateMethod') ||\n        !watch('id')\n      }\n    >\n      <Trans message=\"Update content now\" />\n    </Button>\n  );\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {NormalizedModel} from '@common/datatable/filters/normalized-model';\n\nexport interface SearchResponse extends BackendResponse {\n  results: NormalizedModel[];\n}\n\ninterface SearchParams {\n  query?: string;\n  limit?: number;\n  modelType: string;\n}\n\nexport function useAddableContent(params: SearchParams) {\n  return useQuery(['search', params], () => search(params), {\n    //enabled: !!params.query,\n    keepPreviousData: !!params.query,\n  });\n}\n\nfunction search(params: SearchParams) {\n  return apiClient\n    .get<SearchResponse>(`channel/search-for-addable-content`, {params})\n    .then(response => response.data);\n}\n","import {NormalizedModel} from '@common/datatable/filters/normalized-model';\nimport {useFormContext} from 'react-hook-form';\nimport {UpdateChannelPayload} from '@common/admin/channels/requests/use-update-channel';\nimport {useTrans} from '@common/i18n/use-trans';\nimport React, {useState} from 'react';\nimport {useAddableContent} from '@common/admin/channels/requests/use-addable-content';\nimport {ComboBox} from '@common/ui/forms/combobox/combobox';\nimport {message} from '@common/i18n/message';\nimport {SearchIcon} from '@common/icons/material/Search';\nimport {Item} from '@common/ui/forms/listbox/item';\n\nexport interface ChannelContentSearchFieldProps {\n  onResultSelected?: (result: NormalizedModel) => void;\n  imgRenderer?: (result: NormalizedModel) => React.ReactNode;\n}\nexport function ChannelContentSearchField({\n  onResultSelected,\n  imgRenderer,\n}: ChannelContentSearchFieldProps) {\n  const {watch} = useFormContext<UpdateChannelPayload>();\n  const contentModel = watch('config.contentModel');\n  const {trans} = useTrans();\n  const [query, setQuery] = useState('');\n  const {isFetching, data} = useAddableContent({\n    query,\n    modelType: contentModel,\n  });\n  return (\n    <ComboBox\n      isAsync\n      placeholder={trans(message('Search for content to add...'))}\n      isLoading={isFetching}\n      inputValue={query}\n      onInputValueChange={setQuery}\n      clearInputOnItemSelection\n      blurReferenceOnItemSelection\n      selectionMode=\"none\"\n      openMenuOnFocus\n      floatingMaxHeight={670}\n      startAdornment={<SearchIcon />}\n      hideEndAdornment\n    >\n      {data?.results.map(result => (\n        <Item\n          key={result.id}\n          value={result.id}\n          onSelected={() => onResultSelected?.(result)}\n          startIcon={imgRenderer ? imgRenderer(result) : null}\n          description={result.description}\n          textLabel={result.name}\n        >\n          {result.name}\n        </Item>\n      ))}\n    </ComboBox>\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ImageIcon = createSvgIcon(\n  <path d=\"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86-3 3.87L9 13.14 6 17h12l-3.86-5.14z\" />\n, 'ImageOutlined');\n","import {NormalizedModel} from '@common/datatable/filters/normalized-model';\nimport {useImageSrc} from '@app/images/use-image-src';\nimport clsx from 'clsx';\nimport {ImageIcon} from '@common/icons/material/Image';\n\ninterface Props {\n  item: NormalizedModel;\n}\nexport function ChannelContentItemImage({item}: Props) {\n  const src = useImageSrc(item.image, {size: 'sm'});\n\n  const imageClassName = clsx(\n    'aspect-square w-46 rounded object-cover',\n    !src ? 'flex items-center justify-center' : 'block'\n  );\n\n  return src ? (\n    <img className={imageClassName} src={src} alt=\"\" />\n  ) : (\n    <span className={imageClassName}>\n      <ImageIcon className=\"max-w-[60%] text-divider\" size=\"text-6xl\" />\n    </span>\n  );\n}\n","import {useFormContext} from 'react-hook-form';\nimport {FormSelect, Option} from '@common/ui/forms/select/select';\nimport {Trans} from '@common/i18n/trans';\nimport {UpdateChannelPayload} from '@common/admin/channels/requests/use-update-channel';\nimport {ChannelContentConfig} from '@common/admin/channels/channel-editor/channel-content-config';\n\ninterface Props {\n  config: ChannelContentConfig;\n}\nexport function ContentOrderField({config}: Props) {\n  const {watch} = useFormContext<UpdateChannelPayload>();\n  const contentType = watch('config.contentType');\n  const modelConfig = config.models[watch('config.contentModel')];\n  const sortMethods = [...modelConfig.sortMethods, 'channelables.order:asc'];\n\n  return (\n    <FormSelect\n      className=\"my-24\"\n      selectionMode=\"single\"\n      name=\"config.contentOrder\"\n      label={<Trans message=\"How to order content\" />}\n    >\n      {sortMethods.map(method => {\n        const sortConfig = config.sortingMethods[method];\n        if (\n          !sortConfig.contentTypes ||\n          sortConfig.contentTypes.includes(contentType)\n        ) {\n          return (\n            <Option value={method} key={method}>\n              <Trans {...sortConfig.label} />\n            </Option>\n          );\n        }\n      })}\n    </FormSelect>\n  );\n}\n","import {Video} from './video';\nimport {TitleImage} from './title-image';\nimport {Episode} from './episode';\nimport {Season} from './season';\nimport {Review} from './review';\nimport {Genre} from '@app/titles/models/genre';\nimport {Keyword} from '@app/titles/models/keyword';\nimport {ProductionCountry} from '@app/titles/models/production-country';\nimport {Person} from '@app/titles/models/person';\n\nexport interface EpisodeCredit extends Episode {\n  pivot: TitleCreditPivot;\n}\n\nexport interface TitleCredit extends Person {\n  pivot: TitleCreditPivot;\n}\n\nexport interface PersonCredit extends Title {\n  credited_episode_count?: number;\n  episodes: EpisodeCredit[];\n  pivot: TitleCreditPivot;\n}\n\nexport interface TitleCreditPivot {\n  id: number;\n  job: string;\n  department: 'directing' | 'writing' | 'actors' | 'creators';\n  character: string;\n}\n\nexport const TITLE_MODEL = 'title';\nexport const MOVIE_MODEL = 'movie';\nexport const SERIES_MODEL = 'series';\n\nexport interface Title {\n  id: number;\n  name: string;\n  original_title: string;\n  model_type: typeof TITLE_MODEL;\n  is_series: boolean;\n  status: 'released' | 'upcoming' | 'ongoing' | 'ended';\n  description: string;\n  tagline: string;\n  runtime: number;\n  rating: number;\n  budget: number;\n  poster?: string;\n  backdrop: string;\n  revenue: number;\n  views: number;\n  popularity: number;\n  seasons_count: number;\n  release_date: string;\n  year: number;\n  genres: Genre[];\n  keywords: Keyword[];\n  production_countries: ProductionCountry[];\n  videos: Video[];\n  all_videos?: Video[];\n  primary_video: Video;\n  primary_video_count?: number;\n  certification?: string;\n  images: TitleImage[];\n  season?: Season;\n  seasons?: Season[];\n  reviews?: Review[];\n  language: string;\n  updated_at?: string;\n}\n","export const NEWS_ARTICLE_MODEL = 'newsArticle';\n\nexport interface NewsArticle {\n  id: number;\n  title?: string;\n  body: string;\n  slug: string;\n  image: string;\n  byline?: string;\n  source?: string;\n  source_url?: string;\n  model_type: typeof NEWS_ARTICLE_MODEL;\n  created_at?: string;\n  updated_at?: string;\n}\n","import {PaginationResponse} from '@common/http/backend-response/pagination-response';\nimport {User} from '@common/auth/user';\n\nexport const CHANNEL_MODEL = 'channel';\n\nexport type ChannelContentItem<T = unknown> = T & {\n  channelable_id?: number;\n  channelable_order?: number;\n};\n\nexport interface ChannelConfig {\n  autoUpdateMethod?: string;\n  autoUpdateProvider?: string;\n  disablePagination?: boolean;\n  disablePlayback?: boolean;\n  restriction?: string;\n  restrictionModelId?: 'urlParam' | number;\n  contentModel: string;\n  contentType: 'listAll' | 'manual' | 'autoUpdate';\n  contentOrder: string;\n  // layout user selected manually, it's stored in a cookie and set as this\n  // prop in channel controller so there are no mismatches during SSR\n  selectedLayout?: string;\n  layout: string;\n  nestedLayout: string;\n  hideTitle?: boolean;\n  lockSlug?: boolean;\n  preventDeletion?: boolean;\n  actions?: {tooltip: string; icon: string; route: string}[];\n}\n\nexport interface Channel<T = ChannelContentItem> {\n  id: number;\n  name: string;\n  internal: boolean;\n  public: boolean;\n  description?: string;\n  type: string;\n  slug: string;\n  config: ChannelConfig;\n  items?: T[];\n  model_type: 'channel';\n  items_count?: number;\n  user?: User;\n  updated_at?: string;\n  restriction?: {name: string; model_type: string};\n  content?: PaginationResponse<T>;\n}\n","import {PersonCredit} from './title';\n\nexport const PERSON_MODEL = 'person';\n\nexport interface Person {\n  id: number;\n  name: string;\n  poster?: string;\n  known_for?: string;\n  gender?: string;\n  birth_date: string;\n  death_date: string;\n  birth_place: string;\n  primary_credit?: PersonCredit;\n  views?: number;\n  popularity?: number;\n  updated_at?: string;\n  description: string;\n  model_type: typeof PERSON_MODEL;\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const GridViewIcon = createSvgIcon(\n  <path d=\"M3 3v8h8V3H3zm6 6H5V5h4v4zm-6 4v8h8v-8H3zm6 6H5v-4h4v4zm4-16v8h8V3h-8zm6 6h-4V5h4v4zm-6 4v8h8v-8h-8zm6 6h-4v-4h4v4z\" />\n, 'GridViewOutlined');\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ViewWeekIcon = createSvgIcon(\n  <path d=\"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM8 18H4V6h4v12zm6 0h-4V6h4v12zm6 0h-4V6h4v12z\" />\n, 'ViewWeekOutlined');\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ViewListIcon = createSvgIcon(\n  <path d=\"M3 5v14h18V5H3zm4 2v2H5V7h2zm-2 6v-2h2v2H5zm0 2h2v2H5v-2zm14 2H9v-2h10v2zm0-4H9v-2h10v2zm0-4H9V7h10v2z\" />\n, 'ViewListOutlined');\n","import {message} from '@common/i18n/message';\nimport {\n  MOVIE_MODEL,\n  SERIES_MODEL,\n  Title,\n  TITLE_MODEL,\n} from '@app/titles/models/title';\nimport {NEWS_ARTICLE_MODEL, NewsArticle} from '@app/titles/models/news-article';\nimport {Channel, CHANNEL_MODEL} from '@common/channels/channel';\nimport {ChannelContentConfig} from '@common/admin/channels/channel-editor/channel-content-config';\nimport {Person, PERSON_MODEL} from '@app/titles/models/person';\nimport {GridViewIcon} from '@common/icons/material/GridView';\nimport {ViewWeekIcon} from '@common/icons/material/ViewWeek';\nimport {ViewListIcon} from '@common/icons/material/ViewList';\n\nexport enum Sort {\n  popular = 'popularity:desc',\n  recent = 'created_at:desc',\n  rating = 'rating:desc',\n  curated = 'channelables.order:asc',\n  name = 'name:asc',\n  birthdayDesc = 'birth_date:desc',\n  birthdayAsc = 'birth_date:asc',\n  budget = 'budget:desc',\n  revenue = 'revenue:desc',\n}\nexport enum Layout {\n  grid = 'grid',\n  landscapeGrid = 'landscapeGrid',\n  list = 'list',\n  news = 'news',\n  carousel = 'carousel',\n  landscapeCarousel = 'landscapeCarousel',\n  slider = 'slider',\n}\nenum Auto {\n  latestVideos = 'latestVideos',\n  mostPopular = 'mostPopular',\n  topRated = 'topRated',\n  upcoming = 'upcoming',\n  nowPlaying = 'nowPlaying',\n  airingToday = 'airingToday',\n  airingThisWeek = 'airingThisWeek',\n  trendingPeople = 'trendingPeople',\n  discover = 'discover',\n}\n\nconst contentModels: ChannelContentConfig['models'] = {\n  [MOVIE_MODEL]: {\n    label: message('Movies'),\n    sortMethods: [\n      Sort.popular,\n      Sort.recent,\n      Sort.rating,\n      Sort.budget,\n      Sort.revenue,\n    ],\n    layoutMethods: [\n      Layout.grid,\n      Layout.landscapeGrid,\n      Layout.list,\n      Layout.carousel,\n      Layout.landscapeCarousel,\n      Layout.slider,\n    ],\n    autoUpdateMethods: [\n      Auto.latestVideos,\n      Auto.mostPopular,\n      Auto.topRated,\n      Auto.upcoming,\n      Auto.nowPlaying,\n      Auto.discover,\n    ],\n  },\n  [SERIES_MODEL]: {\n    label: message('TV series'),\n    sortMethods: [\n      Sort.popular,\n      Sort.recent,\n      Sort.rating,\n      Sort.budget,\n      Sort.revenue,\n    ],\n    layoutMethods: [\n      Layout.grid,\n      Layout.landscapeGrid,\n      Layout.list,\n      Layout.carousel,\n      Layout.landscapeCarousel,\n      Layout.slider,\n    ],\n    autoUpdateMethods: [\n      Auto.latestVideos,\n      Auto.mostPopular,\n      Auto.topRated,\n      Auto.airingThisWeek,\n      Auto.airingToday,\n      Auto.discover,\n    ],\n  },\n  [TITLE_MODEL]: {\n    label: message('Titles (movies and series)'),\n    sortMethods: [\n      Sort.popular,\n      Sort.recent,\n      Sort.rating,\n      Sort.budget,\n      Sort.revenue,\n    ],\n    layoutMethods: [\n      Layout.grid,\n      Layout.landscapeGrid,\n      Layout.list,\n      Layout.carousel,\n      Layout.landscapeCarousel,\n      Layout.slider,\n    ],\n    autoUpdateMethods: [Auto.latestVideos],\n  },\n  [NEWS_ARTICLE_MODEL]: {\n    label: message('News articles'),\n    sortMethods: [Sort.recent],\n    layoutMethods: [Layout.news, Layout.landscapeCarousel, Layout.list],\n  },\n  [PERSON_MODEL]: {\n    label: message('People'),\n    sortMethods: [\n      Sort.popular,\n      Sort.recent,\n      Sort.name,\n      Sort.birthdayDesc,\n      Sort.birthdayAsc,\n    ],\n    layoutMethods: [Layout.grid, Layout.list, Layout.carousel],\n    autoUpdateMethods: [Auto.trendingPeople],\n  },\n  [CHANNEL_MODEL]: {\n    label: message('Channels'),\n    sortMethods: [],\n    layoutMethods: [Layout.list],\n  },\n};\n\nconst contentSortingMethods: Record<\n  Sort,\n  ChannelContentConfig['sortingMethods']['any']\n> = {\n  [Sort.popular]: {\n    label: message('Most popular first'),\n  },\n  [Sort.recent]: {\n    label: message('Recently added first'),\n  },\n  [Sort.rating]: {\n    label: message('Highest rated first'),\n  },\n  [Sort.curated]: {\n    label: message('Curated (reorder below)'),\n    contentTypes: ['manual'],\n  },\n  [Sort.name]: {\n    label: message('Name (A-Z)'),\n    contentTypes: ['manual'],\n  },\n  [Sort.birthdayAsc]: {\n    label: message('Youngest first'),\n  },\n  [Sort.birthdayDesc]: {\n    label: message('Oldest first'),\n  },\n  [Sort.budget]: {\n    label: message('Biggest budget first'),\n  },\n  [Sort.revenue]: {\n    label: message('Biggest revenue first'),\n  },\n};\n\nconst contentLayoutMethods: Record<\n  Layout,\n  ChannelContentConfig['layoutMethods']['any']\n> = {\n  [Layout.grid]: {\n    label: message('Grid'),\n    icon: <GridViewIcon />,\n  },\n  [Layout.landscapeGrid]: {\n    label: message('Landscape'),\n    icon: <ViewWeekIcon />,\n  },\n  [Layout.list]: {\n    label: message('List'),\n    icon: <ViewListIcon />,\n  },\n  [Layout.carousel]: {\n    label: message('Carousel (portrait)'),\n  },\n  [Layout.landscapeCarousel]: {\n    label: message('Carousel (landscape)'),\n  },\n  [Layout.slider]: {\n    label: message('Slider'),\n  },\n  [Layout.news]: {\n    label: message('News'),\n  },\n};\n\nconst contentAutoUpdateMethods: Record<\n  Auto,\n  ChannelContentConfig['autoUpdateMethods']['any']\n> = {\n  [Auto.discover]: {\n    label: message('Discover (TMDB only)'),\n    tmdbOnly: true,\n  },\n  [Auto.mostPopular]: {\n    label: message('Most popular'),\n  },\n  [Auto.topRated]: {\n    label: message('Top rated'),\n  },\n  [Auto.upcoming]: {\n    label: message('Upcoming'),\n  },\n  [Auto.nowPlaying]: {\n    label: message('In theaters'),\n  },\n  [Auto.airingToday]: {\n    label: message('Airing today'),\n  },\n  [Auto.airingThisWeek]: {\n    label: message('Airing this week'),\n  },\n  [Auto.trendingPeople]: {\n    label: message('Trending people'),\n  },\n  [Auto.latestVideos]: {\n    label: message('Most recently published videos'),\n    localOnly: true,\n  },\n};\nexport const channelContentConfig: ChannelContentConfig = {\n  models: contentModels,\n  sortingMethods: contentSortingMethods,\n  layoutMethods: contentLayoutMethods,\n  autoUpdateMethods: contentAutoUpdateMethods,\n  userSelectableLayouts: [Layout.grid, Layout.landscapeGrid, Layout.list],\n};\n\nexport type ChannelContentModel = (Title | NewsArticle | Person | Channel) & {\n  channelable_id?: number;\n  channelable_order?: number;\n};\n","export const GENRE_MODEL = 'genre';\n\nexport interface Genre {\n  id: number;\n  name: string;\n  display_name: string;\n  updated_at: string;\n  created_at: string;\n  model_type: typeof GENRE_MODEL;\n}\n","export const PRODUCTION_COUNTRY_MODEL = 'production_country';\n\nexport interface ProductionCountry {\n  id: number;\n  name: string;\n  display_name: string;\n  updated_at: string;\n  created_at: string;\n  model_type: typeof PRODUCTION_COUNTRY_MODEL;\n}\n","import {Link, LinkProps} from 'react-router-dom';\nimport clsx from 'clsx';\nimport React, {ReactNode, useMemo} from 'react';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\nimport {NewsArticle} from '@app/titles/models/news-article';\n\ninterface Props extends Omit<LinkProps, 'to'> {\n  article: NewsArticle;\n  className?: string;\n  children?: ReactNode;\n  color?: 'primary' | 'inherit';\n}\nexport function NewsArticleLink({\n  article,\n  className,\n  children,\n  color = 'inherit',\n  ...linkProps\n}: Props) {\n  const finalUri = useMemo(() => {\n    return getNewsArticleLink(article);\n  }, [article]);\n\n  return (\n    <Link\n      {...linkProps}\n      className={clsx(\n        color === 'primary'\n          ? 'text-primary hover:text-primary-dark'\n          : 'text-inherit',\n        'hover:underline outline-none focus-visible:underline overflow-x-hidden overflow-ellipsis transition-colors',\n        className\n      )}\n      to={finalUri}\n    >\n      {children ?? article.title}\n    </Link>\n  );\n}\n\nexport function getNewsArticleLink(\n  article: NewsArticle,\n  {absolute}: {absolute?: boolean} = {}\n): string {\n  let link = `/news/${article.id}`;\n  if (absolute) {\n    link = `${getBootstrapData().settings.base_url}${link}`;\n  }\n  return link;\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const NewspaperIcon = createSvgIcon(\n  <path d=\"m22 3-1.67 1.67L18.67 3 17 4.67 15.33 3l-1.66 1.67L12 3l-1.67 1.67L8.67 3 7 4.67 5.33 3 3.67 4.67 2 3v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V3zM11 19H4v-6h7v6zm9 0h-7v-2h7v2zm0-4h-7v-2h7v2zm0-4H4V8h16v3z\" />\n, 'NewspaperOutlined');\n","import {useTrans} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\nimport clsx from 'clsx';\nimport {NewsArticle} from '@app/titles/models/news-article';\nimport {NewsArticleLink} from '@app/news/news-article-link';\nimport {NewspaperIcon} from '@common/icons/material/Newspaper';\n\ninterface Props {\n  article: NewsArticle;\n  className?: string;\n  size?: string;\n  lazy?: boolean;\n}\nexport function NewsArticleImage({\n  article,\n  className,\n  size,\n  lazy = true,\n}: Props) {\n  const {trans} = useTrans();\n  const src = article.image;\n\n  const imageClassName = clsx(\n    className,\n    size,\n    'object-cover bg-fg-base/4 rounded',\n    !src ? 'flex items-center justify-center' : 'block'\n  );\n\n  const image = src ? (\n    <img\n      className={imageClassName}\n      draggable={false}\n      loading={lazy ? 'lazy' : 'eager'}\n      src={src}\n      alt={trans(message('Image for :name', {values: {name: article.title}}))}\n    />\n  ) : (\n    <span className={imageClassName}>\n      <NewspaperIcon className=\"max-w-[60%] text-divider\" size=\"text-6xl\" />\n    </span>\n  );\n\n  return (\n    <NewsArticleLink article={article} className=\"group relative flex-shrink-0\">\n      {image}\n      <div className=\"pointer-events-none absolute inset-0 bg-black opacity-0 transition-opacity group-hover:opacity-10\" />\n    </NewsArticleLink>\n  );\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {toast} from '@common/ui/toast/toast';\nimport {message} from '@common/i18n/message';\nimport {showHttpErrorToast} from '@common/utils/http/show-http-error-toast';\n\ninterface Response extends BackendResponse {\n  //\n}\n\ninterface Payload {\n  commentIds: number[];\n}\n\nexport function useDeleteComments() {\n  return useMutation((payload: Payload) => deleteComments(payload), {\n    onSuccess: (response, payload) => {\n      toast(\n        message('[one Comment deleted|other Deleted :count comments]', {\n          values: {count: payload.commentIds.length},\n        })\n      );\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n\nfunction deleteComments({commentIds}: Payload): Promise<Response> {\n  return apiClient.delete(`comment/${commentIds.join(',')}`).then(r => r.data);\n}\n","import {Avatar, AvatarProps} from '@common/ui/images/avatar';\nimport {User} from '@common/auth/user';\nimport {useContext} from 'react';\nimport {SiteConfigContext} from '@common/core/settings/site-config-context';\n\ninterface UserAvatarProps extends Omit<AvatarProps, 'label' | 'src' | 'link'> {\n  user?: User;\n}\nexport function UserAvatar({user, ...props}: UserAvatarProps) {\n  const {auth} = useContext(SiteConfigContext);\n  return (\n    <Avatar\n      {...props}\n      label={user?.display_name}\n      src={user?.avatar}\n      link={user?.id && auth.getUserProfileLink?.(user)}\n    />\n  );\n}\n","import {\n  hashQueryKey,\n  useInfiniteQuery,\n  UseInfiniteQueryResult,\n} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {\n  hasNextPage,\n  PaginationResponse,\n} from '@common/http/backend-response/pagination-response';\nimport {useMemo, useRef, useState} from 'react';\nimport {SortDescriptor} from '@common/ui/tables/types/sort-descriptor';\nimport {GetDatatableDataParams} from '@common/datatable/requests/paginated-resources';\nimport {QueryKey} from '@tanstack/query-core/src/types';\n\nexport type UseInfiniteDataResult<\n  T,\n  E extends object = object\n> = UseInfiniteQueryResult<PaginationResponse<T> & E> & {\n  items: T[];\n  totalItems: number | null;\n  // initial load is done and no results were returned from backend\n  noResults: boolean;\n  // true when changing filters or sorting, not on initial load, background fetch or infinite load\n  isReloading: boolean;\n  sortDescriptor: SortDescriptor;\n  setSortDescriptor: (sortDescriptor: SortDescriptor) => void;\n  searchQuery: string;\n  setSearchQuery: (searchQuery: string) => void;\n};\n\nfunction buildQueryKey(\n  {\n    queryKey,\n    defaultOrderDir,\n    defaultOrderBy,\n    queryParams,\n  }: UseInfiniteDataProps<any>,\n  sortDescriptor: SortDescriptor,\n  searchQuery: string = ''\n) {\n  // make sure to always set default order dir and col so query keys are consistent\n  if (!sortDescriptor.orderBy) {\n    sortDescriptor.orderBy = defaultOrderBy;\n  }\n  if (!sortDescriptor.orderDir) {\n    sortDescriptor.orderDir = defaultOrderDir;\n  }\n  return [...queryKey, sortDescriptor, searchQuery, queryParams];\n}\n\ninterface Response<T> extends BackendResponse {\n  pagination: PaginationResponse<T>;\n}\n\nexport interface UseInfiniteDataProps<T> {\n  initialPage?: PaginationResponse<T> | null;\n  queryKey: QueryKey;\n  queryParams?: Record<string, string | number | null>;\n  endpoint: string;\n  defaultOrderBy?: SortDescriptor['orderBy'];\n  defaultOrderDir?: SortDescriptor['orderDir'];\n  // whether user can sort items manually (table header, dropdown, etc)\n  willSortOrFilter?: boolean;\n  // ordering is not available with cursor pagination\n  paginate?: 'simple' | 'lengthAware' | 'cursor';\n  transformResponse?: (response: Response<T>) => Response<T>;\n}\nexport function useInfiniteData<T, E extends object = {}>(\n  props: UseInfiniteDataProps<T>\n): UseInfiniteDataResult<T, E> {\n  const {\n    initialPage,\n    endpoint,\n    defaultOrderBy,\n    defaultOrderDir,\n    queryParams,\n    paginate,\n    transformResponse,\n    willSortOrFilter = false,\n  } = props;\n  const [searchQuery, setSearchQuery] = useState('');\n  const [sortDescriptor, setSortDescriptor] = useState<SortDescriptor>({\n    orderBy: defaultOrderBy,\n    orderDir: defaultOrderDir,\n  });\n\n  const queryKey = buildQueryKey(props, sortDescriptor, searchQuery);\n  const initialQueryKey = useRef(hashQueryKey(queryKey)).current;\n\n  const query = useInfiniteQuery({\n    keepPreviousData: willSortOrFilter,\n    queryKey,\n    queryFn: ({pageParam}) => {\n      const params: GetDatatableDataParams = {\n        ...queryParams,\n        perPage: initialPage?.per_page || queryParams?.perPage,\n        query: searchQuery,\n        paginate,\n        ...sortDescriptor,\n      };\n      if (paginate === 'cursor') {\n        params.cursor = pageParam;\n      } else {\n        params.page = pageParam || 1;\n      }\n      return fetchData<T>(endpoint, params, transformResponse);\n    },\n    getNextPageParam: lastResponse => {\n      if (!hasNextPage(lastResponse.pagination)) {\n        return undefined;\n      }\n      if ('next_cursor' in lastResponse.pagination) {\n        return lastResponse.pagination.next_cursor;\n      }\n      return lastResponse.pagination.current_page + 1;\n    },\n    initialData: () => {\n      // initial data will be for initial query key only, remove\n      // initial data if query key changes, so query is reset\n      if (!initialPage || hashQueryKey(queryKey) !== initialQueryKey) {\n        return undefined;\n      }\n\n      return {\n        pageParams: [undefined, 1],\n        pages: [{pagination: initialPage}],\n      };\n    },\n  });\n\n  const items = useMemo(() => {\n    return query.data?.pages.flatMap(p => p.pagination.data) || [];\n  }, [query.data?.pages]);\n\n  const firstPage = query.data?.pages[0].pagination;\n  const totalItems =\n    firstPage && 'total' in firstPage && firstPage.total\n      ? firstPage.total\n      : null;\n\n  return {\n    ...query,\n    items,\n    totalItems,\n    noResults: query.data?.pages?.[0].pagination.data.length === 0,\n    // can't use \"isRefetching\", it's true for some reason when changing sorting or filters\n    isReloading:\n      query.isFetching && !query.isFetchingNextPage && query.isPreviousData,\n    sortDescriptor,\n    setSortDescriptor,\n    searchQuery,\n    setSearchQuery,\n  } as UseInfiniteDataResult<T, E>;\n}\n\nfunction fetchData<T>(\n  endpoint: string,\n  params: GetDatatableDataParams,\n  transformResponse?: UseInfiniteDataProps<T>['transformResponse']\n): Promise<Response<T>> {\n  return apiClient.get(endpoint, {params}).then(r => {\n    if (transformResponse) {\n      return transformResponse(r.data);\n    }\n    return r.data;\n  });\n}\n","import {useInfiniteData} from '@common/ui/infinite-scroll/use-infinite-data';\nimport {Reviewable} from '@app/reviews/reviewable';\nimport {Review} from '@app/titles/models/review';\nimport {useLocalStorage} from '@common/utils/hooks/local-storage';\nimport {useSearchParams} from 'react-router-dom';\n\nexport interface UseReviewAdditionalData {\n  current_user_review?: Review;\n  shared_review?: Review;\n}\n\nexport function reviewsQueryKey(\n  reviewable?: Reviewable,\n  params?: Record<string, any>\n) {\n  const key: any[] = ['reviews'];\n  if (reviewable) {\n    key.push(`${reviewable.id}-${reviewable.model_type}`);\n  }\n  if (params) {\n    key.push(params);\n  }\n  return key;\n}\n\nexport function useReviews(reviewable: Reviewable) {\n  const [searchParams] = useSearchParams();\n  const [sort] = useLocalStorage(\n    `reviewSort.${reviewable.model_type}`,\n    'created_at:desc'\n  );\n  const [defaultOrderBy, defaultOrderDir] = sort.split(':');\n  return useInfiniteData<Review, UseReviewAdditionalData>({\n    willSortOrFilter: true,\n    queryKey: reviewsQueryKey(reviewable, {sort}),\n    endpoint: 'reviewable/reviews',\n    defaultOrderBy,\n    defaultOrderDir: defaultOrderDir as 'asc' | 'desc',\n    queryParams: {\n      reviewable_type: reviewable.model_type,\n      reviewable_id: reviewable.id,\n      perPage: 5,\n      sharedReviewId: searchParams.get('reviewId'),\n    },\n  });\n}\n","import {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {useMutation} from '@tanstack/react-query';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/utils/http/show-http-error-toast';\nimport {reviewsQueryKey} from '@app/reviews/requests/use-reviews';\n\ninterface Response extends BackendResponse {\n  //\n}\n\ninterface Payload {\n  reviewIds: number[];\n}\n\nexport function useDeleteReviews() {\n  return useMutation((payload: Payload) => deleteReviews(payload), {\n    onSuccess: async () => {\n      await queryClient.invalidateQueries(reviewsQueryKey());\n    },\n    onError: r => showHttpErrorToast(r),\n  });\n}\n\nfunction deleteReviews({reviewIds}: Payload): Promise<Response> {\n  return apiClient.delete(`reviews/${reviewIds.join(',')}`).then(r => r.data);\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const StarIcon = createSvgIcon(\n  <path d=\"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27z\" />\n, 'StarOutlined');\n","import {StarIcon} from '@common/icons/material/Star';\nimport clsx from 'clsx';\n\ninterface Props {\n  score: number | null;\n  className?: string;\n}\nexport function TitleRating({score, className}: Props) {\n  if (!score) return null;\n  return (\n    <div\n      className={clsx(\n        'flex items-center gap-4 flex-shrink-0 whitespace-nowrap',\n        className\n      )}\n    >\n      <StarIcon className=\"text-primary\" />\n      <span>{score} / 10</span>\n    </div>\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const StarBorderIcon = createSvgIcon(\n  <path d=\"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z\" />\n, 'StarBorderOutlined');\n","import {useState} from 'react';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {StarIcon} from '@common/icons/material/Star';\nimport {StarBorderIcon} from '@common/icons/material/StarBorder';\nimport clsx from 'clsx';\nimport {useIsMobileMediaQuery} from '@common/utils/hooks/is-mobile-media-query';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\n\ninterface Props {\n  count: number;\n  value: number;\n  onValueChange?: (value: number) => void;\n  className?: string;\n  readonly?: boolean;\n}\nexport function StarSelector({\n  count,\n  value,\n  onValueChange,\n  className,\n  readonly,\n}: Props) {\n  const isMobile = useIsMobileMediaQuery();\n  const [hoverRating, setHoverRating] = useState(value);\n  const {trans} = useTrans();\n  return (\n    <div\n      className={clsx('flex items-center', className)}\n      onPointerLeave={() => {\n        if (!readonly) {\n          setHoverRating(value);\n        }\n      }}\n    >\n      {Array.from({length: count}).map((_, i) => {\n        const number = i + 1;\n        const isActive = hoverRating >= number;\n        return (\n          <IconButton\n            key={i}\n            size={isMobile ? 'xs' : 'sm'}\n            aria-label={trans(\n              message('Rate :count stars', {values: {count: number}})\n            )}\n            iconSize=\"md\"\n            color={isActive ? 'primary' : undefined}\n            disabled={readonly}\n            onClick={() => {\n              onValueChange?.(number);\n            }}\n            onPointerEnter={() => {\n              setHoverRating(number);\n            }}\n          >\n            {isActive ? <StarIcon /> : <StarBorderIcon />}\n          </IconButton>\n        );\n      })}\n    </div>\n  );\n}\n","import React, {Children, Fragment, ReactNode} from 'react';\nimport clsx from 'clsx';\n\ninterface BulletSeparatedItemsProps {\n  children: ReactNode;\n  className?: string;\n}\n\nexport function BulletSeparatedItems({\n  children,\n  className,\n}: BulletSeparatedItemsProps) {\n  const items = Children.toArray(children);\n  return (\n    <div className={clsx('flex items-center gap-4 overflow-hidden', className)}>\n      {items.map((child, index) => (\n        <Fragment key={index}>\n          <div>{child}</div>\n          {index < items.length - 1 ? <div>&bull;</div> : null}\n        </Fragment>\n      ))}\n    </div>\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const SortIcon = createSvgIcon(\n  <path d=\"M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z\" />\n, 'SortOutlined');\n","import {message} from '@common/i18n/message';\nimport {\n  Menu,\n  MenuItem,\n  MenuTrigger,\n} from '@common/ui/navigation/menu/menu-trigger';\nimport {Button, ButtonProps} from '@common/ui/buttons/button';\nimport {SortIcon} from '@common/icons/material/Sort';\nimport {Trans} from '@common/i18n/trans';\n\nconst SortOptions = [\n  {\n    value: 'created_at:desc',\n    label: message('Newest'),\n  },\n  {\n    value: 'created_at:asc',\n    label: message('Oldest'),\n  },\n  {\n    value: 'mostHelpful',\n    label: message('Most helpful'),\n  },\n  {\n    value: 'reports_count:desc',\n    label: message('Most reported'),\n  },\n];\n\ninterface Props {\n  value: string;\n  onValueChange: (newValue: string) => void;\n  color?: ButtonProps['color'];\n  showReportsItem?: boolean;\n}\nexport function ReviewListSortButton({\n  value,\n  onValueChange,\n  color,\n  showReportsItem,\n}: Props) {\n  let selectedOption = SortOptions.find(option => option.value === value);\n  if (!selectedOption) {\n    selectedOption = SortOptions[0];\n  }\n  return (\n    <MenuTrigger\n      selectedValue={value}\n      onSelectionChange={newValue => onValueChange(newValue as string)}\n      selectionMode=\"single\"\n    >\n      <Button variant=\"outline\" startIcon={<SortIcon />} color={color}>\n        <Trans {...selectedOption.label} />\n      </Button>\n      <Menu>\n        {SortOptions.filter(\n          option => option.value !== 'reports_count:desc' || showReportsItem\n        ).map(option => (\n          <MenuItem value={option.value} key={option.value}>\n            <Trans {...option.label} />\n          </MenuItem>\n        ))}\n      </Menu>\n    </MenuTrigger>\n  );\n}\n","import {Link, LinkProps} from 'react-router-dom';\nimport clsx from 'clsx';\nimport React, {ReactNode} from 'react';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\n\nexport interface BaseMediaLinkProps extends Omit<LinkProps, 'to' | 'title'> {\n  link: string;\n  className?: string;\n  children?: ReactNode;\n  color?: 'primary' | 'inherit';\n  displayContents?: boolean;\n}\nexport function BaseMediaLink({\n  link,\n  className,\n  children,\n  color = 'inherit',\n  displayContents,\n  ...linkProps\n}: BaseMediaLinkProps) {\n  const baseClassName = displayContents\n    ? 'contents'\n    : clsx(\n        color === 'primary'\n          ? 'text-primary hover:text-primary-dark'\n          : 'text-inherit',\n        'hover:underline outline-none focus-visible:underline overflow-x-hidden overflow-ellipsis transition-colors'\n      );\n  return (\n    <Link {...linkProps} className={clsx(baseClassName, className)} to={link}>\n      {children}\n    </Link>\n  );\n}\n\nexport function getBaseMediaLink(\n  link: string,\n  {absolute}: {absolute?: boolean} = {}\n): string {\n  if (absolute) {\n    link = `${getBootstrapData().settings.base_url}${link}`;\n  }\n  return link;\n}\n","import React, {useMemo} from 'react';\nimport {Title} from '@app/titles/models/title';\nimport {getTitleLink} from '@app/titles/title-link';\nimport {Trans} from '@common/i18n/trans';\nimport {BaseMediaLink, BaseMediaLinkProps} from '@app/base-media-link';\n\nexport interface SeasonLinkProps extends Omit<BaseMediaLinkProps, 'link'> {\n  title: Title;\n  seasonNumber: number;\n}\nexport function SeasonLink({\n  title,\n  seasonNumber,\n  children,\n  color = 'inherit',\n  ...linkProps\n}: SeasonLinkProps) {\n  const link = useMemo(() => {\n    return getSeasonLink(title, seasonNumber);\n  }, [title, seasonNumber]);\n\n  return (\n    <BaseMediaLink {...linkProps} link={link}>\n      {children ?? (\n        <Trans message=\"Season :number\" values={{number: seasonNumber}} />\n      )}\n    </BaseMediaLink>\n  );\n}\n\nexport function getSeasonLink(\n  title: Title,\n  seasonNumber: number | string,\n  {absolute}: {absolute?: boolean} = {}\n): string {\n  const titleLink = getTitleLink(title, {absolute});\n  return `${titleLink}/season/${seasonNumber}`;\n}\n","import React, {useMemo} from 'react';\nimport {Title} from '@app/titles/models/title';\nimport {getSeasonLink, SeasonLinkProps} from '@app/seasons/season-link';\nimport {Episode} from '@app/titles/models/episode';\nimport {BaseMediaLink} from '@app/base-media-link';\n\ninterface Props extends Omit<SeasonLinkProps, 'seasonNumber'> {\n  episodeNumber?: number;\n  seasonNumber?: number;\n  episode?: Episode;\n}\nexport function EpisodeLink({\n  title,\n  seasonNumber,\n  episodeNumber,\n  episode,\n  children,\n  color = 'inherit',\n  ...linkProps\n}: Props) {\n  const link = useMemo(() => {\n    return getEpisodeLink(\n      title,\n      seasonNumber || episode?.episode_number || 1,\n      episodeNumber || episode?.episode_number || 1\n    );\n  }, [title, seasonNumber, episodeNumber, episode]);\n\n  return (\n    <BaseMediaLink {...linkProps} link={link}>\n      {children ?? <span>{episode?.name}</span>}\n    </BaseMediaLink>\n  );\n}\n\nexport function getEpisodeLink(\n  title: Title,\n  seasonNumber: number | string,\n  episodeNumber: number | string,\n  {absolute}: {absolute?: boolean} = {}\n): string {\n  const seasonLink = getSeasonLink(title, seasonNumber, {absolute});\n  return `${seasonLink}/episode/${episodeNumber}`;\n}\n","import {Episode} from '@app/titles/models/episode';\nimport {Trans} from '@common/i18n/trans';\n\ninterface Props {\n  episode?: Episode;\n  seasonNum?: number;\n  episodeNum?: number;\n  className?: string;\n}\nexport function CompactSeasonEpisode({\n  episode,\n  seasonNum,\n  episodeNum,\n  className,\n}: Props) {\n  if (!seasonNum && episode) {\n    seasonNum = episode.season_number;\n  }\n  if (!episodeNum && episode) {\n    episodeNum = episode.episode_number;\n  }\n\n  if (seasonNum && episodeNum) {\n    return (\n      <span className={className}>\n        <Trans\n          message=\"s:seasone:episode\"\n          values={{\n            season: prefixWithZero(seasonNum),\n            episode: prefixWithZero(episodeNum),\n          }}\n        />\n      </span>\n    );\n  }\n\n  if (seasonNum) {\n    return (\n      <span className={className}>\n        <Trans\n          message=\"s:season\"\n          values={{\n            season: prefixWithZero(seasonNum),\n          }}\n        />\n      </span>\n    );\n  }\n\n  if (episodeNum) {\n    return (\n      <span className={className}>\n        <Trans\n          message=\"e:episode\"\n          values={{\n            episode: prefixWithZero(episodeNum),\n          }}\n        />\n      </span>\n    );\n  }\n\n  return null;\n}\n\nfunction prefixWithZero(value: number): string {\n  return value < 10 ? `0${value}` : `${value}`;\n}\n","import React, {useMemo} from 'react';\nimport {slugifyString} from '@common/utils/string/slugify-string';\nimport {Title} from '@app/titles/models/title';\nimport {\n  BaseMediaLink,\n  BaseMediaLinkProps,\n  getBaseMediaLink,\n} from '@app/base-media-link';\nimport {getEpisodeLink} from '@app/episodes/episode-link';\nimport {getSeasonLink} from '@app/seasons/season-link';\nimport {Episode} from '@app/titles/models/episode';\nimport {CompactSeasonEpisode} from '@app/episodes/compact-season-episode';\n\ninterface Props extends Omit<BaseMediaLinkProps, 'link'> {\n  title: Title;\n}\nexport function TitleLink({title, children, ...linkProps}: Props) {\n  const link = useMemo(() => {\n    return getTitleLink(title);\n  }, [title]);\n\n  return (\n    <BaseMediaLink {...linkProps} link={link}>\n      {children ?? title.name}\n    </BaseMediaLink>\n  );\n}\n\ninterface WithEpisodeProps extends Props {\n  episode: Episode;\n}\nexport function TitleLinkWithEpisodeNumber({\n  title,\n  episode,\n  children,\n  ...linkProps\n}: WithEpisodeProps) {\n  const link = useMemo(() => {\n    return getEpisodeLink(title, episode.season_number, episode.episode_number);\n  }, [title, episode]);\n\n  return (\n    <BaseMediaLink {...linkProps} link={link}>\n      {title.name} (<CompactSeasonEpisode episode={episode} />)\n    </BaseMediaLink>\n  );\n}\n\ninterface Options {\n  absolute?: boolean;\n  season?: number | string;\n  episode?: number | string;\n}\n\nexport function getTitleLink(\n  title: Title,\n  {absolute, season, episode}: Options = {}\n): string {\n  if (episode && season) {\n    return getEpisodeLink(title, season, episode, {absolute});\n  } else if (season) {\n    return getSeasonLink(title, season, {absolute});\n  }\n  return getBaseMediaLink(`/titles/${title.id}/${slugifyString(title.name)}`, {\n    absolute,\n  });\n}\n","import {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\nimport {Video} from '@app/titles/models/video';\n\nexport function getWatchLink(\n  video: Video,\n  {absolute}: {absolute?: boolean} = {}\n): string {\n  let link = `/watch/${video.id}`;\n  if (absolute) {\n    link = `${getBootstrapData().settings.base_url}${link}`;\n  }\n  return link;\n}\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaPlayIcon = createSvgIcon(\n  <path d=\"M10.6667 6.6548C10.6667 6.10764 11.2894 5.79346 11.7295 6.11862L24.377 15.4634C24.7377 15.7298 24.7377 16.2692 24.3771 16.5357L11.7295 25.8813C11.2895 26.2065 10.6667 25.8923 10.6667 25.3451L10.6667 6.6548Z\"/>,\n  'MediaPlay',\n  '0 0 32 32'\n);\n","import {useTrans} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\nimport clsx from 'clsx';\nimport {Title} from '@app/titles/models/title';\nimport {TitleLink} from '@app/titles/title-link';\nimport {ImageSize, useImageSrc} from '@app/images/use-image-src';\nimport {Link} from 'react-router-dom';\nimport {getWatchLink} from '@app/videos/watch-page/get-watch-link';\nimport {MediaPlayIcon} from '@common/icons/media/media-play';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {Fragment} from 'react';\nimport {MovieIcon} from '@common/icons/material/Movie';\n\ninterface Props {\n  title: Title;\n  className?: string;\n  size?: string;\n  lazy?: boolean;\n  srcSize?: ImageSize;\n  aspect?: string;\n  showPlayButton?: boolean;\n  link?: string;\n}\nexport function TitlePoster({\n  title,\n  className,\n  size = 'w-full',\n  srcSize,\n  lazy = true,\n  aspect = 'aspect-poster',\n  showPlayButton,\n  link,\n}: Props) {\n  const {trans} = useTrans();\n  const src = useImageSrc(title?.poster, {size: srcSize});\n  if (!title.primary_video) {\n    showPlayButton = false;\n  }\n\n  const imageClassName = clsx(\n    'h-full w-full rounded bg-fg-base/4 object-cover',\n    !src ? 'flex items-center justify-center' : 'block'\n  );\n\n  const image = src ? (\n    <img\n      className={imageClassName}\n      decoding=\"async\"\n      draggable={false}\n      loading={lazy ? 'lazy' : 'eager'}\n      src={src}\n      alt={trans(message('Poster for :name', {values: {name: title.name}}))}\n    />\n  ) : (\n    <span className={imageClassName}>\n      <MovieIcon className=\"max-w-[60%] text-divider\" size=\"text-6xl\" />\n    </span>\n  );\n\n  const linkChildren = (\n    <Fragment>\n      {image}\n      <span className=\"pointer-events-none absolute inset-0 block bg-black opacity-0 transition-opacity group-hover:opacity-10\" />\n    </Fragment>\n  );\n\n  return (\n    <div\n      className={clsx(size, aspect, className, 'group relative flex-shrink-0')}\n    >\n      {link ? (\n        <Link to={link} className=\"contents\">\n          {linkChildren}\n        </Link>\n      ) : (\n        <TitleLink title={title} displayContents>\n          {linkChildren}\n        </TitleLink>\n      )}\n      {showPlayButton ? (\n        <div className=\"absolute bottom-14 left-14\">\n          <IconButton\n            color=\"white\"\n            variant=\"flat\"\n            className=\"shadow-md\"\n            elementType={Link}\n            to={getWatchLink(title.primary_video)}\n            aria-label={`Play ${title.name}`}\n          >\n            <MediaPlayIcon />\n          </IconButton>\n        </div>\n      ) : null}\n    </div>\n  );\n}\n","import {Skeleton} from '@common/ui/skeleton/skeleton';\nimport {MediaPlayIcon} from '@common/icons/media/media-play';\nimport React from 'react';\n\ninterface Props {\n  animate?: boolean;\n}\nexport function VideoPlayerSkeleton({animate}: Props) {\n  return (\n    <div className=\"relative\">\n      <Skeleton\n        variant=\"rect\"\n        className=\"aspect-video\"\n        animation={animate ? 'pulsate' : null}\n      />\n      <MediaPlayIcon\n        className=\"absolute inset-0 m-auto text-fg-base/40\"\n        size=\"w-80 h-80\"\n      />\n    </div>\n  );\n}\n","import {MediaItem} from '@common/player/media-item';\n\nconst hlsRegex = /\\.(m3u8)($|\\?)/i;\nconst dashRegex = /\\.(mpd)($|\\?)/i;\nconst audioRegex =\n  /\\.(m4a|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\\?)/i;\nconst youtubeUrlRegex =\n  /(?:youtu\\.be|youtube|youtube\\.com|youtube-nocookie\\.com)\\/(?:embed\\/|v\\/|watch\\?v=|watch\\?.+&v=|)((?:\\w|-){11})/;\nconst youtubeIdRegex = /^((?:\\w|-){11})$/;\nexport function guessPlayerProvider(src: string): MediaItem['provider'] {\n  if (youtubeUrlRegex.test(src) || youtubeIdRegex.test(src)) {\n    return 'youtube';\n  } else if (audioRegex.test(src)) {\n    return 'htmlAudio';\n  } else if (hlsRegex.test(src)) {\n    return 'hls';\n  } else if (dashRegex.test(src)) {\n    return 'dash';\n  } else {\n    return 'htmlVideo';\n  }\n}\n","export function shuffleArray(items: any[], keepFirst = false) {\n  let first = keepFirst ? items.shift() : null;\n\n  let currentIndex = items.length,\n    temporaryValue,\n    randomIndex;\n\n  while (0 !== currentIndex) {\n    randomIndex = Math.floor(Math.random() * currentIndex);\n    currentIndex -= 1;\n\n    temporaryValue = items[currentIndex];\n    items[currentIndex] = items[randomIndex];\n    items[randomIndex] = temporaryValue;\n  }\n\n  if (first) {\n    items.unshift(first);\n  }\n\n  return [...items];\n}\n","import {getFromLocalStorage} from '@common/utils/hooks/local-storage';\nimport {PlayerStoreOptions} from '@common/player/state/player-store-options';\nimport {PlayerState} from '@common/player/state/player-state';\n\nexport interface PersistablePlayerState {\n  muted?: PlayerState['muted'];\n  repeat?: PlayerState['repeat'];\n  shuffling?: PlayerState['shuffling'];\n  volume?: PlayerState['volume'];\n}\n\nexport interface PlayerInitialData {\n  state?: PersistablePlayerState;\n  queue?: PlayerState['originalQueue'];\n  cuedMediaId?: string | number;\n}\n\nexport function getPlayerStateFromLocalStorage(\n  id: string | number,\n  options?: PlayerStoreOptions\n): PlayerInitialData {\n  const defaultVolume = options?.defaultVolume || 30;\n  return {\n    state: {\n      muted: getFromLocalStorage(`player.${id}.muted`) ?? false,\n      repeat: getFromLocalStorage(`player.${id}.repeat`) ?? 'all',\n      shuffling: getFromLocalStorage(`player.${id}.shuffling`) ?? false,\n      volume: getFromLocalStorage(`player.${id}.volume`) ?? defaultVolume,\n    },\n    queue: getFromLocalStorage(`player.${id}.queue`, []),\n    cuedMediaId: getFromLocalStorage(`player.${id}.cuedMediaId`),\n  };\n}\n","export function prependToArrayAtIndex<T>(array: T[], toAdd: T[], index = 0): T[] {\n  const copyOfArray = [...array];\n  const tail = copyOfArray.splice(index + 1);\n  return [...copyOfArray, ...toAdd, ...tail];\n}\n","export function resetMediaSession() {\n  if ('mediaSession' in navigator) {\n    const actionHandlers: MediaSessionAction[] = [\n      'play',\n      'pause',\n      'previoustrack',\n      'nexttrack',\n      'stop',\n      'seekbackward',\n      'seekforward',\n      'seekto',\n    ];\n    actionHandlers.forEach(action =>\n      navigator.mediaSession.setActionHandler(action, null)\n    );\n    navigator.mediaSession.metadata = null;\n    navigator.mediaSession.playbackState = 'none';\n  }\n}\n","import {MediaItem} from '@common/player/media-item';\nimport {PlayerState} from '@common/player/state/player-state';\n\nexport function playerQueue(state: () => PlayerState) {\n  const getPointer = (): number => {\n    if (state().cuedMedia) {\n      return (\n        state().shuffledQueue.findIndex(\n          item => item.id === state().cuedMedia?.id\n        ) || 0\n      );\n    }\n    return 0;\n  };\n  const getCurrent = (): MediaItem | undefined => {\n    return state().shuffledQueue[getPointer()];\n  };\n  const getFirst = (): MediaItem | undefined => {\n    return state().shuffledQueue[0];\n  };\n  const getLast = (): MediaItem | undefined => {\n    return state().shuffledQueue[state().shuffledQueue.length - 1];\n  };\n  const getNext = (): MediaItem | undefined => {\n    return state().shuffledQueue[getPointer() + 1];\n  };\n  const getPrevious = (): MediaItem | undefined => {\n    return state().shuffledQueue[getPointer() - 1];\n  };\n  const isLast = (): boolean => {\n    return getPointer() === state().originalQueue.length - 1;\n  };\n\n  return {\n    getPointer,\n    getCurrent,\n    getFirst,\n    getLast,\n    getNext,\n    getPrevious,\n    isLast,\n  };\n}\n","import {PlayerState} from '@common/player/state/player-state';\nimport {isCtrlOrShiftPressed} from '@common/utils/keybinds/is-ctrl-or-shift-pressed';\n\nexport function handlePlayerKeybinds(\n  e: KeyboardEvent,\n  state: () => PlayerState\n) {\n  if (\n    ['input', 'textarea'].includes(\n      (e.target as HTMLElement)?.tagName.toLowerCase()\n    )\n  )\n    return;\n\n  if (e.key === ' ' || e.key === 'k') {\n    e.preventDefault();\n    if (state().isPlaying) {\n      state().pause();\n    } else {\n      state().play();\n    }\n  }\n\n  if (e.key === 'ArrowRight' && isCtrlOrShiftPressed(e)) {\n    e.preventDefault();\n    state().playNext();\n  }\n\n  if (e.key === 'ArrowLeft' && isCtrlOrShiftPressed(e)) {\n    e.preventDefault();\n    state().playPrevious();\n  }\n}\n","import {Optional} from 'utility-types';\nimport {PlayerState} from '@common/player/state/player-state';\nimport {PlayerStoreOptions} from '@common/player/state/player-store-options';\n\nexport function initPlayerMediaSession(\n  state: () => PlayerState,\n  options: PlayerStoreOptions\n) {\n  if ('mediaSession' in navigator) {\n    const actionHandlers: Optional<\n      Record<MediaSessionAction, MediaSessionActionHandler>\n    > = {\n      play: () => state().play(),\n      pause: () => state().pause(),\n      previoustrack: () => state().playPrevious(),\n      nexttrack: () => state().playNext(),\n      stop: () => state().stop(),\n      seekbackward: () => state().seek(state().getCurrentTime() - 10),\n      seekforward: () => state().seek(state().getCurrentTime() + 10),\n      seekto: details => state().seek(details.seekTime || 0),\n    };\n    for (const key in actionHandlers) {\n      try {\n        navigator.mediaSession.setActionHandler(\n          key as MediaSessionAction,\n          actionHandlers[key as MediaSessionAction]!\n        );\n      } catch (error) {}\n    }\n    const cuedMedia = state().cuedMedia;\n    if (cuedMedia) {\n      options.setMediaSessionMetadata?.(cuedMedia);\n    }\n  }\n}\n","import {MediaItem} from '@common/player/media-item';\n\nexport function isSameMedia(a?: MediaItem, b?: MediaItem): boolean {\n  if (!a || !b) return false;\n  return a.id === b.id && a.groupId === b.groupId;\n}\n","export class ScreenOrientation {\n  protected currentLock: OrientationLockType | undefined;\n\n  async lock(lockType: OrientationLockType = 'landscape') {\n    if (!this.canOrientScreen() || this.currentLock) return;\n    try {\n      await screen.orientation.lock(lockType);\n      this.currentLock = lockType;\n    } catch (e) {}\n  }\n\n  async unlock() {\n    if (!this.canOrientScreen() || !this.currentLock) return;\n    await screen.orientation.unlock();\n  }\n\n  canOrientScreen(): boolean {\n    return (\n      screen.orientation != null &&\n      !!screen.orientation.lock &&\n      !!screen.orientation.unlock\n    );\n  }\n}\n","export const IS_CLIENT = typeof window !== 'undefined';\nexport const UA = IS_CLIENT ? window.navigator?.userAgent.toLowerCase() : '';\nexport const IS_IOS = /iphone|ipad|ipod|ios|CriOS|FxiOS/.test(UA);\nexport const IS_ANDROID = /android/.test(UA);\nexport const IS_MOBILE = IS_CLIENT && (IS_IOS || IS_ANDROID);\nexport const IS_IPHONE =\n  IS_CLIENT && /(iPhone|iPod)/gi.test(window.navigator?.platform);\nexport const IS_FIREFOX = /firefox/.test(UA);\n// @ts-ignore\nexport const IS_CHROME = IS_CLIENT && window.chrome;\nexport const IS_SAFARI =\n  IS_CLIENT &&\n  !IS_CHROME &&\n  // @ts-ignore\n  (window.safari || IS_IOS || /(apple|safari)/.test(UA));\n","var key = {\r\n    fullscreenEnabled: 0,\r\n    fullscreenElement: 1,\r\n    requestFullscreen: 2,\r\n    exitFullscreen: 3,\r\n    fullscreenchange: 4,\r\n    fullscreenerror: 5,\r\n    fullscreen: 6\r\n};\r\nvar webkit = [\r\n    'webkitFullscreenEnabled',\r\n    'webkitFullscreenElement',\r\n    'webkitRequestFullscreen',\r\n    'webkitExitFullscreen',\r\n    'webkitfullscreenchange',\r\n    'webkitfullscreenerror',\r\n    '-webkit-full-screen',\r\n];\r\nvar moz = [\r\n    'mozFullScreenEnabled',\r\n    'mozFullScreenElement',\r\n    'mozRequestFullScreen',\r\n    'mozCancelFullScreen',\r\n    'mozfullscreenchange',\r\n    'mozfullscreenerror',\r\n    '-moz-full-screen',\r\n];\r\nvar ms = [\r\n    'msFullscreenEnabled',\r\n    'msFullscreenElement',\r\n    'msRequestFullscreen',\r\n    'msExitFullscreen',\r\n    'MSFullscreenChange',\r\n    'MSFullscreenError',\r\n    '-ms-fullscreen',\r\n];\r\n// so it doesn't throw if no window or document\r\nvar document = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\r\nvar vendor = (('fullscreenEnabled' in document && Object.keys(key)) ||\r\n    (webkit[0] in document && webkit) ||\r\n    (moz[0] in document && moz) ||\r\n    (ms[0] in document && ms) ||\r\n    []);\r\nvar fscreen = {\r\n    requestFullscreen: function (element) { return element[vendor[key.requestFullscreen]](); },\r\n    requestFullscreenFunction: function (element) { return element[vendor[key.requestFullscreen]]; },\r\n    get exitFullscreen() { return document[vendor[key.exitFullscreen]].bind(document); },\r\n    get fullscreenPseudoClass() { return \":\" + vendor[key.fullscreen]; },\r\n    addEventListener: function (type, handler, options) { return document.addEventListener(vendor[key[type]], handler, options); },\r\n    removeEventListener: function (type, handler, options) { return document.removeEventListener(vendor[key[type]], handler, options); },\r\n    get fullscreenEnabled() { return Boolean(document[vendor[key.fullscreenEnabled]]); },\r\n    set fullscreenEnabled(val) { },\r\n    get fullscreenElement() { return document[vendor[key.fullscreenElement]]; },\r\n    set fullscreenElement(val) { },\r\n    get onfullscreenchange() { return document[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()]; },\r\n    set onfullscreenchange(handler) { return document[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()] = handler; },\r\n    get onfullscreenerror() { return document[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()]; },\r\n    set onfullscreenerror(handler) { return document[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()] = handler; },\r\n};\n\nexport default fscreen;\n//# sourceMappingURL=fscreen.esm.js.map\n","import {FullscreenAdapter} from '@common/player/state/fullscreen/fullscreen-adapter';\nimport fscreen from 'fscreen';\n\nexport function createNativeFullscreenAdapter(\n  host: HTMLElement,\n  onChange: () => void\n): FullscreenAdapter {\n  host = host.closest('.fullscreen-host') ?? host;\n  return {\n    isFullscreen: () => {\n      if (fscreen.fullscreenElement === host) return true;\n      try {\n        // Throws in iOS Safari...\n        return host.matches(\n          // @ts-expect-error - `fullscreenPseudoClass` is missing from `@types/fscreen`.\n          fscreen.fullscreenPseudoClass\n        );\n      } catch (error) {\n        return false;\n      }\n    },\n    canFullScreen: () => {\n      return fscreen.fullscreenEnabled;\n    },\n    enter: () => {\n      return fscreen.requestFullscreen(host);\n    },\n    exit: () => {\n      return fscreen.exitFullscreen();\n    },\n    bindEvents: () => {\n      fscreen.addEventListener('fullscreenchange', onChange);\n      fscreen.addEventListener('fullscreenerror', onChange);\n    },\n    unbindEvents: () => {\n      fscreen.removeEventListener('fullscreenchange', onChange);\n      fscreen.removeEventListener('fullscreenerror', onChange);\n    },\n  };\n}\n","import {FullscreenAdapter} from '@common/player/state/fullscreen/fullscreen-adapter';\nimport {IS_IPHONE} from '@common/utils/platform';\n\nexport function createIphoneFullscreenAdapter(\n  host: HTMLVideoElement,\n  onChange: () => void\n): FullscreenAdapter {\n  return {\n    /**\n     * @link https://developer.apple.com/documentation/webkitjs/htmlvideoelement/1631913-webkitpresentationmode\n     */\n    isFullscreen: () => {\n      return host.webkitPresentationMode === 'fullscreen';\n    },\n    /**\n     * @link https://developer.apple.com/documentation/webkitjs/htmlvideoelement/1628805-webkitsupportsfullscreen\n     */\n    canFullScreen: () => {\n      return (\n        IS_IPHONE &&\n        typeof host.webkitSetPresentationMode === 'function' &&\n        (host.webkitSupportsFullscreen ?? false)\n      );\n    },\n    enter: () => {\n      return host.webkitSetPresentationMode?.('fullscreen');\n    },\n    exit: () => {\n      return host.webkitSetPresentationMode?.('inline');\n    },\n    bindEvents: () => {\n      host.removeEventListener('webkitpresentationmodechanged', onChange);\n    },\n    unbindEvents: () => {\n      host.addEventListener('webkitpresentationmodechanged', onChange);\n    },\n  };\n}\n","import {StateCreator} from 'zustand';\nimport {\n  PlayerState,\n  ProviderListeners,\n} from '@common/player/state/player-state';\nimport {ScreenOrientation} from '@common/player/state/fullscreen/screen-orientation';\nimport {IS_IPHONE} from '@common/utils/platform';\nimport {FullscreenAdapter} from '@common/player/state/fullscreen/fullscreen-adapter';\nimport {createNativeFullscreenAdapter} from '@common/player/state/fullscreen/create-native-fullscreen-adapter';\nimport {createIphoneFullscreenAdapter} from '@common/player/state/fullscreen/create-iphone-fullscreen-adapter';\nimport {PipSlice} from '@common/player/state/pip/pip-slice';\n\nexport interface FullscreenSlice {\n  isFullscreen: boolean;\n  canFullscreen: boolean;\n  enterFullscreen: () => void;\n  exitFullscreen: () => void;\n  toggleFullscreen: () => void;\n  initFullscreen: () => void;\n  destroyFullscreen: () => void;\n}\n\ntype BaseSliceCreator = StateCreator<\n  FullscreenSlice & PlayerState & PipSlice,\n  [['zustand/immer', unknown]],\n  [],\n  FullscreenSlice\n>;\n\ntype StoreLice = BaseSliceCreator extends (...a: infer U) => infer R\n  ? (...a: [...U, Set<Partial<ProviderListeners>>]) => R\n  : never;\n\nconst iPhoneProviderBlacklist = ['youtube'];\n\nexport const createFullscreenSlice: StoreLice = (set, get) => {\n  let subscription: () => void | undefined;\n  const orientation = new ScreenOrientation();\n  let adapter: FullscreenAdapter | undefined;\n\n  const onFullscreenChange = async () => {\n    const isFullscreen = adapter?.isFullscreen();\n    if (isFullscreen) {\n      // lock orientation to landscape\n      orientation.lock();\n    } else {\n      orientation.unlock();\n    }\n    set({isFullscreen});\n  };\n\n  const isSupported = (): boolean => {\n    // iPhone only allows putting video element in fullscreen, and\n    // there's no way to get access to it with YouTube iframe api\n    if (IS_IPHONE && iPhoneProviderBlacklist.includes(get().providerName!)) {\n      return false;\n    }\n    return adapter?.canFullScreen() ?? false;\n  };\n\n  return {\n    isFullscreen: false,\n    canFullscreen: false,\n    enterFullscreen: () => {\n      if (!isSupported() || adapter?.isFullscreen()) return;\n\n      // exit pip if it's active\n      if (get().isPip) {\n        get().exitPip();\n      }\n      return adapter?.enter();\n    },\n    exitFullscreen: () => {\n      if (!adapter?.isFullscreen()) return;\n      return adapter.exit();\n    },\n    toggleFullscreen: () => {\n      if (get().isFullscreen) {\n        get().exitFullscreen();\n      } else {\n        get().enterFullscreen();\n      }\n    },\n    initFullscreen: () => {\n      subscription = get().subscribe({\n        providerReady: ({el}) => {\n          // when changing adapters, remove previous adapter events and exit fullscreen\n          adapter?.unbindEvents();\n          if (get().isFullscreen) {\n            adapter?.exit();\n          }\n          // create new adapter, and if fullscreen is supported, bind events\n          adapter = IS_IPHONE\n            ? createIphoneFullscreenAdapter(\n                el as HTMLVideoElement,\n                onFullscreenChange\n              )\n            : createNativeFullscreenAdapter(el, onFullscreenChange);\n          const canFullscreen = isSupported();\n          set({canFullscreen});\n          if (canFullscreen) {\n            adapter.bindEvents();\n          }\n        },\n      });\n    },\n    destroyFullscreen: () => {\n      get().exitFullscreen();\n      subscription?.();\n    },\n  };\n};\n","import {PipAdapter} from '@common/player/state/pip/pip-adapter';\nimport {IS_CLIENT} from '@common/utils/platform';\n\nexport const createChromePipAdapter = (\n  host: HTMLVideoElement,\n  onChange: () => void\n): PipAdapter => {\n  return {\n    isSupported: () => canUsePiPInChrome(),\n    isPip: () => {\n      return host === document.pictureInPictureElement;\n    },\n    enter: () => {\n      if (canUsePiPInChrome()) {\n        return host.requestPictureInPicture();\n      }\n    },\n    exit: () => {\n      if (canUsePiPInChrome()) {\n        return document.exitPictureInPicture();\n      }\n    },\n    bindEvents: () => {\n      if (canUsePiPInChrome()) {\n        host.addEventListener('enterpictureinpicture', onChange);\n        host.addEventListener('leavepictureinpicture', onChange);\n      }\n    },\n    unbindEvents: () => {\n      if (canUsePiPInChrome()) {\n        host.removeEventListener('enterpictureinpicture', onChange);\n        host.removeEventListener('leavepictureinpicture', onChange);\n      }\n    },\n  };\n};\n\n/**\n * Checks if the native HTML5 video player can enter picture-in-picture (PIP) mode when using\n * the Chrome browser.\n *\n * @see  https://developers.google.com/web/updates/2018/10/watch-video-using-picture-in-picture\n */\nlet _canUsePiPInChrome: boolean | undefined;\nconst canUsePiPInChrome = (): boolean => {\n  if (!IS_CLIENT) return false;\n  if (_canUsePiPInChrome == null) {\n    const video = document.createElement('video');\n    _canUsePiPInChrome =\n      !!document.pictureInPictureEnabled && !video.disablePictureInPicture;\n  }\n  return _canUsePiPInChrome;\n};\n","import {PipAdapter} from '@common/player/state/pip/pip-adapter';\nimport {IS_CLIENT, IS_IPHONE} from '@common/utils/platform';\n\nexport const createSafariPipAdapter = (\n  host: HTMLVideoElement,\n  onChange: () => void\n): PipAdapter => {\n  return {\n    isSupported: () => canUsePiPInSafari(),\n    isPip: () => {\n      return host.webkitPresentationMode === 'picture-in-picture';\n    },\n    enter: () => {\n      if (canUsePiPInSafari()) {\n        return host.webkitSetPresentationMode?.('picture-in-picture');\n      }\n    },\n    exit: () => {\n      if (canUsePiPInSafari()) {\n        return host.webkitSetPresentationMode?.('inline');\n      }\n    },\n    bindEvents: () => {\n      if (canUsePiPInSafari()) {\n        host.addEventListener('webkitpresentationmodechanged', onChange);\n      }\n    },\n    unbindEvents: () => {\n      if (canUsePiPInSafari()) {\n        host.removeEventListener('webkitpresentationmodechanged', onChange);\n      }\n    },\n  };\n};\n\n/**\n * Checks if the native HTML5 video player can enter picture-in-picture (PIP) mode when using\n * the desktop Safari browser, iOS Safari appears to \"support\" PiP through the check, however PiP\n * does not function.\n *\n * @see https://developer.apple.com/documentation/webkitjs/adding_picture_in_picture_to_your_safari_media_controls\n */\nlet _canUsePiPInSafari: boolean | undefined;\nconst canUsePiPInSafari = (): boolean => {\n  if (!IS_CLIENT) return false;\n  const video = document.createElement('video');\n  if (_canUsePiPInSafari == null) {\n    _canUsePiPInSafari =\n      // @ts-ignore\n      !!video.webkitSupportsPresentationMode &&\n      // @ts-ignore\n      !!video.webkitSetPresentationMode &&\n      !IS_IPHONE;\n  }\n  return _canUsePiPInSafari;\n};\n","import {StateCreator} from 'zustand';\nimport {\n  PlayerState,\n  ProviderListeners,\n} from '@common/player/state/player-state';\nimport {PipAdapter} from '@common/player/state/pip/pip-adapter';\nimport {createChromePipAdapter} from '@common/player/state/pip/chrome-pip-adapter';\nimport {createSafariPipAdapter} from '@common/player/state/pip/safari-pip-adapter';\n\nexport interface PipSlice {\n  isPip: boolean;\n  canPip: boolean;\n  enterPip: () => void;\n  exitPip: () => void;\n  togglePip: () => void;\n  initPip: () => void;\n  destroyPip: () => void;\n}\n\ntype BaseSliceCreator = StateCreator<\n  PipSlice & PlayerState,\n  [['zustand/immer', unknown]],\n  [],\n  PipSlice\n>;\n\ntype StoreLice = BaseSliceCreator extends (...a: infer U) => infer R\n  ? (...a: [...U, Set<Partial<ProviderListeners>>]) => R\n  : never;\n\nconst adapterFactories = [createChromePipAdapter, createSafariPipAdapter];\n\nexport const createPipSlice: StoreLice = (set, get) => {\n  let subscription: () => void | undefined;\n  let adapters: PipAdapter[] = [];\n\n  const onPipChange = () => {\n    set({isPip: adapters.some(a => a.isPip())});\n  };\n\n  const isSupported = (): boolean => {\n    if (get().providerName !== 'htmlVideo') {\n      return false;\n    }\n    return adapters.some(adapter => adapter.isSupported());\n  };\n\n  return {\n    isPip: false,\n    canPip: false,\n    enterPip: async () => {\n      if (get().isPip || !isSupported()) return;\n      await adapters.find(a => a.isSupported())?.enter();\n    },\n    exitPip: async () => {\n      if (!get().isPip) return;\n      await adapters.find(a => a.isSupported())?.exit();\n    },\n    togglePip: () => {\n      if (get().isPip) {\n        get().exitPip();\n      } else {\n        get().enterPip();\n      }\n    },\n    initPip: () => {\n      subscription = get().subscribe({\n        providerReady: ({el}) => {\n          // when changing adapters, remove previous adapter events and exit pip\n          adapters.every(a => a.unbindEvents());\n          if (get().isPip) {\n            adapters.every(a => a.exit());\n          }\n          // create new adapters, and if pip is supported on at least one, bind events\n          adapters = adapterFactories.map(factory =>\n            factory(el as HTMLVideoElement, onPipChange)\n          );\n          const canPip = isSupported();\n          if (canPip) {\n            adapters.every(a => a.bindEvents());\n          }\n          set({canPip});\n        },\n      });\n    },\n    destroyPip: () => {\n      get().exitPip();\n      subscription?.();\n    },\n  };\n};\n","import {createStore} from 'zustand';\nimport {immer} from 'zustand/middleware/immer';\nimport {MediaItem} from '@common/player/media-item';\nimport {setInLocalStorage as _setInLocalStorage} from '@common/utils/hooks/local-storage';\nimport {shuffleArray} from '@common/utils/array/shuffle-array';\nimport {PlayerStoreOptions} from '@common/player/state/player-store-options';\nimport {getPlayerStateFromLocalStorage} from '@common/player/utils/player-local-storage';\nimport {prependToArrayAtIndex} from '@common/utils/array/prepend-to-array-at-index';\nimport deepMerge from 'deepmerge';\nimport {resetMediaSession} from '@common/player/utils/reset-media-session';\nimport {playerQueue} from '@common/player/player-queue';\nimport type {\n  PlayerState,\n  ProviderListeners,\n  RepeatMode,\n} from '@common/player/state/player-state';\nimport {handlePlayerKeybinds} from '@common/player/handle-player-keybinds';\nimport {initPlayerMediaSession} from '@common/player/utils/init-player-media-session';\nimport {isSameMedia} from '@common/player/utils/is-same-media';\nimport {\n  createFullscreenSlice,\n  FullscreenSlice,\n} from '@common/player/state/fullscreen/fullscreen-slice';\nimport {createPipSlice, PipSlice} from '@common/player/state/pip/pip-slice';\nimport {subscribeWithSelector} from 'zustand/middleware';\n\nexport const createPlayerStore = (\n  id: string | number,\n  options: PlayerStoreOptions\n) => {\n  // initialData from options should take priority over local storage data\n  const initialData = deepMerge(\n    getPlayerStateFromLocalStorage(id, options),\n    options.initialData || {}\n  );\n\n  const setInLocalStorage = (key: string, value: any) => {\n    _setInLocalStorage(`player.${id}.${key}`, value);\n  };\n\n  return createStore<PlayerState & FullscreenSlice & PipSlice>()(\n    subscribeWithSelector(\n      immer((set, get, store) => {\n        const listeners = new Set<Partial<ProviderListeners>>();\n        const internalListeners: Partial<ProviderListeners> = {\n          play: () => {\n            set(s => {\n              s.isPlaying = true;\n              s.playbackStarted = true;\n            });\n          },\n          pause: () => {\n            set(s => {\n              s.isPlaying = false;\n              s.controlsVisible = true;\n            });\n          },\n          error: () => {\n            set(s => {\n              s.isPlaying = false;\n            });\n          },\n          durationChange: payload => {\n            set({mediaDuration: payload.duration});\n          },\n          streamTypeChange: payload => {\n            set({streamType: payload.streamType});\n          },\n          buffered: payload => {\n            //\n          },\n          playbackRateChange: payload => {\n            set({playbackRate: payload.rate});\n          },\n          playbackRates: ({rates}) => {\n            set({playbackRates: rates});\n          },\n          playbackQualities: ({qualities}) => {\n            set({playbackQualities: qualities});\n          },\n          playbackQualityChange: ({quality}) => {\n            set({playbackQuality: quality});\n          },\n          textTracks: ({tracks}) => {\n            set({textTracks: tracks});\n          },\n          currentTextTrackChange: ({trackId}) => {\n            set({currentTextTrack: trackId});\n          },\n          textTrackVisibilityChange: ({isVisible}) => {\n            set({textTrackIsVisible: isVisible});\n          },\n          buffering: ({isBuffering}) => {\n            set({isBuffering});\n          },\n          playbackEnd: async () => {\n            const media = get().cuedMedia;\n\n            // don't play next or repeat while seeking via seekbar\n            if (get().isSeeking) return;\n            if (queue.isLast() && options.loadMoreMediaItems) {\n              const items = await options.loadMoreMediaItems(media);\n              if (items?.length) {\n                get().appendToQueue(items);\n              }\n            }\n            get().playNext();\n          },\n          posterLoaded: ({url}) => {\n            set({posterUrl: url});\n          },\n          providerReady: () => {\n            const provider = get().providerApi;\n            if (provider) {\n              provider.setVolume(get().volume);\n              provider.setMuted(get().muted);\n              if (options.autoPlay) {\n                provider.play();\n              }\n              set({providerReady: true});\n            }\n          },\n        };\n\n        const queue = playerQueue(get);\n\n        const keybindsHandler = (e: KeyboardEvent) => {\n          handlePlayerKeybinds(e, get);\n        };\n\n        const initialQueue = initialData.queue || [];\n        return {\n          options,\n          ...createFullscreenSlice(set, get, store, listeners),\n          ...createPipSlice(set, get, store, listeners),\n          originalQueue: initialQueue,\n          shuffledQueue: initialData.state?.shuffling\n            ? shuffleArray(initialQueue)\n            : initialQueue,\n          isPlaying: false,\n          isBuffering: false,\n          streamType: null,\n          playbackStarted: false,\n          providerReady: false,\n          pauseWhileSeeking: options.pauseWhileSeeking ?? true,\n          isSeeking: false,\n          setIsSeeking: (isSeeking: boolean) => {\n            set({isSeeking});\n          },\n          controlsVisible: true,\n          setControlsVisible: (isVisible: boolean) => {\n            set(s => {\n              s.controlsVisible = isVisible;\n            });\n          },\n          volume: initialData.state?.volume ?? 30,\n          setVolume: value => {\n            get().providerApi?.setVolume(value);\n            set(s => {\n              s.volume = value;\n            });\n            setInLocalStorage('volume', value);\n          },\n          muted: initialData.state?.muted ?? false,\n          setMuted: isMuted => {\n            get().providerApi?.setMuted(isMuted);\n            set(s => {\n              s.muted = isMuted;\n            });\n            setInLocalStorage('muted', isMuted);\n          },\n          playbackRates: [],\n          playbackRate: 1,\n          setPlaybackRate: speed => {\n            get().providerApi?.setPlaybackRate(speed);\n          },\n          playbackQuality: 'auto',\n          setPlaybackQuality: quality => {\n            get().providerApi?.setPlaybackQuality?.(quality);\n          },\n          playbackQualities: [],\n          repeat: initialData.state?.repeat ?? 'all',\n          toggleRepeatMode: () => {\n            let newRepeat: RepeatMode = 'all';\n            const currentRepeat = get().repeat;\n            if (currentRepeat === 'all') {\n              newRepeat = 'one';\n            } else if (currentRepeat === 'one') {\n              newRepeat = false;\n            }\n\n            set({repeat: newRepeat});\n            setInLocalStorage('repeat', newRepeat);\n          },\n          shuffling: initialData.state?.shuffling ?? false,\n          toggleShuffling: () => {\n            let newQueue: MediaItem[] = [];\n\n            if (get().shuffling) {\n              newQueue = get().originalQueue;\n            } else {\n              newQueue = shuffleArray([...get().shuffledQueue]);\n            }\n\n            set(s => {\n              s.shuffling = !s.shuffling;\n              s.shuffledQueue = newQueue;\n            });\n          },\n          mediaDuration: 0,\n          seek: time => {\n            const timeStr = `${time}`;\n            if (timeStr.startsWith('+')) {\n              time = get().getCurrentTime() + Number(time);\n            } else if (timeStr.startsWith('-')) {\n              time = get().getCurrentTime() - Number(timeStr.replace('-', ''));\n            } else {\n              time = Number(time);\n            }\n            get().providerApi?.seek(time);\n            get().emit('seek', {time});\n          },\n          getCurrentTime: () => {\n            return get().providerApi?.getCurrentTime() || 0;\n          },\n          play: async media => {\n            // get currently active queue item, if none is provided\n            if (media) {\n              await get().cue(media);\n            } else {\n              media = get().cuedMedia || queue.getCurrent();\n            }\n            // if no media to play, stop player and bail\n            if (!media) {\n              get().stop();\n              return;\n            }\n            await options.onBeforePlay?.();\n            await get().providerApi?.play();\n          },\n          pause: () => {\n            get().providerApi?.pause();\n          },\n          stop: () => {\n            if (!get().isPlaying) return;\n            get().pause();\n            get().seek(0);\n          },\n          playNext: async () => {\n            get().stop();\n            let media = queue.getCurrent();\n\n            if (get().repeat === 'all' && queue.isLast()) {\n              media = queue.getFirst();\n            } else if (get().repeat !== 'one') {\n              media = queue.getNext();\n            }\n\n            // allow user to handle playing next track\n            if (options.onBeforePlayNext?.(media)) {\n              return;\n            }\n\n            if (media) {\n              await get().play(media);\n            } else {\n              get().seek(0);\n              get().play();\n            }\n          },\n          playPrevious: async () => {\n            get().stop();\n            let media = queue.getCurrent();\n\n            if (get().repeat === 'all' && queue.getPointer() === 0) {\n              media = queue.getLast();\n            } else if (get().repeat !== 'one') {\n              media = queue.getPrevious();\n            }\n\n            // allow user to handle playing previous track\n            if (options.onBeforePlayPrevious?.(media)) {\n              return;\n            }\n\n            if (media) {\n              await get().play(media);\n            } else {\n              get().seek(0);\n              get().play();\n            }\n          },\n          cue: async media => {\n            if (isSameMedia(media, get().cuedMedia)) return;\n\n            get().emit('beforeCued', {previous: get().cuedMedia});\n\n            return new Promise((resolve, reject) => {\n              const previousProvider = get().providerName;\n\n              // wait until media is cued on provider or 3 seconds\n              const timeoutId = setTimeout(() => {\n                unsubscribe();\n                resolve();\n              }, 3000);\n              const unsubscribe = get().subscribe({\n                cued: () => {\n                  clearTimeout(timeoutId);\n                  unsubscribe();\n                  resolve();\n                },\n                error: () => {\n                  clearTimeout(timeoutId);\n                  unsubscribe();\n                  reject('Could not cue media');\n                },\n              });\n\n              set({\n                cuedMedia: media,\n                posterUrl: media.poster,\n                providerName: media.provider,\n                providerReady: previousProvider === media.provider,\n                streamType: 'streamType' in media ? media.streamType : null,\n              });\n\n              if (media) {\n                options.setMediaSessionMetadata?.(media);\n              }\n\n              if (options.persistQueueInLocalStorage) {\n                setInLocalStorage('cuedMediaId', media.id);\n              }\n            });\n          },\n          async overrideQueue(\n            mediaItems: MediaItem[],\n            queuePointer: number = 0\n          ): Promise<any> {\n            if (!mediaItems?.length) return;\n            const items = [...mediaItems];\n            set(s => {\n              s.shuffledQueue = get().shuffling\n                ? shuffleArray(items, true)\n                : items;\n              s.originalQueue = items;\n            });\n            if (options.persistQueueInLocalStorage) {\n              setInLocalStorage('queue', get().originalQueue.slice(0, 15));\n            }\n            const media =\n              queuePointer > -1 ? mediaItems[queuePointer] : queue.getCurrent();\n            if (media) {\n              return get().cue(media);\n            }\n          },\n          appendToQueue: (mediaItems, afterCuedMedia = true) => {\n            const shuffledNewItems = get().shuffling\n              ? shuffleArray([...mediaItems])\n              : [...mediaItems];\n            const index = afterCuedMedia ? queue.getPointer() : 0;\n            set(s => {\n              s.shuffledQueue = prependToArrayAtIndex(\n                s.shuffledQueue,\n                shuffledNewItems,\n                index\n              );\n              s.originalQueue = prependToArrayAtIndex(\n                s.originalQueue,\n                mediaItems,\n                index\n              );\n            });\n            if (options.persistQueueInLocalStorage) {\n              setInLocalStorage('queue', get().originalQueue.slice(0, 15));\n            }\n          },\n          removeFromQueue: mediaItems => {\n            set(s => {\n              s.shuffledQueue = s.shuffledQueue.filter(\n                item => !mediaItems.find(m => isSameMedia(m, item))\n              );\n              s.originalQueue = s.originalQueue.filter(\n                item => !mediaItems.find(m => isSameMedia(m, item))\n              );\n            });\n            if (options.persistQueueInLocalStorage) {\n              setInLocalStorage('queue', get().originalQueue.slice(0, 15));\n            }\n          },\n          textTracks: [],\n          currentTextTrack: -1,\n          setCurrentTextTrack: trackId => {\n            get().providerApi?.setCurrentTextTrack?.(trackId);\n          },\n          textTrackIsVisible: false,\n          setTextTrackVisibility: isVisible => {\n            get().providerApi?.setTextTrackVisibility?.(isVisible);\n          },\n          destroy: () => {\n            get().destroyFullscreen();\n            get().destroyPip();\n            options?.onDestroy?.();\n            resetMediaSession();\n            listeners.clear();\n            document.removeEventListener('keydown', keybindsHandler);\n          },\n          init: async () => {\n            // add initial and listeners from options, these will be present for the entire lifetime of the player\n            get().initFullscreen();\n\n            listeners.add(internalListeners);\n            if (options.listeners) {\n              listeners.add(options.listeners as Partial<ProviderListeners>);\n            }\n\n            const mediaId =\n              initialData.cuedMediaId || initialData.queue?.[0]?.id;\n            const mediaToCue = initialData.queue?.find(\n              media => media.id === mediaId\n            );\n            if (mediaToCue) {\n              await get().cue(mediaToCue);\n            }\n            initPlayerMediaSession(get, options);\n            document.addEventListener('keydown', keybindsHandler);\n          },\n          subscribe: newListeners => {\n            listeners.add(newListeners);\n            return () => listeners.delete(newListeners);\n          },\n          emit(event, payload?: any) {\n            listeners.forEach(l => l[event]?.({state: get(), ...payload}));\n          },\n        };\n      })\n    )\n  );\n};\n","import {createContext, ReactNode, useState} from 'react';\nimport {createPlayerStore} from '@common/player/state/player-store';\nimport {PlayerStoreOptions} from '@common/player/state/player-store-options';\nimport type {PlayerStoreApi} from '@common/player/state/player-state';\n\nexport const PlayerStoreContext = createContext<PlayerStoreApi>(null!);\n\ninterface PlayerContextProps {\n  children: ReactNode;\n  id: string | number;\n  options: PlayerStoreOptions;\n}\nexport function PlayerContext({children, id, options}: PlayerContextProps) {\n  //lazily create store object only once\n  const [store] = useState(() => {\n    return createPlayerStore(id, options);\n  });\n\n  return (\n    <PlayerStoreContext.Provider value={store}>\n      {children}\n    </PlayerStoreContext.Provider>\n  );\n}\n","/**\n * @see https://developers.google.com/youtube/iframe_api_reference#Playback_controls\n */\nexport const enum YoutubeCommand {\n  Play = 'playVideo',\n  Pause = 'pauseVideo',\n  Stop = 'stopVideo',\n  Seek = 'seekTo',\n  Cue = 'cueVideoById',\n  CueAndPlay = 'loadVideoById',\n  Mute = 'mute',\n  Unmute = 'unMute',\n  SetVolume = 'setVolume',\n  SetPlaybackRate = 'setPlaybackRate',\n  SetPlaybackQuality = 'setPlaybackQuality',\n}\n\nexport interface YouTubeCommandArg {\n  [YoutubeCommand.Play]: void;\n  [YoutubeCommand.Pause]: void;\n  [YoutubeCommand.Stop]: void;\n  [YoutubeCommand.Seek]: number;\n  [YoutubeCommand.Cue]: string;\n  [YoutubeCommand.CueAndPlay]: string;\n  [YoutubeCommand.Mute]: void;\n  [YoutubeCommand.Unmute]: void;\n  [YoutubeCommand.SetVolume]: number;\n  [YoutubeCommand.SetPlaybackRate]: number;\n  [YoutubeCommand.SetPlaybackQuality]: string;\n}\n\n/**\n * @see https://developers.google.com/youtube/iframe_api_reference#onStateChange\n */\nexport const enum YouTubePlayerState {\n  Unstarted = -1,\n  Ended = 0,\n  Playing = 1,\n  Paused = 2,\n  Buffering = 3,\n  Cued = 5,\n}\n\nexport interface YoutubeInternalState {\n  duration: number;\n  currentTime: number;\n  videoId?: string;\n  lastTimeUpdate: number;\n  playbackRate: number;\n  playbackReady: boolean;\n  buffered: number;\n  state: YouTubePlayerState;\n  firedPlaybackEnd: boolean;\n}\n\nexport const enum YouTubePlaybackQuality {\n  Unknown = 'unknown',\n  Tiny = 'tiny',\n  Small = 'small',\n  Medium = 'medium',\n  Large = 'large',\n  Hd720 = 'hd720',\n  Hd1080 = 'hd1080',\n  Highres = 'highres',\n  Max = 'max',\n}\n\nexport interface YouTubeMessage {\n  channel: string;\n  event: 'initialDelivery' | 'onReady' | 'infoDelivery' | 'apiInfoDelivery';\n  info?: YoutubeMessageInfo;\n}\n\nexport interface YoutubeMessageInfo {\n  availablePlaybackRates?: number[];\n  availableQualityLevels?: YouTubePlaybackQuality[];\n  currentTime?: number;\n  currentTimeLastUpdated?: number;\n  videoLoadedFraction?: number;\n  volume?: number;\n  videoUrl?: string;\n  videoData?: {\n    author: string;\n    title: string;\n    video_id: string;\n    errorCode?: string;\n  };\n  duration?: number;\n  muted?: boolean;\n  playbackQuality?: YouTubePlaybackQuality;\n  playbackRate?: number;\n  playerState?: YouTubePlayerState;\n}\n\nexport interface YoutubeProviderError {\n  code?: string;\n  videoId?: string;\n}\n\nexport interface YoutubeProviderInternalApi {\n  loadVideoById: (videoId: string) => void;\n}\n","export function isNumber(value: any): value is number {\n  return typeof value === 'number' && !Number.isNaN(value);\n}\n","/**\n * Load image avoiding xhr/fetch CORS issues. Server status can't be obtained this way\n * unfortunately, so this uses \"naturalWidth\" to determine if the image has been loaded. By\n * default, it checks if it is at least 1px.\n */\nexport const loadImage = (\n  src: string,\n  minWidth = 1\n): Promise<HTMLImageElement> =>\n  new Promise((resolve, reject) => {\n    const image = new Image();\n    const handler = () => {\n      // @ts-expect-error\n      delete image.onload;\n      // @ts-expect-error\n      delete image.onerror;\n      if (image.naturalWidth >= minWidth) {\n        resolve(image);\n      } else {\n        reject('Could not load youtube image');\n      }\n    };\n    Object.assign(image, {onload: handler, onerror: handler, src});\n  });\n","import {loadImage} from '@common/utils/http/load-image';\n\nconst posterCache = new Map<string, string>();\n\nexport async function loadYoutubePoster(\n  videoId: string\n): Promise<string | undefined> {\n  if (!videoId) return;\n  if (posterCache.has(videoId)) {\n    return posterCache.get(videoId);\n  }\n\n  const posterURL = (quality: string) =>\n    `https://i.ytimg.com/vi/${videoId}/${quality}.jpg`;\n\n  /**\n   * We are testing that the image has a min-width of 121px because if the thumbnail does not\n   * exist YouTube returns a blank/error image that is 120px wide.\n   */\n  return loadImage(posterURL('maxresdefault'), 121) // 1080p (no padding)\n    .catch(() => loadImage(posterURL('sddefault'), 121)) // 640p (padded 4:3)\n    .catch(() => loadImage(posterURL('hqdefault'), 121)) // 480p (padded 4:3)\n    .catch(() => {})\n    .then(img => {\n      if (!img) return;\n      const poster = img.src;\n      posterCache.set(videoId, poster);\n      return poster;\n    });\n}\n","import {\n  YoutubeInternalState,\n  YouTubeMessage,\n  YoutubeMessageInfo,\n  YouTubePlayerState,\n  YoutubeProviderError,\n} from '@common/player/providers/youtube/youtube-types';\nimport {MutableRefObject, RefObject} from 'react';\nimport {PlayerStoreApi} from '@common/player/state/player-state';\nimport {isNumber} from '@common/utils/number/is-number';\nimport {loadYoutubePoster} from '@common/player/providers/youtube/load-youtube-poster';\n\nexport function handleYoutubeEmbedMessage(\n  e: MessageEvent,\n  internalStateRef: MutableRefObject<YoutubeInternalState>,\n  iframeRef: RefObject<HTMLIFrameElement>,\n  store: PlayerStoreApi\n) {\n  const data = (\n    typeof e.data === 'string' ? JSON.parse(e.data) : e.data\n  ) as YouTubeMessage;\n  const info = data.info;\n  const internalState = internalStateRef.current;\n  const emit = store.getState().emit;\n  if (!info) return;\n\n  if (info.videoData?.video_id) {\n    internalState.videoId = info.videoData.video_id;\n  }\n\n  if (info.videoData?.errorCode) {\n    const event: YoutubeProviderError = {\n      code: info.videoData.errorCode,\n      videoId: internalState.videoId,\n    };\n    emit('error', {sourceEvent: event});\n  }\n\n  if (isNumber(info.duration) && info.duration !== internalState.duration) {\n    internalState.duration = info.duration;\n    emit('durationChange', {duration: internalState.duration});\n  }\n\n  if (\n    isNumber(info.currentTime) &&\n    info.currentTime !== internalState.currentTime\n  ) {\n    internalState.currentTime = info.currentTime;\n    // don't fire progress events while seeking via seekbar\n    if (!store.getState().isSeeking) {\n      emit('progress', {currentTime: internalState.currentTime});\n    }\n  }\n\n  if (isNumber(info.currentTimeLastUpdated)) {\n    internalState.lastTimeUpdate = info.currentTimeLastUpdated;\n  }\n\n  if (isNumber(info.playbackRate)) {\n    if (internalState.playbackRate !== info.playbackRate) {\n      emit('playbackRateChange', {rate: info.playbackRate});\n    }\n    internalState.playbackRate = info.playbackRate;\n  }\n\n  if (isNumber(info.videoLoadedFraction)) {\n    const buffered = info.videoLoadedFraction * internalState.duration;\n    if (internalState.buffered !== buffered) {\n      emit('buffered', {\n        seconds: info.videoLoadedFraction * internalState.duration,\n      });\n    }\n    internalState.buffered = buffered;\n  }\n\n  if (Array.isArray(info.availablePlaybackRates)) {\n    emit('playbackRates', {rates: info.availablePlaybackRates});\n  }\n\n  if (isNumber(info.playerState)) {\n    onYoutubeStateChange(info, internalStateRef, iframeRef, store);\n    internalState.state = info.playerState;\n  }\n}\n\nfunction onYoutubeStateChange(\n  info: YoutubeMessageInfo,\n  internalStateRef: MutableRefObject<YoutubeInternalState>,\n  iframeRef: RefObject<HTMLIFrameElement>,\n  store: PlayerStoreApi\n) {\n  const emit = store.getState().emit;\n  const state = info.playerState!;\n\n  const onCued = async () => {\n    // load poster, if needed\n    if (info.videoData?.video_id && !store.getState().cuedMedia?.poster) {\n      const url = await loadYoutubePoster(info.videoData.video_id);\n      if (url) {\n        store.getState().emit('posterLoaded', {url});\n      }\n    }\n\n    // mark provider as ready\n    if (!internalStateRef.current.playbackReady) {\n      emit('providerReady', {el: iframeRef.current!});\n      internalStateRef.current.playbackReady = true;\n    }\n    emit('cued');\n  };\n\n  emit('youtubeStateChange', {state});\n  emit('buffering', {isBuffering: state === YouTubePlayerState.Buffering});\n\n  if (state !== YouTubePlayerState.Ended) {\n    internalStateRef.current.firedPlaybackEnd = false;\n  }\n\n  switch (state) {\n    case YouTubePlayerState.Unstarted:\n      // When using autoplay, but autoplay fails, player will get \"unstarted\" event\n      onCued();\n      break;\n    case YouTubePlayerState.Ended:\n      // will sometimes fire twice without this, if player starts buffering as a result of seek to the end\n      if (!internalStateRef.current.firedPlaybackEnd) {\n        emit('playbackEnd');\n        internalStateRef.current.firedPlaybackEnd = true;\n      }\n      break;\n    case YouTubePlayerState.Playing:\n      // When using autoplay, \"cued\" event is never fired, handle \"cued\" here instead\n      onCued();\n      emit('play');\n      break;\n    case YouTubePlayerState.Paused:\n      emit('pause');\n      break;\n    case YouTubePlayerState.Cued:\n      onCued();\n      break;\n  }\n}\n","import {StoreApi, useStore} from 'zustand';\nimport {useContext} from 'react';\nimport {PlayerStoreContext} from '@common/player/player-context';\nimport {PlayerState} from '@common/player/state/player-state';\nimport {FullscreenSlice} from '@common/player/state/fullscreen/fullscreen-slice';\nimport {PipSlice} from '@common/player/state/pip/pip-slice';\n\ntype ExtractState<S> = S extends {\n  getState: () => infer T;\n}\n  ? T\n  : never;\n\ntype UsePlayerStore = {\n  (): ExtractState<StoreApi<PlayerState>>;\n  <U>(\n    selector: (\n      state: ExtractState<StoreApi<PlayerState & FullscreenSlice & PipSlice>>\n    ) => U,\n    equalityFn?: (a: U, b: U) => boolean\n  ): U;\n};\n\n// @ts-ignore\nexport const usePlayerStore: UsePlayerStore = (selector, equalityFn) => {\n  const store = useContext(PlayerStoreContext);\n  return useStore(store, selector, equalityFn);\n};\n","import {useContext, useMemo} from 'react';\nimport {PlayerStoreContext} from '@common/player/player-context';\nimport {MediaItem} from '@common/player/media-item';\n\nexport type PlayerActions = ReturnType<typeof usePlayerActions>;\n\nexport function usePlayerActions() {\n  const store = useContext(PlayerStoreContext);\n\n  return useMemo(() => {\n    const s = store.getState();\n\n    const overrideQueueAndPlay = async (\n      mediaItems: MediaItem[],\n      queuePointer?: number\n    ) => {\n      s.stop();\n      await s.overrideQueue(mediaItems, queuePointer);\n      return s.play();\n    };\n\n    return {\n      play: s.play,\n      playNext: s.playNext,\n      playPrevious: s.playPrevious,\n      pause: s.pause,\n      subscribe: s.subscribe,\n      emit: s.emit,\n      getCurrentTime: s.getCurrentTime,\n      seek: s.seek,\n      toggleRepeatMode: s.toggleRepeatMode,\n      toggleShuffling: s.toggleShuffling,\n      getState: store.getState,\n      setVolume: s.setVolume,\n      setMuted: s.setMuted,\n      appendToQueue: s.appendToQueue,\n      removeFromQueue: s.removeFromQueue,\n      enterFullscreen: s.enterFullscreen,\n      exitFullscreen: s.exitFullscreen,\n      toggleFullscreen: s.toggleFullscreen,\n      enterPip: s.enterPip,\n      exitPip: s.exitPip,\n      setTextTrackVisibility: s.setTextTrackVisibility,\n      setCurrentTextTrack: s.setCurrentTextTrack,\n      setIsSeeking: s.setIsSeeking,\n      setControlsVisible: s.setControlsVisible,\n      cue: s.cue,\n      overrideQueueAndPlay,\n      overrideQueue: s.overrideQueue,\n      setPlaybackRate: s.setPlaybackRate,\n      setPlaybackQuality: s.setPlaybackQuality,\n    };\n  }, [store]);\n}\n","export function youtubeIdFromSrc(src: string) {\n  return src.match(/((?:\\w|-){11})/)?.[0];\n}\n","import {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {useCallback, useEffect, useState} from 'react';\nimport {YoutubeMediaItem} from '@common/player/media-item';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {youtubeIdFromSrc} from '@common/player/utils/youtube-id-from-src';\n\nconst queryString =\n  '&controls=0&disablekb=1&enablejsapi=1&iv_load_policy=3&modestbranding=1&playsinline=1&rel=0&showinfo=0';\n\nexport function useYoutubeProviderSrc(\n  loadVideoById: (videoId: string) => void\n) {\n  const {getState, emit} = usePlayerActions();\n  const options = usePlayerStore(s => s.options);\n  const media = usePlayerStore(s => s.cuedMedia) as\n    | YoutubeMediaItem\n    | undefined;\n\n  const origin = options.youtube?.useCookies\n    ? 'https://www.youtube.com'\n    : 'https://www.youtube-nocookie.com';\n\n  const [initialVideoId, setInitialVideoId] = useState(() => {\n    if (media?.src && media.src !== 'resolve') {\n      return youtubeIdFromSrc(media.src);\n    }\n  });\n\n  const updateVideoIds = useCallback(\n    (src: string) => {\n      const videoId = youtubeIdFromSrc(src);\n      if (!videoId) return;\n\n      // use setState callback, so we don't need to use \"initialVideoId\" in the dependency array\n      setInitialVideoId(prevId => {\n        if (!prevId) {\n          return videoId;\n        } else {\n          // changing src of iframe will cause it to fully reload, use \"loadVideoById\" api method instead\n          loadVideoById(videoId);\n          return prevId;\n        }\n      });\n    },\n    [loadVideoById]\n  );\n\n  useEffect(() => {\n    if (media?.src && media.src !== 'resolve') {\n      updateVideoIds(media.src);\n    } else if (media) {\n      emit('buffering', {isBuffering: true});\n      options.youtube?.srcResolver?.(media).then(item => {\n        // check if resolved media matches the one currently in the store to prevent race conditions.\n        // check against current value in store, because this callback will close over old value\n        if (item?.src && getState().cuedMedia?.id === item.id) {\n          updateVideoIds(item.src);\n        }\n      });\n    }\n    // only update when media id changes to prevent infinite loops\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [options, updateVideoIds, media?.id]);\n\n  return {\n    initialVideoUrl: initialVideoId\n      ? `${origin}/embed/${initialVideoId}?${queryString}&autoplay=${\n          options.autoPlay ? '1' : '0'\n        }&mute=${getState().muted ? '1' : '0'}&start=${media?.initialTime ?? 0}`\n      : undefined,\n    origin,\n  };\n}\n","import {useGlobalListeners} from '@react-aria/utils';\nimport {useCallback, useContext, useEffect, useRef} from 'react';\nimport {PlayerStoreContext} from '@common/player/player-context';\nimport {\n  YoutubeCommand,\n  YouTubeCommandArg,\n  YoutubeInternalState,\n  YoutubeProviderInternalApi,\n} from '@common/player/providers/youtube/youtube-types';\nimport {handleYoutubeEmbedMessage} from '@common/player/providers/youtube/handle-youtube-embed-message';\nimport {useYoutubeProviderSrc} from '@common/player/providers/youtube/use-youtube-provider-src';\n\nexport function YoutubeProvider() {\n  const {addGlobalListener, removeAllGlobalListeners} = useGlobalListeners();\n  const iframeRef = useRef<HTMLIFrameElement>(null);\n\n  const youtubeApi = useCallback(\n    <T extends keyof YouTubeCommandArg>(\n      command: T,\n      arg?: YouTubeCommandArg[T]\n    ) =>\n      iframeRef.current?.contentWindow?.postMessage(\n        JSON.stringify({\n          event: 'command',\n          func: command,\n          args: arg ? [arg] : undefined,\n        }),\n        '*'\n      ),\n    []\n  );\n\n  const loadVideoById = useCallback(\n    (videoId: string) => {\n      // using \"YoutubeCommand.Cue\" does not play video when changing sources,\n      // it requires double click on play button without this\n      youtubeApi(YoutubeCommand.CueAndPlay, videoId);\n    },\n    [youtubeApi]\n  );\n\n  const {initialVideoUrl, origin} = useYoutubeProviderSrc(loadVideoById);\n  const store = useContext(PlayerStoreContext);\n\n  const internalStateRef = useRef<YoutubeInternalState>({\n    duration: 0,\n    currentTime: 0,\n    lastTimeUpdate: 0,\n    playbackRate: 1,\n    state: -1,\n    playbackReady: false,\n    buffered: 0,\n    firedPlaybackEnd: false,\n  });\n\n  const registerApi = useCallback(() => {\n    const internalProviderApi: YoutubeProviderInternalApi = {\n      loadVideoById,\n    };\n    store.setState({\n      providerApi: {\n        play: () => {\n          youtubeApi(YoutubeCommand.Play);\n        },\n        pause: () => {\n          youtubeApi(YoutubeCommand.Pause);\n        },\n        stop: () => {\n          youtubeApi(YoutubeCommand.Stop);\n        },\n        seek: (time: number) => {\n          if (time !== internalStateRef.current.currentTime) {\n            youtubeApi(YoutubeCommand.Seek, time);\n          }\n        },\n        setVolume: (volume: number) => {\n          youtubeApi(YoutubeCommand.SetVolume, volume);\n        },\n        setMuted: (muted: boolean) => {\n          if (muted) {\n            youtubeApi(YoutubeCommand.Mute);\n          } else {\n            youtubeApi(YoutubeCommand.Unmute);\n          }\n        },\n        setPlaybackRate: (value: number) => {\n          youtubeApi(YoutubeCommand.SetPlaybackRate, value);\n        },\n        setPlaybackQuality: (value: string) => {\n          youtubeApi(YoutubeCommand.SetPlaybackQuality, value);\n        },\n        getCurrentTime: () => {\n          return internalStateRef.current.currentTime;\n        },\n        getSrc: () => {\n          return internalStateRef.current.videoId;\n        },\n        internalProviderApi,\n      },\n    });\n  }, [store, loadVideoById, youtubeApi]);\n\n  useEffect(() => {\n    addGlobalListener(window, 'message', event => {\n      const e = event as MessageEvent;\n      if (\n        e.origin === origin &&\n        e.source === iframeRef.current?.contentWindow\n      ) {\n        handleYoutubeEmbedMessage(e, internalStateRef, iframeRef, store);\n      }\n    });\n\n    registerApi();\n\n    return () => {\n      removeAllGlobalListeners();\n    };\n  }, [addGlobalListener, removeAllGlobalListeners, store, origin, registerApi]);\n\n  if (!initialVideoUrl) {\n    return null;\n  }\n\n  return (\n    <iframe\n      className=\"w-full h-full\"\n      ref={iframeRef}\n      src={initialVideoUrl}\n      allowFullScreen\n      allow=\"autoplay; encrypted-media; picture-in-picture;\"\n      onLoad={() => {\n        // window does not receive \"message\" events on safari without waiting a small amount of time for some reason\n        setTimeout(() => {\n          iframeRef.current?.contentWindow?.postMessage(\n            JSON.stringify({event: 'listening'}),\n            '*'\n          );\n          registerApi();\n        });\n      }}\n    />\n  );\n}\n","export function createRafLoop(callback: () => void) {\n  let id: number | undefined;\n\n  function start() {\n    // Time updates are already in progress.\n    if (!isUndefined(id)) return;\n    loop();\n  }\n\n  function loop() {\n    id = window.requestAnimationFrame(function rafLoop() {\n      if (isUndefined(id)) return;\n      callback();\n      loop();\n    });\n  }\n\n  function stop() {\n    if (isNumber(id)) window.cancelAnimationFrame(id);\n    id = undefined;\n  }\n\n  return {\n    start,\n    stop,\n  };\n}\n\nfunction isUndefined(value: unknown): value is undefined {\n  return typeof value === 'undefined';\n}\n\nfunction isNumber(value: any): value is number {\n  return typeof value === 'number' && !Number.isNaN(value);\n}\n","import {\n  MutableRefObject,\n  RefObject,\n  useCallback,\n  useContext,\n  useEffect,\n  useRef,\n} from 'react';\nimport {createRafLoop} from '@common/utils/dom/create-ref-loop';\nimport {PlayerStoreContext} from '@common/player/player-context';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\n\nexport interface HtmlMediaInternalStateReturn {\n  ref: RefObject<HTMLMediaElement>;\n  updateCurrentTime: () => void;\n  updateBuffered: () => void;\n  toggleTextTrackModes: (newTrackId: number, isVisible: boolean) => void;\n  internalState: MutableRefObject<{\n    currentTime: number;\n    playbackReady: boolean;\n    timeRafLoop: ReturnType<typeof createRafLoop>;\n  }>;\n}\n\nexport function useHtmlMediaInternalState(\n  ref: RefObject<HTMLMediaElement>\n): HtmlMediaInternalStateReturn {\n  const store = useContext(PlayerStoreContext);\n  const cuedMedia = usePlayerStore(s => s.cuedMedia);\n\n  const internalState = useRef({\n    currentTime: 0,\n    buffered: 0,\n    isMediaWaiting: false,\n    playbackReady: false,\n    /**\n     * The `timeupdate` event fires surprisingly infrequently during playback, meaning your progress\n     * bar (or whatever else is synced to the currentTime) moves in a choppy fashion. This helps\n     * resolve that by retrieving time updates in a request animation frame loop.\n     */\n    timeRafLoop: createRafLoop(() => {\n      updateCurrentTime();\n      updateBuffered();\n    }),\n  });\n\n  const updateBuffered = useCallback(() => {\n    const timeRange = ref.current?.buffered;\n    const seconds =\n      !timeRange || timeRange.length === 0\n        ? 0\n        : timeRange.end(timeRange.length - 1);\n\n    if (internalState.current.buffered !== seconds) {\n      store.getState().emit('buffered', {seconds});\n      internalState.current.buffered = seconds;\n    }\n  }, [ref, store]);\n\n  const updateCurrentTime = useCallback(() => {\n    const newTime = ref.current?.currentTime || 0;\n    if (\n      internalState.current.currentTime !== newTime &&\n      !store.getState().isSeeking\n    ) {\n      store.getState().emit('progress', {currentTime: newTime});\n      internalState.current.currentTime = newTime;\n    }\n  }, [internalState, store, ref]);\n\n  const toggleTextTrackModes = useCallback(\n    (newTrackId: number, isVisible: boolean) => {\n      if (!ref.current) return;\n      const {textTracks} = ref.current;\n\n      if (newTrackId === -1) {\n        Array.from(textTracks).forEach(track => {\n          track.mode = 'disabled';\n        });\n      } else {\n        const oldTrack = textTracks[store.getState().currentTextTrack];\n        if (oldTrack) oldTrack.mode = 'disabled';\n      }\n\n      const nextTrack = textTracks[newTrackId];\n\n      if (nextTrack) {\n        nextTrack.mode = isVisible ? 'showing' : 'hidden';\n      }\n\n      store.getState().emit('currentTextTrackChange', {\n        trackId: !isVisible ? -1 : newTrackId,\n      });\n      store\n        .getState()\n        .emit('textTrackVisibilityChange', {isVisible: isVisible});\n    },\n    [ref, store]\n  );\n\n  // stop current time loop on unmount\n  useEffect(() => {\n    const timeRafLoop = internalState.current.timeRafLoop;\n    return () => {\n      timeRafLoop.stop();\n    };\n  }, []);\n\n  // reload metadata when new media is cued\n  useEffect(() => {\n    ref.current?.load();\n  }, [cuedMedia?.src, ref]);\n\n  return {\n    ref,\n    internalState,\n    updateCurrentTime,\n    toggleTextTrackModes,\n    updateBuffered,\n  };\n}\n","import {\n  HTMLAttributes,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n} from 'react';\nimport {PlayerStoreContext} from '@common/player/player-context';\nimport {HtmlMediaInternalStateReturn} from '@common/player/providers/html-media/use-html-media-internal-state';\n\nconst defaultPlaybackRates = [0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2];\n\nexport function useHtmlMediaEvents({\n  ref,\n  updateCurrentTime,\n  updateBuffered,\n  internalState,\n}: HtmlMediaInternalStateReturn): HTMLAttributes<HTMLMediaElement> {\n  const store = useContext(PlayerStoreContext);\n\n  const onTextTracksChange = useCallback(() => {\n    if (!ref.current) return;\n    const tracks = Array.from(ref.current.textTracks).filter(\n      t => t.label && (t.kind === 'subtitles' || t.kind === 'captions')\n    );\n\n    let trackId = -1;\n    for (let id = 0; id < tracks.length; id += 1) {\n      if (tracks[id].mode === 'hidden') {\n        // Do not break in case there is a following track with showing.\n        trackId = id;\n      } else if (tracks[id].mode === 'showing') {\n        trackId = id;\n        break;\n      }\n    }\n\n    const isVisible = trackId !== -1 && tracks[trackId].mode === 'showing';\n    store.getState().emit('currentTextTrackChange', {trackId});\n    store.getState().emit('textTrackVisibilityChange', {isVisible});\n    store.getState().emit('textTracks', {tracks});\n  }, [ref, store]);\n\n  useEffect(() => {\n    const el = ref.current;\n    return () => {\n      el?.textTracks.removeEventListener('change', onTextTracksChange);\n    };\n  }, [ref, onTextTracksChange]);\n\n  return useMemo(() => {\n    const emit = store.getState().emit;\n    return {\n      // set some common props used on audio/video/hls/dash providers\n      autoPlay: false,\n      onContextMenu: e => e.preventDefault(),\n      controlsList: 'nodownload',\n      preload: 'metadata',\n      'x-webkit-airplay': 'allow',\n      onEnded: () => {\n        emit('playbackEnd');\n        updateCurrentTime();\n        internalState.current.timeRafLoop.stop();\n      },\n      onStalled: e => {\n        if (e.currentTarget.readyState < 3) {\n          emit('buffering', {isBuffering: true});\n        }\n      },\n      onWaiting: () => {\n        emit('buffering', {isBuffering: true});\n      },\n      onPlaying: () => {\n        emit('play');\n        emit('buffering', {isBuffering: false});\n      },\n      onPause: e => {\n        emit('pause');\n        emit('buffering', {isBuffering: false});\n        internalState.current.timeRafLoop.stop();\n      },\n      onSuspend: () => {\n        emit('buffering', {isBuffering: false});\n      },\n      onSeeking: () => {\n        updateCurrentTime();\n      },\n      onSeeked: () => {\n        updateCurrentTime();\n      },\n      onTimeUpdate: () => {\n        updateCurrentTime();\n      },\n      onError: e => {\n        emit('error', {sourceEvent: e});\n      },\n      onDurationChange: e => {\n        updateCurrentTime();\n        emit('durationChange', {duration: e.currentTarget.duration});\n      },\n      onRateChange: e => {\n        emit('playbackRateChange', {rate: e.currentTarget.playbackRate});\n      },\n      onLoadedMetadata: e => {\n        if (!internalState.current.playbackReady) {\n          emit('providerReady', {el: e.currentTarget});\n          internalState.current.playbackReady = true;\n          updateBuffered();\n          onTextTracksChange();\n          e.currentTarget.textTracks.addEventListener('change', () => {\n            onTextTracksChange();\n          });\n        }\n        emit('cued');\n        emit('playbackRates', {rates: defaultPlaybackRates});\n      },\n    };\n  }, [\n    internalState,\n    store,\n    updateCurrentTime,\n    onTextTracksChange,\n    updateBuffered,\n  ]);\n}\n","import {HtmlMediaInternalStateReturn} from '@common/player/providers/html-media/use-html-media-internal-state';\nimport {useContext, useMemo} from 'react';\nimport {PlayerStoreContext} from '@common/player/player-context';\nimport {PlayerProviderApi} from '@common/player/state/player-provider-api';\n\nexport function useHtmlMediaApi({\n  ref,\n  internalState,\n  toggleTextTrackModes,\n}: HtmlMediaInternalStateReturn): PlayerProviderApi {\n  const store = useContext(PlayerStoreContext);\n  return useMemo(\n    () => ({\n      play: async () => {\n        try {\n          await ref.current?.play();\n        } catch (e) {\n          store.getState().emit('error', {sourceEvent: e});\n        }\n        internalState.current.timeRafLoop.start();\n      },\n      pause: () => {\n        ref.current?.pause();\n        internalState.current.timeRafLoop.stop();\n      },\n      stop: () => {\n        if (ref.current) {\n          ref.current.pause();\n          ref.current.currentTime = 0;\n        }\n      },\n      seek: (time: number) => {\n        if (time !== internalState.current.currentTime && ref.current) {\n          ref.current.currentTime = time;\n        }\n      },\n      setVolume: (volume: number) => {\n        if (ref.current) {\n          ref.current.volume = volume / 100;\n        }\n      },\n      setMuted: (muted: boolean) => {\n        if (ref.current) {\n          ref.current.muted = muted;\n        }\n      },\n      setPlaybackRate: (value: number) => {\n        if (ref.current) {\n          ref.current.playbackRate = value;\n        }\n      },\n      setTextTrackVisibility: isVisible => {\n        toggleTextTrackModes(store.getState().currentTextTrack, isVisible);\n      },\n      setCurrentTextTrack: newTrackId => {\n        toggleTextTrackModes(newTrackId, store.getState().textTrackIsVisible);\n      },\n      getCurrentTime: () => {\n        return internalState.current.currentTime;\n      },\n      getSrc: () => {\n        return ref.current?.src;\n      },\n    }),\n    [ref, store, internalState, toggleTextTrackModes]\n  );\n}\n","import {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {useContext, useEffect, useRef} from 'react';\nimport {PlayerStoreContext} from '@common/player/player-context';\nimport {useHtmlMediaInternalState} from '@common/player/providers/html-media/use-html-media-internal-state';\nimport {useHtmlMediaEvents} from '@common/player/providers/html-media/use-html-media-events';\nimport {useHtmlMediaApi} from '@common/player/providers/html-media/use-html-media-api';\n\nexport function HtmlVideoProvider() {\n  const ref = useRef<HTMLVideoElement>(null);\n\n  const autoPlay = usePlayerStore(s => s.options.autoPlay);\n  const muted = usePlayerStore(s => s.muted);\n  const cuedMedia = usePlayerStore(s => s.cuedMedia);\n  const store = useContext(PlayerStoreContext);\n\n  const state = useHtmlMediaInternalState(ref);\n  const events = useHtmlMediaEvents(state);\n  const providerApi = useHtmlMediaApi(state);\n\n  useEffect(() => {\n    store.setState({\n      providerApi,\n    });\n  }, [store, providerApi]);\n\n  let src = cuedMedia?.src;\n  if (src && cuedMedia?.initialTime) {\n    src = `${src}#t=${cuedMedia.initialTime}`;\n  }\n\n  return (\n    <video\n      className=\"w-full h-full\"\n      ref={ref}\n      src={src}\n      playsInline\n      poster={cuedMedia?.poster}\n      autoPlay={autoPlay}\n      muted={muted}\n      {...events}\n    >\n      {cuedMedia?.captions?.map((caption, index) => (\n        <track\n          key={caption.id}\n          label={caption.label}\n          kind=\"subtitles\"\n          srcLang={caption.language || 'en'}\n          src={caption.src}\n          default={index === 0}\n        />\n      ))}\n    </video>\n  );\n}\n","import {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {useContext, useEffect, useRef} from 'react';\nimport {PlayerStoreContext} from '@common/player/player-context';\nimport {useHtmlMediaInternalState} from '@common/player/providers/html-media/use-html-media-internal-state';\nimport {useHtmlMediaEvents} from '@common/player/providers/html-media/use-html-media-events';\nimport {useHtmlMediaApi} from '@common/player/providers/html-media/use-html-media-api';\n\nexport function HtmlAudioProvider() {\n  const ref = useRef<HTMLAudioElement>(null);\n\n  const autoPlay = usePlayerStore(s => s.options.autoPlay);\n  const muted = usePlayerStore(s => s.muted);\n  const cuedMedia = usePlayerStore(s => s.cuedMedia);\n  const store = useContext(PlayerStoreContext);\n\n  const state = useHtmlMediaInternalState(ref);\n  const events = useHtmlMediaEvents(state);\n  const providerApi = useHtmlMediaApi(state);\n\n  useEffect(() => {\n    store.setState({\n      providerApi,\n    });\n  }, [store, providerApi]);\n\n  let src = cuedMedia?.src;\n  if (src && cuedMedia?.initialTime) {\n    src = `${src}#t=${cuedMedia.initialTime}`;\n  }\n\n  return (\n    <audio\n      className=\"w-full h-full\"\n      ref={ref}\n      src={src}\n      autoPlay={autoPlay}\n      muted={muted}\n      {...events}\n    />\n  );\n}\n","import React, {memo, Suspense, useContext, useEffect} from 'react';\nimport {PlayerStoreContext} from '@common/player/player-context';\nimport {YoutubeProvider} from '@common/player/providers/youtube/youtube-provider';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {HtmlVideoProvider} from '@common/player/providers/html-video-provider';\nimport {HtmlAudioProvider} from '@common/player/providers/html-audio-provider';\n\nconst HlsProvider = React.lazy(\n  () => import('@common/player/providers/hls-provider')\n);\nconst DashProvider = React.lazy(\n  () => import('@common/player/providers/dash-provider')\n);\n\ninterface Props {\n  className?: string;\n}\nexport const PlayerOutlet = memo(({className}: Props) => {\n  const {getState} = useContext(PlayerStoreContext);\n\n  useEffect(() => {\n    getState().init();\n    return getState().destroy;\n  }, [getState]);\n\n  return (\n    <div className={className}>\n      <Provider />\n    </div>\n  );\n});\n\nfunction Provider() {\n  const provider = usePlayerStore(s => s.providerName);\n  switch (provider) {\n    case 'youtube':\n      return <YoutubeProvider />;\n    case 'htmlVideo':\n      return <HtmlVideoProvider />;\n    case 'htmlAudio':\n      return <HtmlAudioProvider />;\n    case 'hls':\n      return (\n        <Suspense>\n          <HlsProvider />\n        </Suspense>\n      );\n    case 'dash':\n      return (\n        <Suspense>\n          <DashProvider />\n        </Suspense>\n      );\n    default:\n      return null;\n  }\n}\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaPauseIcon = createSvgIcon(\n  [<path d=\"M8.66667 6.66667C8.29848 6.66667 8 6.96514 8 7.33333V24.6667C8 25.0349 8.29848 25.3333 8.66667 25.3333H12.6667C13.0349 25.3333 13.3333 25.0349 13.3333 24.6667V7.33333C13.3333 6.96514 13.0349 6.66667 12.6667 6.66667H8.66667Z\" key=\"0\"/>,<path d=\"M19.3333 6.66667C18.9651 6.66667 18.6667 6.96514 18.6667 7.33333V24.6667C18.6667 25.0349 18.9651 25.3333 19.3333 25.3333H23.3333C23.7015 25.3333 24 25.0349 24 24.6667V7.33333C24 6.96514 23.7015 6.66667 23.3333 6.66667H19.3333Z\" key=\"1\"/>,],\n  'MediaPause',\n  '0 0 32 32'\n);\n","import {IconButton} from '@common/ui/buttons/icon-button';\nimport {ButtonProps} from '@common/ui/buttons/button';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {MediaPlayIcon} from '@common/icons/media/media-play';\nimport {MediaPauseIcon} from '@common/icons/media/media-pause';\nimport {Tooltip} from '@common/ui/tooltip/tooltip';\nimport {Trans} from '@common/i18n/trans';\n\ninterface Props {\n  color?: ButtonProps['color'];\n  size?: ButtonProps['size'];\n  iconSize?: ButtonProps['size'];\n  className?: string;\n  stopPropagation?: boolean;\n}\nexport function PlayButton({\n  size = 'md',\n  iconSize = 'xl',\n  color,\n  stopPropagation,\n}: Props) {\n  const isPlaying = usePlayerStore(s => s.isPlaying);\n  const playerReady = usePlayerStore(s => s.providerReady);\n  const player = usePlayerActions();\n\n  const label = isPlaying ? (\n    <Trans message=\"Pause (k)\" />\n  ) : (\n    <Trans message=\"Play (k)\" />\n  );\n\n  return (\n    <Tooltip label={label} usePortal={false}>\n      <IconButton\n        color={color}\n        size={size}\n        iconSize={iconSize}\n        disabled={!playerReady}\n        onClick={e => {\n          if (stopPropagation) {\n            e.stopPropagation();\n          }\n          if (isPlaying) {\n            player.pause();\n          } else {\n            player.play();\n          }\n        }}\n      >\n        {isPlaying ? <MediaPauseIcon /> : <MediaPlayIcon />}\n      </IconButton>\n    </Tooltip>\n  );\n}\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaMuteIcon = createSvgIcon(\n  [<path d=\"M17.5091 24.6594C17.5091 25.2066 16.8864 25.5208 16.4463 25.1956L9.44847 20.0252C9.42553 20.0083 9.39776 19.9991 9.36923 19.9991H4.66667C4.29848 19.9991 4 19.7006 4 19.3325V12.6658C4 12.2976 4.29848 11.9991 4.66667 11.9991H9.37115C9.39967 11.9991 9.42745 11.99 9.45039 11.973L16.4463 6.8036C16.8863 6.47842 17.5091 6.79259 17.5091 7.33977L17.5091 24.6594Z\" key=\"0\"/>,<path d=\"M28.8621 13.6422C29.1225 13.3818 29.1225 12.9597 28.8621 12.6994L27.9193 11.7566C27.659 11.4962 27.2368 11.4962 26.9765 11.7566L24.7134 14.0197C24.6613 14.0717 24.5769 14.0717 24.5248 14.0197L22.262 11.7568C22.0016 11.4964 21.5795 11.4964 21.3191 11.7568L20.3763 12.6996C20.116 12.9599 20.116 13.382 20.3763 13.6424L22.6392 15.9053C22.6913 15.9573 22.6913 16.0418 22.6392 16.0938L20.3768 18.3562C20.1165 18.6166 20.1165 19.0387 20.3768 19.299L21.3196 20.2419C21.58 20.5022 22.0021 20.5022 22.2624 20.2418L24.5248 17.9795C24.5769 17.9274 24.6613 17.9274 24.7134 17.9795L26.976 20.2421C27.2363 20.5024 27.6585 20.5024 27.9188 20.2421L28.8616 19.2992C29.122 19.0389 29.122 18.6168 28.8616 18.3564L26.599 16.0938C26.547 16.0418 26.547 15.9573 26.599 15.9053L28.8621 13.6422Z\" key=\"1\"/>,],\n  'MediaMute',\n  '0 0 32 32'\n);\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaVolumeLowIcon = createSvgIcon(\n  [<path d=\"M17.5091 24.6594C17.5091 25.2066 16.8864 25.5207 16.4463 25.1956L9.44847 20.0252C9.42553 20.0083 9.39776 19.9991 9.36923 19.9991H4.66667C4.29848 19.9991 4 19.7006 4 19.3324V12.6658C4 12.2976 4.29848 11.9991 4.66667 11.9991H9.37115C9.39967 11.9991 9.42745 11.99 9.45039 11.973L16.4463 6.80358C16.8863 6.4784 17.5091 6.79258 17.5091 7.33975L17.5091 24.6594Z\" key=\"0\"/>,<path d=\"M22.8424 12.6667C22.8424 12.2985 22.544 12 22.1758 12H20.8424C20.4743 12 20.1758 12.2985 20.1758 12.6667V19.3333C20.1758 19.7015 20.4743 20 20.8424 20H22.1758C22.544 20 22.8424 19.7015 22.8424 19.3333V12.6667Z\" key=\"1\"/>,],\n  'MediaVolumeLow',\n  '0 0 32 32'\n);\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaVolumeHighIcon = createSvgIcon(\n  [<path d=\"M17.5091 24.6595C17.5091 25.2066 16.8864 25.5208 16.4463 25.1956L9.44847 20.0252C9.42553 20.0083 9.39776 19.9992 9.36923 19.9992H4.66667C4.29848 19.9992 4 19.7007 4 19.3325V12.6658C4 12.2976 4.29848 11.9992 4.66667 11.9992H9.37115C9.39967 11.9992 9.42745 11.99 9.45039 11.9731L16.4463 6.80363C16.8863 6.47845 17.5091 6.79262 17.5091 7.3398L17.5091 24.6595Z\" key=\"0\"/>,<path d=\"M27.5091 9.33336C27.8773 9.33336 28.1758 9.63184 28.1758 10V22C28.1758 22.3682 27.8773 22.6667 27.5091 22.6667H26.1758C25.8076 22.6667 25.5091 22.3682 25.5091 22V10C25.5091 9.63184 25.8076 9.33336 26.1758 9.33336L27.5091 9.33336Z\" key=\"1\"/>,<path d=\"M22.1758 12C22.544 12 22.8424 12.2985 22.8424 12.6667V19.3334C22.8424 19.7016 22.544 20 22.1758 20H20.8424C20.4743 20 20.1758 19.7016 20.1758 19.3334V12.6667C20.1758 12.2985 20.4743 12 20.8424 12H22.1758Z\" key=\"2\"/>,],\n  'MediaVolumeHigh',\n  '0 0 32 32'\n);\n","import {Slider} from '@common/ui/forms/slider/slider';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {BaseSliderProps} from '@common/ui/forms/slider/base-slider';\nimport {ButtonProps} from '@common/ui/buttons/button';\nimport {MediaMuteIcon} from '@common/icons/media/media-mute';\nimport {MediaVolumeLowIcon} from '@common/icons/media/media-volume-low';\nimport {MediaVolumeHighIcon} from '@common/icons/media/media-volume-high';\nimport {Tooltip} from '@common/ui/tooltip/tooltip';\nimport {Trans} from '@common/i18n/trans';\nimport clsx from 'clsx';\n\ninterface Props {\n  trackColor?: BaseSliderProps['trackColor'];\n  fillColor?: BaseSliderProps['fillColor'];\n  buttonColor?: ButtonProps['color'];\n  className?: string;\n}\nexport function VolumeControls({\n  trackColor,\n  fillColor,\n  buttonColor,\n  className,\n}: Props) {\n  const volume = usePlayerStore(s => s.volume);\n  const player = usePlayerActions();\n  const playerReady = usePlayerStore(s => s.providerReady);\n\n  return (\n    <div className={clsx('flex w-min items-center gap-4', className)}>\n      <ToggleMuteButton color={buttonColor} />\n      <Slider\n        isDisabled={!playerReady}\n        showThumbOnHoverOnly\n        thumbSize=\"w-14 h-14\"\n        trackColor={trackColor}\n        fillColor={fillColor}\n        minValue={0}\n        maxValue={100}\n        className=\"flex-auto\"\n        width=\"w-96\"\n        value={volume}\n        onChange={value => {\n          player.setVolume(value);\n        }}\n      />\n    </div>\n  );\n}\n\ninterface ToggleMuteButtonProps {\n  color?: ButtonProps['color'];\n}\nfunction ToggleMuteButton({color}: ToggleMuteButtonProps) {\n  const isMuted = usePlayerStore(s => s.muted);\n  const volume = usePlayerStore(s => s.volume);\n  const player = usePlayerActions();\n  const playerReady = usePlayerStore(s => s.providerReady);\n\n  if (isMuted) {\n    return (\n      <Tooltip label={<Trans message=\"Unmute\" />} usePortal={false}>\n        <IconButton\n          disabled={!playerReady}\n          color={color}\n          size=\"sm\"\n          iconSize=\"md\"\n          onClick={() => player.setMuted(false)}\n        >\n          <MediaMuteIcon />\n        </IconButton>\n      </Tooltip>\n    );\n  }\n  return (\n    <Tooltip label={<Trans message=\"Mute\" />}>\n      <IconButton\n        disabled={!playerReady}\n        color={color}\n        size=\"sm\"\n        iconSize=\"md\"\n        onClick={() => player.setMuted(true)}\n      >\n        {volume < 40 ? <MediaVolumeLowIcon /> : <MediaVolumeHighIcon />}\n      </IconButton>\n    </Tooltip>\n  );\n}\n","import {useEffect, useState} from 'react';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\n\nexport function useCurrentTime() {\n  const {subscribe, getCurrentTime} = usePlayerActions();\n  const providerKey = usePlayerStore(s =>\n    s.providerName && s.cuedMedia?.id\n      ? `${s.providerName}+${s.cuedMedia.id}`\n      : null\n  );\n\n  const [currentTime, setCurrentTime] = useState(() => getCurrentTime());\n\n  useEffect(() => {\n    return subscribe({\n      progress: ({currentTime}) => setCurrentTime(currentTime),\n    });\n  }, [subscribe]);\n\n  // update current time when media or provider changes\n  useEffect(() => {\n    if (providerKey) {\n      setCurrentTime(getCurrentTime());\n    }\n  }, [providerKey, getCurrentTime]);\n\n  return currentTime;\n}\n","import {Slider} from '@common/ui/forms/slider/slider';\nimport {UseSliderProps} from '@common/ui/forms/slider/use-slider';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {useCurrentTime} from '@common/player/hooks/use-current-time';\nimport {useRef} from 'react';\n\ninterface Props {\n  trackColor?: UseSliderProps['trackColor'];\n  fillColor?: UseSliderProps['fillColor'];\n  className?: string;\n  onPointerMove?: UseSliderProps['onPointerMove'];\n}\nexport function Seekbar({\n  trackColor,\n  fillColor,\n  className,\n  onPointerMove,\n}: Props) {\n  const {pause, seek, setIsSeeking, play, getState} = usePlayerActions();\n  const duration = usePlayerStore(s => s.mediaDuration);\n  const playerReady = usePlayerStore(s => s.providerReady);\n  const pauseWhileSeeking = usePlayerStore(s => s.pauseWhileSeeking);\n\n  const currentTime = useCurrentTime();\n\n  const wasPlayingBeforeDragging = useRef(false);\n\n  return (\n    <Slider\n      fillColor={fillColor}\n      trackColor={trackColor}\n      thumbSize=\"w-14 h-14\"\n      showThumbOnHoverOnly\n      className={className}\n      width=\"w-auto\"\n      isDisabled={!playerReady}\n      value={currentTime}\n      minValue={0}\n      maxValue={duration}\n      onPointerMove={onPointerMove}\n      onPointerDown={() => {\n        setIsSeeking(true);\n        if (pauseWhileSeeking) {\n          wasPlayingBeforeDragging.current =\n            getState().isPlaying || getState().isBuffering;\n          pause();\n        }\n      }}\n      onChange={value => {\n        getState().emit('progress', {currentTime: value});\n        seek(value);\n      }}\n      onChangeEnd={() => {\n        setIsSeeking(false);\n        if (pauseWhileSeeking && wasPlayingBeforeDragging.current) {\n          play();\n          wasPlayingBeforeDragging.current = false;\n        }\n      }}\n    />\n  );\n}\n","import {Fragment, memo} from 'react';\nimport {useTrans, UseTransReturn} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\n\ninterface ParsedMS {\n  days: number;\n  hours: number;\n  minutes: number;\n  seconds: number;\n}\n\ninterface FormattedTrackDurationProps {\n  ms?: number;\n  minutes?: number;\n  seconds?: number;\n  verbose?: boolean;\n  addZeroToFirstUnit?: boolean;\n}\nexport const FormattedDuration = memo(\n  ({\n    minutes,\n    seconds,\n    ms,\n    verbose = false,\n    addZeroToFirstUnit = true,\n  }: FormattedTrackDurationProps) => {\n    const {trans} = useTrans();\n\n    if (minutes) {\n      ms = minutes * 60000;\n    } else if (seconds) {\n      ms = seconds * 1000;\n    }\n    if (!ms) {\n      ms = 0;\n    }\n\n    const unsignedMs = ms < 0 ? -ms : ms;\n    const parsedMS: ParsedMS = {\n      days: Math.trunc(unsignedMs / 86400000),\n      hours: Math.trunc(unsignedMs / 3600000) % 24,\n      minutes: Math.trunc(unsignedMs / 60000) % 60,\n      seconds: Math.trunc(unsignedMs / 1000) % 60,\n    };\n\n    let formattedValue: string;\n    if (verbose) {\n      formattedValue = formatVerbose(parsedMS, trans);\n    } else {\n      formattedValue = formatCompact(parsedMS, addZeroToFirstUnit);\n    }\n\n    return <Fragment>{formattedValue}</Fragment>;\n  }\n);\n\nfunction formatVerbose(t: ParsedMS, trans: UseTransReturn['trans']) {\n  const output: string[] = [];\n\n  if (t.days) {\n    output.push(`${t.days}${trans(message('d'))}`);\n  }\n  if (t.hours) {\n    output.push(`${t.hours}${trans(message('hr'))}`);\n  }\n  if (t.minutes) {\n    output.push(`${t.minutes}${trans(message('min'))}`);\n  }\n  if (t.seconds && !t.hours) {\n    output.push(`${t.seconds}${trans(message('sec'))}`);\n  }\n\n  return output.join(' ');\n}\n\nfunction formatCompact(t: ParsedMS, addZeroToFirstUnit = true) {\n  const seconds = addZero(t.seconds);\n  let output = '';\n  if (t.days && !output) {\n    output = `${t.days}:${addZero(t.hours)}:${addZero(t.minutes)}:${seconds}`;\n  }\n  if (t.hours && !output) {\n    output = `${addZero(t.hours, addZeroToFirstUnit)}:${addZero(\n      t.minutes\n    )}:${seconds}`;\n  }\n  if (!output) {\n    output = `${addZero(t.minutes, addZeroToFirstUnit)}:${seconds}`;\n  }\n  return output;\n}\n\nfunction addZero(v: number, addZero = true) {\n  if (!addZero) return v;\n  let value = `${v}`;\n  if (value.length === 1) {\n    value = '0' + value;\n  }\n  return value;\n}\n","import {useCurrentTime} from '@common/player/hooks/use-current-time';\nimport {FormattedDuration} from '@common/i18n/formatted-duration';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\n\ninterface Props {\n  className?: string;\n}\nexport function FormattedCurrentTime({className}: Props) {\n  const duration = usePlayerStore(s => s.mediaDuration);\n  const currentTime = useCurrentTime();\n  return (\n    <span className={className}>\n      <FormattedDuration\n        seconds={currentTime}\n        addZeroToFirstUnit={duration >= 600}\n      />\n    </span>\n  );\n}\n","import {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {FormattedDuration} from '@common/i18n/formatted-duration';\n\ninterface Props {\n  className?: string;\n}\nexport function FormattedPlayerDuration({className}: Props) {\n  const duration = usePlayerStore(s => s.mediaDuration);\n  return (\n    <span className={className}>\n      <FormattedDuration\n        seconds={duration}\n        addZeroToFirstUnit={duration >= 600}\n      />\n    </span>\n  );\n}\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaNextIcon = createSvgIcon(\n  [<path d=\"M6.39617 6.78532C5.9561 6.46017 5.33334 6.77434 5.33334 7.32151V24.6785C5.33334 25.2257 5.95612 25.5398 6.39619 25.2147L18.1415 16.5358C18.5021 16.2693 18.5021 15.7299 18.1415 15.4634L6.39617 6.78532Z\" key=\"0\"/>,<path d=\"M23.5339 6.6667C23.1657 6.6667 22.8672 6.96518 22.8672 7.33337V24.6667C22.8672 25.0349 23.1657 25.3334 23.5339 25.3334H25.5339C25.902 25.3334 26.2005 25.0349 26.2005 24.6667V7.33337C26.2005 6.96518 25.902 6.6667 25.5339 6.6667H23.5339Z\" key=\"1\"/>,],\n  'MediaNext',\n  '0 0 32 32'\n);\n","import {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {ButtonProps} from '@common/ui/buttons/button';\nimport {MediaNextIcon} from '@common/icons/media/media-next';\nimport {Tooltip} from '@common/ui/tooltip/tooltip';\nimport {Trans} from '@common/i18n/trans';\nimport React from 'react';\n\ninterface Props {\n  color?: ButtonProps['color'];\n  size?: ButtonProps['size'];\n  iconSize?: ButtonProps['size'];\n  className?: string;\n  stopPropagation?: boolean;\n}\nexport function NextButton({\n  size = 'md',\n  iconSize,\n  color,\n  className,\n  stopPropagation,\n}: Props) {\n  const player = usePlayerActions();\n  const playerReady = usePlayerStore(s => s.providerReady);\n\n  return (\n    <Tooltip label={<Trans message=\"Next\" />} usePortal={false}>\n      <IconButton\n        disabled={!playerReady}\n        size={size}\n        color={color}\n        iconSize={iconSize}\n        className={className}\n        onClick={e => {\n          if (stopPropagation) {\n            e.stopPropagation();\n          }\n          player.playNext();\n        }}\n      >\n        <MediaNextIcon />\n      </IconButton>\n    </Tooltip>\n  );\n}\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaFullscreenExitIcon = createSvgIcon(\n  [<path d=\"M19.3334 13.3333C18.9652 13.3333 18.6667 13.0349 18.6667 12.6667L18.6667 7.33333C18.6667 6.96514 18.9652 6.66666 19.3334 6.66666H21.3334C21.7015 6.66666 22 6.96514 22 7.33333V9.86666C22 9.9403 22.0597 10 22.1334 10L24.6667 10C25.0349 10 25.3334 10.2985 25.3334 10.6667V12.6667C25.3334 13.0349 25.0349 13.3333 24.6667 13.3333L19.3334 13.3333Z\" key=\"0\"/>,<path d=\"M13.3334 19.3333C13.3334 18.9651 13.0349 18.6667 12.6667 18.6667H7.33335C6.96516 18.6667 6.66669 18.9651 6.66669 19.3333V21.3333C6.66669 21.7015 6.96516 22 7.33335 22H9.86669C9.94032 22 10 22.0597 10 22.1333L10 24.6667C10 25.0349 10.2985 25.3333 10.6667 25.3333H12.6667C13.0349 25.3333 13.3334 25.0349 13.3334 24.6667L13.3334 19.3333Z\" key=\"1\"/>,<path d=\"M18.6667 24.6667C18.6667 25.0349 18.9652 25.3333 19.3334 25.3333H21.3334C21.7015 25.3333 22 25.0349 22 24.6667V22.1333C22 22.0597 22.0597 22 22.1334 22H24.6667C25.0349 22 25.3334 21.7015 25.3334 21.3333V19.3333C25.3334 18.9651 25.0349 18.6667 24.6667 18.6667L19.3334 18.6667C18.9652 18.6667 18.6667 18.9651 18.6667 19.3333L18.6667 24.6667Z\" key=\"2\"/>,<path d=\"M10.6667 13.3333H12.6667C13.0349 13.3333 13.3334 13.0349 13.3334 12.6667L13.3334 10.6667V7.33333C13.3334 6.96514 13.0349 6.66666 12.6667 6.66666H10.6667C10.2985 6.66666 10 6.96514 10 7.33333L10 9.86666C10 9.9403 9.94033 10 9.86669 10L7.33335 10C6.96516 10 6.66669 10.2985 6.66669 10.6667V12.6667C6.66669 13.0349 6.96516 13.3333 7.33335 13.3333L10.6667 13.3333Z\" key=\"3\"/>,],\n  'MediaFullscreenExit',\n  '0 0 32 32'\n);\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaFullscreenIcon = createSvgIcon(\n  [<path d=\"M25.3299 7.26517C25.2958 6.929 25.0119 6.66666 24.6667 6.66666H19.3334C18.9652 6.66666 18.6667 6.96514 18.6667 7.33333V9.33333C18.6667 9.70152 18.9652 10 19.3334 10L21.8667 10C21.9403 10 22 10.0597 22 10.1333V12.6667C22 13.0349 22.2985 13.3333 22.6667 13.3333H24.6667C25.0349 13.3333 25.3334 13.0349 25.3334 12.6667V7.33333C25.3334 7.31032 25.3322 7.28758 25.3299 7.26517Z\" key=\"0\"/>,<path d=\"M22 21.8667C22 21.9403 21.9403 22 21.8667 22L19.3334 22C18.9652 22 18.6667 22.2985 18.6667 22.6667V24.6667C18.6667 25.0349 18.9652 25.3333 19.3334 25.3333L24.6667 25.3333C25.0349 25.3333 25.3334 25.0349 25.3334 24.6667V19.3333C25.3334 18.9651 25.0349 18.6667 24.6667 18.6667H22.6667C22.2985 18.6667 22 18.9651 22 19.3333V21.8667Z\" key=\"1\"/>,<path d=\"M12.6667 22H10.1334C10.0597 22 10 21.9403 10 21.8667V19.3333C10 18.9651 9.70154 18.6667 9.33335 18.6667H7.33335C6.96516 18.6667 6.66669 18.9651 6.66669 19.3333V24.6667C6.66669 25.0349 6.96516 25.3333 7.33335 25.3333H12.6667C13.0349 25.3333 13.3334 25.0349 13.3334 24.6667V22.6667C13.3334 22.2985 13.0349 22 12.6667 22Z\" key=\"2\"/>,<path d=\"M10 12.6667V10.1333C10 10.0597 10.0597 10 10.1334 10L12.6667 10C13.0349 10 13.3334 9.70152 13.3334 9.33333V7.33333C13.3334 6.96514 13.0349 6.66666 12.6667 6.66666H7.33335C6.96516 6.66666 6.66669 6.96514 6.66669 7.33333V12.6667C6.66669 13.0349 6.96516 13.3333 7.33335 13.3333H9.33335C9.70154 13.3333 10 13.0349 10 12.6667Z\" key=\"3\"/>,],\n  'MediaFullscreen',\n  '0 0 32 32'\n);\n","import {ButtonProps} from '@common/ui/buttons/button';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {message} from '@common/i18n/message';\nimport {Tooltip} from '@common/ui/tooltip/tooltip';\nimport {Trans} from '@common/i18n/trans';\nimport {MediaFullscreenExitIcon} from '@common/icons/media/media-fullscreen-exit';\nimport {MediaFullscreenIcon} from '@common/icons/media/media-fullscreen';\n\ninterface Props {\n  color?: ButtonProps['color'];\n  size?: ButtonProps['size'];\n  iconSize?: ButtonProps['size'];\n  className?: string;\n}\nexport function FullscreenButton({\n  size = 'md',\n  iconSize,\n  color,\n  className,\n}: Props) {\n  const {trans} = useTrans();\n  const player = usePlayerActions();\n  const playerReady = usePlayerStore(s => s.providerReady);\n  const isFullscreen = usePlayerStore(s => s.isFullscreen);\n  const canFullscreen = usePlayerStore(s => s.canFullscreen);\n\n  if (!canFullscreen) {\n    return null;\n  }\n\n  const labelMessage = trans(\n    isFullscreen\n      ? message('Exit fullscreen (f)')\n      : message('Enter fullscreen (f)')\n  );\n\n  return (\n    <Tooltip label={<Trans message={labelMessage} />} usePortal={false}>\n      <IconButton\n        disabled={!playerReady}\n        aria-label={labelMessage}\n        size={size}\n        color={color}\n        iconSize={iconSize}\n        className={className}\n        onClick={() => {\n          if (isFullscreen) {\n            player.exitFullscreen();\n          } else {\n            player.enterFullscreen();\n          }\n        }}\n      >\n        {isFullscreen ? <MediaFullscreenExitIcon /> : <MediaFullscreenIcon />}\n      </IconButton>\n    </Tooltip>\n  );\n}\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaPictureInPictureExitIcon = createSvgIcon(\n  [<path d=\"M5.33334 26V19.4667C5.33334 19.393 5.39304 19.3333 5.46668 19.3333H7.86668C7.94031 19.3333 8.00001 19.393 8.00001 19.4667V23.3333C8.00001 23.7015 8.29849 24 8.66668 24H23.3333C23.7015 24 24 23.7015 24 23.3333V8.66666C24 8.29847 23.7015 7.99999 23.3333 7.99999H19.4667C19.393 7.99999 19.3333 7.9403 19.3333 7.86666V5.46666C19.3333 5.39302 19.393 5.33333 19.4667 5.33333H26C26.3682 5.33333 26.6667 5.63181 26.6667 5.99999V26C26.6667 26.3682 26.3682 26.6667 26 26.6667H6.00001C5.63182 26.6667 5.33334 26.3682 5.33334 26Z\" key=\"0\"/>,<path d=\"M14.0098 8.42359H10.806C10.6872 8.42359 10.6277 8.56721 10.7117 8.6512L16.5491 14.4886C16.8094 14.7489 16.8094 15.171 16.5491 15.4314L15.3234 16.657C15.0631 16.9174 14.641 16.9174 14.3806 16.657L8.63739 10.9138C8.55339 10.8298 8.40978 10.8893 8.40978 11.0081V14.0236C8.40978 14.3918 8.1113 14.6903 7.74311 14.6903H6.00978C5.64159 14.6903 5.34311 14.3918 5.34311 14.0236L5.34311 6.02359C5.34311 5.6554 5.64159 5.35692 6.00978 5.35692L14.0098 5.35692C14.378 5.35692 14.6764 5.6554 14.6764 6.02359V7.75692C14.6764 8.12511 14.378 8.42359 14.0098 8.42359Z\" key=\"1\"/>,],\n  'MediaPictureInPictureExit',\n  '0 0 32 32'\n);\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaPictureInPictureIcon = createSvgIcon(\n  [<path d=\"M16 15.3333C15.6318 15.3333 15.3333 15.6318 15.3333 16V20C15.3333 20.3682 15.6318 20.6667 16 20.6667H21.3333C21.7015 20.6667 22 20.3682 22 20V16C22 15.6318 21.7015 15.3333 21.3333 15.3333H16Z\" key=\"0\"/>,<path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M5.33333 7.33334C5.33333 6.96515 5.63181 6.66667 5.99999 6.66667H26C26.3682 6.66667 26.6667 6.96515 26.6667 7.33334V24.6667C26.6667 25.0349 26.3682 25.3333 26 25.3333H5.99999C5.63181 25.3333 5.33333 25.0349 5.33333 24.6667V7.33334ZM7.99999 10C7.99999 9.63182 8.29847 9.33334 8.66666 9.33334H23.3333C23.7015 9.33334 24 9.63182 24 10V22C24 22.3682 23.7015 22.6667 23.3333 22.6667H8.66666C8.29847 22.6667 7.99999 22.3682 7.99999 22V10Z\" key=\"1\"/>,],\n  'MediaPictureInPicture',\n  '0 0 32 32'\n);\n","import {ButtonProps} from '@common/ui/buttons/button';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {message} from '@common/i18n/message';\nimport {Tooltip} from '@common/ui/tooltip/tooltip';\nimport {Trans} from '@common/i18n/trans';\nimport {MediaPictureInPictureExitIcon} from '@common/icons/media/media-picture-in-picture-exit';\nimport {MediaPictureInPictureIcon} from '@common/icons/media/media-picture-in-picture';\n\ninterface Props {\n  color?: ButtonProps['color'];\n  size?: ButtonProps['size'];\n  iconSize?: ButtonProps['size'];\n  className?: string;\n}\nexport function PipButton({size = 'md', iconSize, color, className}: Props) {\n  const {trans} = useTrans();\n  const player = usePlayerActions();\n  const playerReady = usePlayerStore(s => s.providerReady);\n  const isPip = usePlayerStore(s => s.isPip);\n  const canPip = usePlayerStore(s => s.canPip);\n\n  if (!canPip) {\n    return null;\n  }\n\n  const labelMessage = trans(\n    isPip\n      ? message('Exit picture-in-picture (p)')\n      : message('Enter picture-in-picture (p)')\n  );\n\n  return (\n    <Tooltip label={<Trans message={labelMessage} />} usePortal={false}>\n      <IconButton\n        disabled={!playerReady}\n        aria-label={labelMessage}\n        size={size}\n        color={color}\n        iconSize={iconSize}\n        className={className}\n        onClick={() => {\n          if (isPip) {\n            player.exitPip();\n          } else {\n            player.enterPip();\n          }\n        }}\n      >\n        {isPip ? (\n          <MediaPictureInPictureExitIcon />\n        ) : (\n          <MediaPictureInPictureIcon />\n        )}\n      </IconButton>\n    </Tooltip>\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ArrowRightIcon = createSvgIcon(\n  <path d=\"m10 17 5-5-5-5v10z\" />\n, 'ArrowRightOutlined');\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaSettingsIcon = createSvgIcon(\n  <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M13.5722 5.33333C13.2429 5.33333 12.9629 5.57382 12.9132 5.89938L12.4063 9.21916C12.4 9.26058 12.3746 9.29655 12.3378 9.31672C12.2387 9.37118 12.1409 9.42779 12.0444 9.48648C12.0086 9.5083 11.9646 9.51242 11.9255 9.49718L8.79572 8.27692C8.48896 8.15732 8.14083 8.27958 7.9762 8.56472L5.5491 12.7686C5.38444 13.0538 5.45271 13.4165 5.70981 13.6223L8.33308 15.7225C8.3658 15.7487 8.38422 15.7887 8.38331 15.8306C8.38209 15.8867 8.38148 15.9429 8.38148 15.9993C8.38148 16.0558 8.3821 16.1121 8.38332 16.1684C8.38423 16.2102 8.36582 16.2503 8.33313 16.2765L5.7103 18.3778C5.45334 18.5836 5.38515 18.9462 5.54978 19.2314L7.97688 23.4352C8.14155 23.7205 8.48981 23.8427 8.79661 23.723L11.926 22.5016C11.9651 22.4864 12.009 22.4905 12.0449 22.5123C12.1412 22.5709 12.2388 22.6274 12.3378 22.6818C12.3745 22.7019 12.4 22.7379 12.4063 22.7793L12.9132 26.0993C12.9629 26.4249 13.2429 26.6654 13.5722 26.6654H18.4264C18.7556 26.6654 19.0356 26.425 19.0854 26.0995L19.5933 22.7801C19.5997 22.7386 19.6252 22.7027 19.6619 22.6825C19.7614 22.6279 19.8596 22.5711 19.9564 22.5121C19.9923 22.4903 20.0362 22.4862 20.0754 22.5015L23.2035 23.7223C23.5103 23.842 23.8585 23.7198 24.0232 23.4346L26.4503 19.2307C26.6149 18.9456 26.5467 18.583 26.2898 18.3771L23.6679 16.2766C23.6352 16.2504 23.6168 16.2104 23.6177 16.1685C23.619 16.1122 23.6196 16.0558 23.6196 15.9993C23.6196 15.9429 23.619 15.8866 23.6177 15.8305C23.6168 15.7886 23.6353 15.7486 23.668 15.7224L26.2903 13.623C26.5474 13.4172 26.6156 13.0544 26.451 12.7692L24.0239 8.56537C23.8592 8.28023 23.5111 8.15797 23.2043 8.27757L20.0758 9.49734C20.0367 9.51258 19.9927 9.50846 19.9569 9.48664C19.8599 9.42762 19.7616 9.37071 19.6618 9.31596C19.6251 9.2958 19.5997 9.25984 19.5933 9.21843L19.0854 5.89915C19.0356 5.57369 18.7556 5.33333 18.4264 5.33333H13.5722ZM16.0001 20.2854C18.3672 20.2854 20.2862 18.3664 20.2862 15.9993C20.2862 13.6322 18.3672 11.7132 16.0001 11.7132C13.6329 11.7132 11.714 13.6322 11.714 15.9993C11.714 18.3664 13.6329 20.2854 16.0001 20.2854Z\"/>,\n  'MediaSettings',\n  '0 0 32 32'\n);\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaPlaybackSpeedCircleIcon = createSvgIcon(\n  [<path d=\"M13.9213 5.53573C14.3146 5.45804 14.6666 5.76987 14.6666 6.17079V7.57215C14.6666 7.89777 14.4305 8.17277 14.114 8.24925C12.5981 8.61559 11.2506 9.41368 10.2091 10.506C9.98474 10.7414 9.62903 10.8079 9.34742 10.6453L8.14112 9.94885C7.79394 9.7484 7.69985 9.28777 7.96359 8.98585C9.48505 7.24409 11.5636 6.00143 13.9213 5.53573Z\" key=\"0\"/>,<path d=\"M5.88974 12.5908C6.01805 12.2101 6.46491 12.0603 6.81279 12.2611L8.01201 12.9535C8.29379 13.1162 8.41396 13.4577 8.32238 13.7699C8.11252 14.4854 7.99998 15.2424 7.99998 16.0257C7.99998 16.809 8.11252 17.566 8.32238 18.2814C8.41396 18.5936 8.29378 18.9352 8.01201 19.0979L6.82742 19.7818C6.48051 19.9821 6.03488 19.8337 5.90521 19.4547C5.5345 18.3712 5.33331 17.2091 5.33331 16C5.33331 14.8078 5.5289 13.6613 5.88974 12.5908Z\" key=\"1\"/>,<path d=\"M8.17106 22.0852C7.82291 22.2862 7.72949 22.7486 7.99532 23.0502C9.51387 24.773 11.5799 26.0017 13.9213 26.4642C14.3146 26.5419 14.6666 26.2301 14.6666 25.8291V24.4792C14.6666 24.1536 14.4305 23.8786 14.114 23.8021C12.5981 23.4358 11.2506 22.6377 10.2091 21.5453C9.98474 21.31 9.62903 21.2435 9.34742 21.4061L8.17106 22.0852Z\" key=\"2\"/>,<path d=\"M17.3333 25.8291C17.3333 26.2301 17.6857 26.5418 18.079 26.4641C22.9748 25.4969 26.6666 21.1796 26.6666 16C26.6666 10.8204 22.9748 6.50302 18.079 5.5358C17.6857 5.4581 17.3333 5.76987 17.3333 6.17079V7.57215C17.3333 7.89777 17.5697 8.17282 17.8862 8.24932C21.3942 9.09721 24 12.2572 24 16.0257C24 19.7942 21.3942 22.9542 17.8862 23.802C17.5697 23.8785 17.3333 24.1536 17.3333 24.4792V25.8291Z\" key=\"3\"/>,<path d=\"M14.3961 10.4163C13.9561 10.0911 13.3333 10.4053 13.3333 10.9525L13.3333 21.0474C13.3333 21.5946 13.9561 21.9087 14.3962 21.5836L21.2273 16.5359C21.5879 16.2694 21.5879 15.73 21.2273 15.4635L14.3961 10.4163Z\" key=\"4\"/>,],\n  'MediaPlaybackSpeedCircle',\n  '0 0 32 32'\n);\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaSettingsMenuIcon = createSvgIcon(\n  [<path d=\"M18.6669 10.4001C18.6669 10.7683 18.3684 11.0667 18.0002 11.0667H16.2668C15.8987 11.0667 15.6002 10.7683 15.6002 10.4001V9.86674C15.6002 9.7931 15.5405 9.73341 15.4669 9.73341H5.99998C5.63179 9.73341 5.33331 9.43493 5.33331 9.06674V7.33341C5.33331 6.96522 5.63179 6.66674 5.99998 6.66674H15.4669C15.5405 6.66674 15.6002 6.60704 15.6002 6.53341V6.00007C15.6002 5.63188 15.8987 5.3334 16.2668 5.3334H18.0002C18.3684 5.3334 18.6669 5.63188 18.6669 6.00007V10.4001Z\" key=\"0\"/>,<path d=\"M11.3334 18.8668C11.7016 18.8668 12.0001 18.5683 12.0001 18.2001V13.8001C12.0001 13.4319 11.7016 13.1335 11.3334 13.1335H9.60006C9.23187 13.1335 8.93339 13.4319 8.93339 13.8001V14.3335C8.93339 14.4071 8.8737 14.4668 8.80006 14.4668H6.00006C5.63187 14.4668 5.33339 14.7653 5.33339 15.1335V16.8668C5.33339 17.235 5.63187 17.5335 6.00006 17.5335H8.80006C8.8737 17.5335 8.93339 17.5932 8.93339 17.6668V18.2001C8.93339 18.5683 9.23187 18.8668 9.60006 18.8668H11.3334Z\" key=\"1\"/>,<path d=\"M18.6667 26.0001C18.6667 26.3683 18.3682 26.6668 18 26.6668H16.2667C15.8985 26.6668 15.6 26.3683 15.6 26.0001V25.4668C15.6 25.3931 15.5403 25.3334 15.4667 25.3334H6.00014C5.63195 25.3334 5.33348 25.0349 5.33348 24.6668V22.9334C5.33348 22.5652 5.63195 22.2668 6.00014 22.2668H15.4667C15.5403 22.2668 15.6 22.2071 15.6 22.1334V21.6001C15.6 21.2319 15.8985 20.9334 16.2667 20.9334H18C18.3682 20.9334 18.6667 21.2319 18.6667 21.6001V26.0001Z\" key=\"2\"/>,<path d=\"M22 24.6668C22 25.0349 22.2985 25.3334 22.6667 25.3334H26.0001C26.3683 25.3334 26.6668 25.0349 26.6668 24.6668V22.9334C26.6668 22.5652 26.3683 22.2668 26.0001 22.2668H22.6667C22.2985 22.2668 22 22.5652 22 22.9334V24.6668Z\" key=\"3\"/>,<path d=\"M16.0001 17.5335C15.6319 17.5335 15.3334 17.235 15.3334 16.8668V15.1335C15.3334 14.7653 15.6319 14.4668 16.0001 14.4668H26.0001C26.3683 14.4668 26.6667 14.7653 26.6667 15.1335V16.8668C26.6667 17.235 26.3683 17.5335 26.0001 17.5335H16.0001Z\" key=\"4\"/>,<path d=\"M22.0002 9.06674C22.0002 9.43493 22.2987 9.73341 22.6669 9.73341H26C26.3682 9.73341 26.6666 9.43493 26.6666 9.06674V7.3334C26.6666 6.96521 26.3682 6.66674 26 6.66674H22.6669C22.2987 6.66674 22.0002 6.96522 22.0002 7.33341V9.06674Z\" key=\"5\"/>,],\n  'MediaSettingsMenu',\n  '0 0 32 32'\n);\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaClosedCaptionsIcon = createSvgIcon(\n  <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M4.6661 6.66699C4.29791 6.66699 3.99943 6.96547 3.99943 7.33366V24.667C3.99943 25.0352 4.29791 25.3337 4.6661 25.3337H27.3328C27.701 25.3337 27.9994 25.0352 27.9994 24.667V7.33366C27.9994 6.96547 27.701 6.66699 27.3328 6.66699H4.6661ZM8.66667 21.3333C8.29848 21.3333 8 21.0349 8 20.6667V11.3333C8 10.9651 8.29848 10.6667 8.66667 10.6667H14C14.3682 10.6667 14.6667 10.9651 14.6667 11.3333V12.6667C14.6667 13.0349 14.3682 13.3333 14 13.3333H10.8C10.7264 13.3333 10.6667 13.393 10.6667 13.4667V18.5333C10.6667 18.607 10.7264 18.6667 10.8 18.6667H14C14.3682 18.6667 14.6667 18.9651 14.6667 19.3333V20.6667C14.6667 21.0349 14.3682 21.3333 14 21.3333H8.66667ZM18 21.3333C17.6318 21.3333 17.3333 21.0349 17.3333 20.6667V11.3333C17.3333 10.9651 17.6318 10.6667 18 10.6667H23.3333C23.7015 10.6667 24 10.9651 24 11.3333V12.6667C24 13.0349 23.7015 13.3333 23.3333 13.3333H20.1333C20.0597 13.3333 20 13.393 20 13.4667V18.5333C20 18.607 20.0597 18.6667 20.1333 18.6667H23.3333C23.7015 18.6667 24 18.9651 24 19.3333V20.6667C24 21.0349 23.7015 21.3333 23.3333 21.3333H18Z\"/>,\n  'MediaClosedCaptions',\n  '0 0 32 32'\n);\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaArrowLeftIcon = createSvgIcon(\n  <path d=\"M13.0908 14.3334C12.972 14.3334 12.9125 14.1898 12.9965 14.1058L17.7021 9.40022C17.9625 9.13987 17.9625 8.71776 17.7021 8.45741L16.2879 7.04319C16.0275 6.78284 15.6054 6.78284 15.3451 7.04319L6.8598 15.5285C6.59945 15.7888 6.59945 16.2109 6.8598 16.4713L8.27401 17.8855L8.27536 17.8868L15.3453 24.9568C15.6057 25.2172 16.0278 25.2172 16.2881 24.9568L17.7024 23.5426C17.9627 23.2822 17.9627 22.8601 17.7024 22.5998L12.9969 17.8944C12.9129 17.8104 12.9724 17.6668 13.0912 17.6668L26 17.6668C26.3682 17.6668 26.6667 17.3683 26.6667 17.0001V15.0001C26.6667 14.6319 26.3682 14.3334 26 14.3334L13.0908 14.3334Z\"/>,\n  'MediaArrowLeft',\n  '0 0 32 32'\n);\n","import {DialogTrigger} from '@common/ui/overlays/dialog/dialog-trigger';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {Dialog} from '@common/ui/overlays/dialog/dialog';\nimport {DialogBody} from '@common/ui/overlays/dialog/dialog-body';\nimport {List, ListItem} from '@common/ui/list/list';\nimport {Trans} from '@common/i18n/trans';\nimport {ReactNode, useState} from 'react';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {Button, ButtonProps} from '@common/ui/buttons/button';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {ArrowRightIcon} from '@common/icons/material/ArrowRight';\nimport {useDarkThemeVariables} from '@common/ui/themes/use-dark-theme-variables';\nimport {MediaSettingsIcon} from '@common/icons/media/media-settings';\nimport {MediaPlaybackSpeedCircleIcon} from '@common/icons/media/media-playback-speed-circle';\nimport {MediaSettingsMenuIcon} from '@common/icons/media/media-settings-menu';\nimport {MediaClosedCaptionsIcon} from '@common/icons/media/media-closed-captions';\nimport {MediaArrowLeftIcon} from '@common/icons/media/media-arrow-left';\n\ntype OptionsPanel = 'rate' | 'quality' | 'captions' | 'options';\n\nconst Panels = {\n  rate: PlaybackRatePanel,\n  quality: PlaybackQualityPanel,\n  options: OptionsListPanel,\n  captions: CaptionsPanel,\n};\n\ninterface Props {\n  color?: ButtonProps['color'];\n  size?: ButtonProps['size'];\n  iconSize?: ButtonProps['size'];\n  className?: string;\n}\nexport function PlaybackOptionsButton({\n  color,\n  size,\n  iconSize,\n  className,\n}: Props) {\n  const darkThemeVars = useDarkThemeVariables();\n  return (\n    <DialogTrigger type=\"popover\" placement=\"top-end\" usePortal={false}>\n      <IconButton\n        color={color}\n        size={size}\n        iconSize={iconSize}\n        className={className}\n      >\n        <MediaSettingsIcon />\n      </IconButton>\n      <Dialog size=\"w-256\" style={darkThemeVars}>\n        <DialogBody padding=\"p-0\">\n          <PlaybackOptionsPanel />\n        </DialogBody>\n      </Dialog>\n    </DialogTrigger>\n  );\n}\n\nfunction PlaybackOptionsPanel() {\n  const [activePanel, setActivePanel] = useState<OptionsPanel>('options');\n  const PanelComponent = Panels[activePanel];\n\n  return (\n    <AnimatePresence initial={false}>\n      <PanelComponent\n        activePanel={activePanel}\n        onActivePanelChange={setActivePanel}\n      />\n    </AnimatePresence>\n  );\n}\n\ninterface OptionsPanelProps {\n  activePanel: OptionsPanel;\n  onActivePanelChange: (panel: OptionsPanel) => void;\n}\nfunction OptionsListPanel({onActivePanelChange}: OptionsPanelProps) {\n  const activeRate = usePlayerStore(s => s.playbackRate);\n  const availableQualities = usePlayerStore(s => s.playbackQualities);\n  const activeQuality = usePlayerStore(s => s.playbackQuality);\n  const availableTextTracks = usePlayerStore(s => s.textTracks);\n  const textTrackId = usePlayerStore(s => s.currentTextTrack);\n  const currentTextTrack = availableTextTracks[textTrackId];\n\n  return (\n    <m.div\n      initial={{x: '-100%', opacity: 0}}\n      animate={{x: 0, opacity: 1}}\n      exit={{x: '100%', opacity: 0}}\n      transition={{type: 'tween', duration: 0.14}}\n    >\n      <List>\n        <ListItem\n          startIcon={<MediaPlaybackSpeedCircleIcon />}\n          endSection={\n            <div className=\"flex items-center gap-2\">\n              {activeRate}x\n              <ArrowRightIcon size=\"sm\" />\n            </div>\n          }\n          onSelected={() => onActivePanelChange('rate')}\n        >\n          <Trans message=\"Speed\" />\n        </ListItem>\n        <ListItem\n          isDisabled={!availableQualities.length}\n          startIcon={<MediaSettingsMenuIcon />}\n          endSection={\n            <div className=\"flex items-center gap-2 capitalize\">\n              {activeQuality ? activeQuality : <Trans message=\"Auto\" />}\n              <ArrowRightIcon size=\"sm\" />\n            </div>\n          }\n          onSelected={() => onActivePanelChange('quality')}\n        >\n          <Trans message=\"Quality\" />\n        </ListItem>\n        <ListItem\n          isDisabled={!availableTextTracks.length}\n          startIcon={<MediaClosedCaptionsIcon />}\n          endSection={\n            <div className=\"flex items-center gap-2 capitalize\">\n              {currentTextTrack ? (\n                currentTextTrack.label\n              ) : (\n                <Trans message=\"None\" />\n              )}\n              <ArrowRightIcon size=\"sm\" />\n            </div>\n          }\n          onSelected={() => onActivePanelChange('captions')}\n        >\n          <Trans message=\"Subtitles/CC\" />\n        </ListItem>\n      </List>\n    </m.div>\n  );\n}\n\nfunction PlaybackRatePanel({\n  activePanel,\n  onActivePanelChange,\n}: OptionsPanelProps) {\n  const activeRate = usePlayerStore(s => s.playbackRate);\n  const availableRates = usePlayerStore(s => s.playbackRates);\n  const player = usePlayerActions();\n\n  return (\n    <PanelLayout\n      activePanel={activePanel}\n      onActivePanelChange={onActivePanelChange}\n      title={<Trans message=\"Playback speed\" />}\n    >\n      <List>\n        {availableRates.map(rate => (\n          <ListItem\n            key={rate}\n            showCheckmark\n            isSelected={activeRate === rate}\n            onSelected={() => {\n              player.setPlaybackRate(rate);\n              onActivePanelChange('options');\n            }}\n          >\n            {rate}x\n          </ListItem>\n        ))}\n      </List>\n    </PanelLayout>\n  );\n}\n\nfunction PlaybackQualityPanel({\n  activePanel,\n  onActivePanelChange,\n}: OptionsPanelProps) {\n  const activeQuality = usePlayerStore(s => s.playbackQuality);\n  const availableQualities = usePlayerStore(s => s.playbackQualities);\n  const player = usePlayerActions();\n\n  return (\n    <PanelLayout\n      activePanel={activePanel}\n      onActivePanelChange={onActivePanelChange}\n      title={<Trans message=\"Playback quality\" />}\n    >\n      <List>\n        {availableQualities.map(quality => (\n          <ListItem\n            capitalizeFirst\n            key={quality}\n            showCheckmark\n            isSelected={activeQuality === quality}\n            onSelected={() => {\n              player.setPlaybackQuality(quality);\n              onActivePanelChange('options');\n            }}\n          >\n            {quality}\n          </ListItem>\n        ))}\n      </List>\n    </PanelLayout>\n  );\n}\n\nfunction CaptionsPanel({activePanel, onActivePanelChange}: OptionsPanelProps) {\n  const currentTextTrack = usePlayerStore(s => s.currentTextTrack);\n  const textTracks = usePlayerStore(s => s.textTracks);\n  const player = usePlayerActions();\n\n  return (\n    <PanelLayout\n      activePanel={activePanel}\n      onActivePanelChange={onActivePanelChange}\n      title={<Trans message=\"Subtitles/Captions\" />}\n    >\n      <List>\n        <ListItem\n          key=\"off\"\n          showCheckmark\n          isSelected={currentTextTrack === -1}\n          onSelected={() => {\n            player.setCurrentTextTrack(-1);\n            onActivePanelChange('options');\n          }}\n        >\n          <Trans message=\"Off\" />\n        </ListItem>\n        {textTracks.map((track, index) => (\n          <ListItem\n            key={index}\n            showCheckmark\n            isSelected={currentTextTrack === index}\n            onSelected={() => {\n              player.setCurrentTextTrack(index);\n              onActivePanelChange('options');\n            }}\n          >\n            {track.label}\n          </ListItem>\n        ))}\n      </List>\n    </PanelLayout>\n  );\n}\n\ninterface PanelLayoutProps extends OptionsPanelProps {\n  children: ReactNode;\n  title: ReactNode;\n}\nfunction PanelLayout({onActivePanelChange, children, title}: PanelLayoutProps) {\n  return (\n    <m.div\n      initial={{x: '100%', opacity: 0}}\n      animate={{x: 0, opacity: 1}}\n      exit={{x: '-100%', opacity: 0}}\n      transition={{type: 'tween', duration: 0.14}}\n    >\n      <div className=\"border-b p-10\">\n        <Button\n          className=\"w-full\"\n          color=\"white\"\n          justify=\"justify-start\"\n          startIcon={<MediaArrowLeftIcon />}\n          onClick={() => onActivePanelChange('options')}\n        >\n          {title}\n        </Button>\n      </div>\n      {children}\n    </m.div>\n  );\n}\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaClosedCaptionsOnIcon = createSvgIcon(\n  [<path d=\"M8 28.0003C8 27.6321 8.29848 27.3336 8.66667 27.3336H23.3333C23.7015 27.3336 24 27.6321 24 28.0003V29.3336C24 29.7018 23.7015 30.0003 23.3333 30.0003H8.66667C8.29848 30.0003 8 29.7018 8 29.3336V28.0003Z\" key=\"0\"/>,<path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M4.66602 6.66699C4.29783 6.66699 3.99935 6.96547 3.99935 7.33366V24.667C3.99935 25.0352 4.29783 25.3337 4.66602 25.3337H27.3327C27.7009 25.3337 27.9994 25.0352 27.9994 24.667V7.33366C27.9994 6.96547 27.7009 6.66699 27.3327 6.66699H4.66602ZM8.66659 21.3333C8.2984 21.3333 7.99992 21.0349 7.99992 20.6667V11.3333C7.99992 10.9651 8.2984 10.6667 8.66659 10.6667H13.9999C14.3681 10.6667 14.6666 10.9651 14.6666 11.3333V12.6667C14.6666 13.0349 14.3681 13.3333 13.9999 13.3333H10.7999C10.7263 13.3333 10.6666 13.393 10.6666 13.4667V18.5333C10.6666 18.607 10.7263 18.6667 10.7999 18.6667H13.9999C14.3681 18.6667 14.6666 18.9651 14.6666 19.3333V20.6667C14.6666 21.0349 14.3681 21.3333 13.9999 21.3333H8.66659ZM17.9999 21.3333C17.6317 21.3333 17.3333 21.0349 17.3333 20.6667V11.3333C17.3333 10.9651 17.6317 10.6667 17.9999 10.6667H23.3333C23.7014 10.6667 23.9999 10.9651 23.9999 11.3333V12.6667C23.9999 13.0349 23.7014 13.3333 23.3333 13.3333H20.1333C20.0596 13.3333 19.9999 13.393 19.9999 13.4667V18.5333C19.9999 18.607 20.0596 18.6667 20.1333 18.6667H23.3333C23.7014 18.6667 23.9999 18.9651 23.9999 19.3333V20.6667C23.9999 21.0349 23.7014 21.3333 23.3333 21.3333H17.9999Z\" key=\"1\"/>,],\n  'MediaClosedCaptionsOn',\n  '0 0 32 32'\n);\n","import {ButtonProps} from '@common/ui/buttons/button';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {message} from '@common/i18n/message';\nimport {Tooltip} from '@common/ui/tooltip/tooltip';\nimport {Trans} from '@common/i18n/trans';\nimport {MediaClosedCaptionsIcon} from '@common/icons/media/media-closed-captions';\nimport {MediaClosedCaptionsOnIcon} from '@common/icons/media/media-closed-captions-on';\n\ninterface Props {\n  color?: ButtonProps['color'];\n  size?: ButtonProps['size'];\n  iconSize?: ButtonProps['size'];\n  className?: string;\n}\nexport function ToggleCaptionsButton({\n  size = 'md',\n  iconSize,\n  color,\n  className,\n}: Props) {\n  const {trans} = useTrans();\n  const player = usePlayerActions();\n  const playerReady = usePlayerStore(s => s.providerReady);\n  const captionsVisible = usePlayerStore(s => s.textTrackIsVisible);\n  const haveCaptions = usePlayerStore(s => !!s.textTracks.length);\n\n  if (!haveCaptions) {\n    return null;\n  }\n\n  const labelMessage = trans(\n    captionsVisible\n      ? message('Hide subtitles/captions (c)')\n      : message('Show subtitles/captions (c)')\n  );\n\n  return (\n    <Tooltip label={<Trans message={labelMessage} />} usePortal={false}>\n      <IconButton\n        disabled={!playerReady}\n        aria-label={labelMessage}\n        size={size}\n        color={color}\n        iconSize={iconSize}\n        className={className}\n        onClick={() => {\n          player.setTextTrackVisibility(!captionsVisible);\n        }}\n      >\n        {captionsVisible ? (\n          <MediaClosedCaptionsOnIcon />\n        ) : (\n          <MediaClosedCaptionsIcon />\n        )}\n      </IconButton>\n    </Tooltip>\n  );\n}\n","import {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport clsx from 'clsx';\nimport {HTMLAttributes} from 'react';\n\ninterface Props extends HTMLAttributes<HTMLDivElement> {\n  hideDuringPlayback?: boolean;\n}\nexport function PlayerPoster({\n  className,\n  hideDuringPlayback = true,\n  ...domProps\n}: Props) {\n  const posterUrl = usePlayerStore(s => s.posterUrl);\n  const shouldHidePoster = usePlayerStore(\n    s =>\n      hideDuringPlayback && s.playbackStarted && s.providerName !== 'htmlAudio'\n  );\n  if (!posterUrl) return null;\n  return (\n    <div\n      {...domProps}\n      className={clsx(\n        'transition-opacity pointer-events-none flex items-center justify-center bg-black w-full max-h-full',\n        shouldHidePoster ? 'opacity-0' : 'opacity-100',\n        className\n      )}\n    >\n      <img\n        loading=\"lazy\"\n        src={posterUrl}\n        alt=\"\"\n        className=\"w-full max-h-full object-cover flex-shrink-0\"\n      />\n    </div>\n  );\n}\n","import {useCallback, useRef} from 'react';\nimport {usePlayerActions} from '@common/player/hooks/use-player-actions';\n\nexport function usePlayerClickHandler() {\n  const clickRef = useRef(0);\n  const player = usePlayerActions();\n\n  const togglePlay = useCallback(() => {\n    if (player.getState().isPlaying) {\n      player.pause();\n    } else {\n      player.play();\n    }\n  }, [player]);\n\n  return useCallback(() => {\n    if (!player.getState().providerReady) return;\n    clickRef.current += 1;\n    togglePlay();\n    if (clickRef.current === 1) {\n      setTimeout(() => {\n        if (clickRef.current > 1) {\n          player.toggleFullscreen();\n        }\n        clickRef.current = 0;\n      }, 300);\n    }\n  }, [player, togglePlay]);\n}\n","import {\n  ProgressCircle,\n  ProgressCircleProps,\n} from '@common/ui/progress/progress-circle';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {opacityAnimation} from '@common/ui/animation/opacity-animation';\n\ninterface Props {\n  className?: string;\n  trackColor?: string;\n  fillColor?: string;\n  size?: ProgressCircleProps['size'];\n}\nexport function BufferingSpinner({\n  className,\n  trackColor,\n  fillColor,\n  size,\n}: Props) {\n  const isActive = usePlayerStore(\n    s =>\n      // YouTube will already show a spinner, no need for a custom one\n      (s.isBuffering && s.providerName !== 'youtube') ||\n      (s.playbackStarted && !s.providerReady)\n  );\n  return (\n    <AnimatePresence initial={false}>\n      {isActive && (\n        <m.div {...opacityAnimation} className={className}>\n          <ProgressCircle\n            isIndeterminate\n            trackColor={trackColor}\n            fillColor={fillColor}\n            size={size}\n          />\n        </m.div>\n      )}\n    </AnimatePresence>\n  );\n}\n","import {\n  MutableRefObject,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useRef,\n} from 'react';\nimport {PlayerContext} from '@common/player/player-context';\nimport {MediaItem} from '@common/player/media-item';\nimport {PlayerOutlet} from '@common/player/ui/player-outlet';\nimport {PlayButton} from '@common/player/ui/controls/play-button';\nimport {VolumeControls} from '@common/player/ui/controls/volume-controls';\nimport {Seekbar} from '@common/player/ui/controls/seeking/seekbar';\nimport {FormattedCurrentTime} from '@common/player/ui/controls/formatted-current-time';\nimport {FormattedPlayerDuration} from '@common/player/ui/controls/formatted-player-duration';\nimport {\n  PlayerActions,\n  usePlayerActions,\n} from '@common/player/hooks/use-player-actions';\nimport {usePlayerStore} from '@common/player/hooks/use-player-store';\nimport clsx from 'clsx';\nimport {NextButton} from '@common/player/ui/controls/next-button';\nimport {FullscreenButton} from '@common/player/ui/controls/fullscreen-button';\nimport {PipButton} from '@common/player/ui/controls/pip-button';\nimport {PlaybackOptionsButton} from '@common/player/ui/controls/playback-options-button';\nimport {ToggleCaptionsButton} from '@common/player/ui/controls/toggle-captions-button';\nimport {PlayerPoster} from '@common/player/ui/controls/player-poster';\nimport {usePlayerClickHandler} from '@common/player/hooks/use-player-click-handler';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {MediaPlayIcon} from '@common/icons/media/media-play';\nimport {BufferingSpinner} from '@common/player/ui/controls/buffering-spinner';\nimport {guessPlayerProvider} from '@common/player/utils/guess-player-provider';\nimport {usePrevious} from '@common/utils/hooks/use-previous';\nimport {PlayerStoreOptions} from '@common/player/state/player-store-options';\n\ninterface Props {\n  id: string;\n  queue?: MediaItem[];\n  cuedMediaId?: string;\n  autoPlay?: boolean;\n  src?: string;\n  listeners?: PlayerStoreOptions['listeners'];\n  onDestroy?: PlayerStoreOptions['onDestroy'];\n  onBeforePlayNext?: PlayerStoreOptions['onBeforePlayNext'];\n  onBeforePlayPrevious?: PlayerStoreOptions['onBeforePlayPrevious'];\n  apiRef?: MutableRefObject<PlayerActions>;\n  rightActions?: ReactNode;\n}\nexport function VideoPlayer({\n  id,\n  queue,\n  cuedMediaId,\n  autoPlay,\n  src,\n  listeners,\n  onBeforePlayPrevious,\n  onBeforePlayNext,\n  onDestroy,\n  apiRef,\n  rightActions,\n}: Props) {\n  return (\n    <PlayerContext\n      id={id}\n      options={{\n        autoPlay,\n        listeners,\n        onDestroy,\n        onBeforePlayNext,\n        onBeforePlayPrevious,\n        initialData: {\n          queue: queue ? queue : [mediaItemFromSrc(src!)],\n          cuedMediaId,\n        },\n      }}\n    >\n      <QueueOverrider src={src} queue={queue} />\n      <PlayerLayout apiRef={apiRef} rightActions={rightActions} />\n    </PlayerContext>\n  );\n}\n\ninterface PlayerLayoutProps {\n  apiRef?: MutableRefObject<PlayerActions>;\n  rightActions?: ReactNode;\n}\nfunction PlayerLayout({apiRef, rightActions}: PlayerLayoutProps) {\n  const leaveTimerRef = useRef<number | null>();\n  const inactiveTimerRef = useRef<number | null>();\n  const pointerIsOverControls = useRef(false);\n  const actions = usePlayerActions();\n  const controlsVisible = usePlayerStore(s => s.controlsVisible);\n  const {setControlsVisible, getState, subscribe} = actions;\n\n  const clickHandler = usePlayerClickHandler();\n\n  const clearTimers = () => {\n    if (leaveTimerRef.current) {\n      clearTimeout(leaveTimerRef.current);\n      leaveTimerRef.current = null;\n    }\n    if (inactiveTimerRef.current) {\n      clearTimeout(inactiveTimerRef.current);\n      inactiveTimerRef.current = null;\n    }\n  };\n\n  const startInactiveTimer = useCallback(() => {\n    if (getState().isPlaying) {\n      inactiveTimerRef.current = window.setTimeout(() => {\n        setControlsVisible(false);\n      }, 3500);\n    }\n  }, [getState, setControlsVisible]);\n\n  useEffect(() => {\n    if (apiRef) {\n      apiRef.current = actions;\n      return actions.subscribe({\n        play: () => startInactiveTimer(),\n      });\n    }\n  }, [apiRef, actions, setControlsVisible, startInactiveTimer]);\n\n  return (\n    <div\n      className={clsx(\n        'fullscreen-host relative isolate aspect-video bg-black',\n        !controlsVisible && 'cursor-none'\n      )}\n      onClick={clickHandler}\n      onPointerEnter={() => {\n        setControlsVisible(true);\n        clearTimers();\n      }}\n      onPointerMove={() => {\n        if (pointerIsOverControls.current) {\n          return;\n        }\n        if (inactiveTimerRef.current) {\n          setControlsVisible(true);\n        }\n        clearTimers();\n        startInactiveTimer();\n      }}\n      onPointerLeave={() => {\n        clearTimers();\n        if (!getState().isPlaying) {\n          return;\n        }\n        leaveTimerRef.current = window.setTimeout(() => {\n          setControlsVisible(false);\n        }, 2500);\n      }}\n    >\n      <PlayerOutlet className=\"z-50 h-full w-full\" />\n      <Blocker />\n      <PlayerPoster className=\"absolute inset-0 z-30\" />\n      <OverlayButtons />\n      <BufferingSpinner\n        className=\"spinner pointer-events-none absolute inset-0 z-40 m-auto h-50 w-50\"\n        fillColor=\"border-white\"\n        trackColor=\"border-white/30\"\n        size=\"w-50 h-50\"\n      />\n      <BottomGradient />\n      <Controls\n        rightActions={rightActions}\n        onPointerEnter={() => {\n          pointerIsOverControls.current = true;\n          setControlsVisible(true);\n          clearTimers();\n        }}\n        onPointerLeave={() => {\n          pointerIsOverControls.current = false;\n        }}\n      />\n    </div>\n  );\n}\n\nfunction OverlayButtons() {\n  const showPlayButton = usePlayerStore(s => !s.isPlaying && !s.isSeeking);\n  return (\n    <div\n      className={clsx(\n        'absolute left-0 top-0 z-40 flex h-full w-full items-center justify-center transition-opacity',\n        showPlayButton ? 'opacity-100' : 'pointer-events-none opacity-0'\n      )}\n    >\n      <IconButton color=\"primary\" variant=\"raised\" size=\"lg\">\n        <MediaPlayIcon />\n      </IconButton>\n    </div>\n  );\n}\n\n// required in order for \"onPointerEnter\" to fire consistently when player provider is iframe\nfunction Blocker() {\n  return <div className=\"absolute inset-0 z-20\" />;\n}\n\nfunction BottomGradient() {\n  const controlsVisible = usePlayerStore(s => s.controlsVisible);\n  return (\n    <div\n      className={clsx(\n        'player-bottom-gradient pointer-events-none absolute bottom-0 z-30 h-2/4 w-full bg-bottom bg-repeat-x pt-36 transition-opacity duration-300',\n        controlsVisible ? 'opacity-100' : 'opacity-0'\n      )}\n    />\n  );\n}\n\ninterface ControlsProps {\n  rightActions?: ReactNode;\n  onPointerEnter?: () => void;\n  onPointerLeave?: () => void;\n}\nfunction Controls({\n  rightActions,\n  onPointerEnter,\n  onPointerLeave,\n}: ControlsProps) {\n  const controlsVisible = usePlayerStore(s => s.controlsVisible);\n  return (\n    <div\n      onPointerEnter={onPointerEnter}\n      onPointerLeave={onPointerLeave}\n      onClick={e => e.stopPropagation()}\n      className={clsx(\n        'player-bottom-text-shadow absolute bottom-0 left-0 right-0 z-40 p-8 text-white/87 transition-opacity duration-300',\n        controlsVisible ? 'opacity-100' : 'opacity-0'\n      )}\n    >\n      <Seekbar trackColor=\"bg-white/40\" />\n      <div className=\"flex w-full items-center gap-4\">\n        <PlayButton color=\"white\" />\n        <NextButton color=\"white\" />\n        <VolumeControls\n          className=\"max-md:hidden\"\n          fillColor=\"bg-white\"\n          trackColor=\"bg-white/20\"\n          buttonColor=\"white\"\n        />\n        <span className=\"ml-10 text-sm\">\n          <FormattedCurrentTime className=\"min-w-40 text-right\" /> /{' '}\n          <FormattedPlayerDuration className=\"min-w-40 text-right\" />\n        </span>\n        <div className=\"ml-auto flex flex-shrink-0 items-center gap-4\">\n          {rightActions}\n          <ToggleCaptionsButton color=\"white\" />\n          <PlaybackOptionsButton color=\"white\" />\n          <FullscreenButton className=\"ml-auto\" color=\"white\" />\n          <PipButton color=\"white\" />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction mediaItemFromSrc(src: string): MediaItem {\n  return {\n    id: src,\n    src,\n    provider: guessPlayerProvider(src),\n  };\n}\n\ninterface QueueOverriderProps {\n  src?: string;\n  queue?: MediaItem[];\n}\nfunction QueueOverrider({src, queue}: QueueOverriderProps) {\n  const {getState, overrideQueue} = usePlayerActions();\n\n  const queueKey = queue?.map(item => item.id).join('-') ?? '';\n  const previousKey = usePrevious(queueKey);\n\n  // override queue when any of specified queue item id or order changes\n  useEffect(() => {\n    if (queue && previousKey && queueKey && previousKey !== queueKey) {\n      overrideQueue(queue);\n    }\n  }, [queueKey, previousKey, queue, overrideQueue]);\n\n  // override queue when src changes\n  useEffect(() => {\n    if (src && getState().cuedMedia?.src !== src) {\n      overrideQueue([mediaItemFromSrc(src)]);\n    }\n  }, [src, getState, overrideQueue]);\n\n  return null;\n}\n","import {useTrans} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\nimport clsx from 'clsx';\nimport {Title} from '@app/titles/models/title';\nimport {\n  ImageSize,\n  useImageSrc,\n  useImageSrcSet,\n} from '@app/images/use-image-src';\nimport {Episode} from '@app/titles/models/episode';\nimport {TitleLink} from '@app/titles/title-link';\nimport {EpisodeLink} from '@app/episodes/episode-link';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {Link} from 'react-router-dom';\nimport {getWatchLink} from '@app/videos/watch-page/get-watch-link';\nimport {MediaPlayIcon} from '@common/icons/media/media-play';\nimport {MovieIcon} from '@common/icons/material/Movie';\n\n// can provide either url for backdrop directly or\n// title/episode object if main backdrop for it should be used\ninterface Props {\n  src?: string;\n  title?: Title;\n  episode?: Episode;\n  className?: string;\n  size?: string;\n  lazy?: boolean;\n  srcSize?: ImageSize;\n  wrapWithLink?: boolean;\n  showPlayButton?: boolean;\n  wrapperClassName?: string;\n}\nexport function TitleBackdrop({\n  src: initialSrc,\n  title,\n  episode,\n  className,\n  size,\n  srcSize,\n  lazy = true,\n  wrapWithLink = false,\n  showPlayButton,\n  wrapperClassName,\n}: Props) {\n  const {trans} = useTrans();\n  const primaryVideo = episode?.primary_video || title?.primary_video;\n  if (!primaryVideo) {\n    showPlayButton = false;\n  }\n\n  if (!initialSrc && episode) {\n    initialSrc = episode?.poster;\n  }\n  if (!initialSrc && title) {\n    initialSrc = title.backdrop;\n  }\n\n  const src = useImageSrc(initialSrc, {size: srcSize});\n  const item = episode || title;\n  const srcset = useImageSrcSet(initialSrc);\n\n  const imageClassName = clsx(\n    className,\n    size,\n    'aspect-video bg-fg-base/4 object-cover',\n    !src ? 'flex items-center justify-center' : 'block'\n  );\n\n  let img = src ? (\n    <img\n      className={imageClassName}\n      draggable={false}\n      decoding=\"async\"\n      sizes={!srcSize ? `100vw` : undefined}\n      loading={lazy ? 'lazy' : 'eager'}\n      src={src}\n      srcSet={!srcSize ? srcset : undefined}\n      alt={\n        item\n          ? trans(\n              message('Backdrop for :name', {\n                values: {name: item.name},\n              })\n            )\n          : ''\n      }\n    />\n  ) : (\n    <span className={imageClassName}>\n      <MovieIcon className=\"max-w-[60%] text-divider\" size=\"text-6xl\" />\n    </span>\n  );\n\n  const playButton = showPlayButton ? (\n    <div className=\"absolute bottom-14 left-14\">\n      <IconButton\n        color=\"white\"\n        variant=\"flat\"\n        className=\"shadow-md\"\n        elementType={Link}\n        to={getWatchLink(primaryVideo!)}\n        aria-label=\"Play\"\n      >\n        <MediaPlayIcon />\n      </IconButton>\n    </div>\n  ) : null;\n\n  if (wrapWithLink) {\n    if (episode) {\n      img = (\n        <EpisodeLink\n          episode={episode}\n          title={title!}\n          seasonNumber={episode.season_number}\n          displayContents\n        >\n          {img}\n        </EpisodeLink>\n      );\n    } else if (title) {\n      img = (\n        <TitleLink title={title} displayContents>\n          {img}\n        </TitleLink>\n      );\n    }\n  }\n\n  return (\n    <div className={clsx('group relative flex-shrink-0', wrapperClassName)}>\n      {img}\n      {playButton}\n      {wrapWithLink && (\n        <div className=\"pointer-events-none absolute inset-0 bg-black opacity-0 transition-opacity group-hover:opacity-10\" />\n      )}\n    </div>\n  );\n}\n","import {Video} from '@app/titles/models/video';\nimport React, {ReactElement, useEffect, useState} from 'react';\nimport {Title} from '@app/titles/models/title';\nimport {Episode} from '@app/titles/models/episode';\nimport {TitleBackdrop} from '@app/titles/title-poster/title-backdrop';\nimport {ImageSize} from '@app/images/use-image-src';\nimport {VideoPlayerSkeleton} from '@app/videos/video-player-skeleton';\nimport clsx from 'clsx';\nimport {loadYoutubePoster} from '@common/player/providers/youtube/load-youtube-poster';\nimport {youtubeIdFromSrc} from '@common/player/utils/youtube-id-from-src';\n\ninterface Props {\n  video: Video;\n  isLazy?: boolean;\n  title?: Title;\n  episode?: Episode;\n  srcSize?: ImageSize;\n  size?: string;\n  fallback?: ReactElement;\n  forceTitleBackdrop?: boolean;\n}\nexport function VideoThumbnail({\n  video,\n  isLazy,\n  title,\n  episode,\n  srcSize,\n  size = 'w-full max-h-full',\n  fallback,\n  forceTitleBackdrop = false,\n}: Props) {\n  const [thumbnailUrl, setThumbnailUrl] = useState<string | undefined>(\n    video.thumbnail\n  );\n\n  useEffect(() => {\n    if (\n      !video.thumbnail &&\n      !forceTitleBackdrop &&\n      video.src.includes('youtube')\n    ) {\n      const youtubeId = youtubeIdFromSrc(video.src);\n      if (youtubeId) {\n        loadYoutubePoster(youtubeId).then(url => {\n          if (url) {\n            setThumbnailUrl(url);\n          }\n        });\n      }\n    }\n  }, [video.src, video.thumbnail, forceTitleBackdrop]);\n\n  if (forceTitleBackdrop || !thumbnailUrl) {\n    if (title) {\n      return (\n        <TitleBackdropFallback\n          title={title}\n          episode={episode}\n          srcSize={srcSize}\n          size={size}\n        />\n      );\n    }\n    if (fallback) {\n      return fallback;\n    }\n    return <VideoPlayerSkeleton animate={false} />;\n  }\n\n  return (\n    <img\n      loading={isLazy ? 'lazy' : undefined}\n      decoding=\"async\"\n      src={thumbnailUrl}\n      alt=\"\"\n      className={clsx(size, 'aspect-video flex-shrink-0 object-cover')}\n    />\n  );\n}\n\ninterface TitleBackdropFallbackProps {\n  title: Title;\n  episode?: Episode;\n  srcSize?: ImageSize;\n  size?: string;\n}\nfunction TitleBackdropFallback({\n  title,\n  episode,\n  srcSize,\n  size,\n}: TitleBackdropFallbackProps) {\n  return (\n    <TitleBackdrop\n      title={title}\n      episode={episode}\n      srcSize={srcSize}\n      size={size}\n    />\n  );\n}\n","import {PlayerActions} from '@common/player/hooks/use-player-actions';\nimport {MediaItem} from '@common/player/media-item';\nimport {Video} from '@app/titles/models/video';\nimport {MutableRefObject, useCallback} from 'react';\nimport {getCookie} from 'react-use-cookie';\n\ninterface Options {\n  enabled?: boolean;\n}\n\nexport function useLogVideoPlay(\n  playerRef: MutableRefObject<PlayerActions>,\n  {enabled = true}: Options = {}\n) {\n  return useCallback((): boolean => {\n    const player = playerRef.current;\n    if (!player || !enabled) {\n      return false;\n    }\n    const media = player.getState().cuedMedia as MediaItem<Video> | undefined;\n    if (!media?.meta?.id || player.getCurrentTime() === 0) {\n      return false;\n    }\n    return navigator.sendBeacon(\n      `/api/v1/videos/${media.meta.id}/log-play`,\n      JSON.stringify({\n        currentTime: player.getCurrentTime(),\n        duration: player.getState().mediaDuration,\n        _token: getCookie('XSRF-TOKEN'),\n      })\n    );\n  }, [playerRef, enabled]);\n}\n","import {useTrans} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\nimport clsx from 'clsx';\nimport {ImageSize, useImageSrc} from '@app/images/use-image-src';\nimport {Episode} from '@app/titles/models/episode';\nimport {EpisodeLink} from '@app/episodes/episode-link';\nimport {Title} from '@app/titles/models/title';\nimport {ReactNode} from 'react';\nimport {Link} from 'react-router-dom';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {getWatchLink} from '@app/videos/watch-page/get-watch-link';\nimport {MediaPlayIcon} from '@common/icons/media/media-play';\nimport {MovieIcon} from '@common/icons/material/Movie';\n\ninterface Props {\n  title: Title;\n  episode: Episode;\n  seasonNumber?: number;\n  className?: string;\n  size?: string;\n  lazy?: boolean;\n  srcSize?: ImageSize;\n  children?: ReactNode;\n  aspect?: string;\n  link?: string;\n  wrapWithLink?: boolean;\n  showPlayButton?: boolean;\n  rightAction?: ReactNode;\n}\nexport function EpisodePoster({\n  episode,\n  title,\n  seasonNumber,\n  className,\n  size,\n  srcSize,\n  lazy = true,\n  children,\n  aspect = 'aspect-video',\n  link,\n  wrapWithLink = true,\n  showPlayButton,\n  rightAction,\n}: Props) {\n  const {trans} = useTrans();\n  const src = useImageSrc(episode.poster, {size: srcSize});\n\n  const imageClassName = clsx(\n    'w-full h-full object-cover bg-fg-base/4',\n    !src ? 'flex items-center justify-center' : 'block'\n  );\n\n  let image = src ? (\n    <img\n      className={imageClassName}\n      draggable={false}\n      loading={lazy ? 'lazy' : 'eager'}\n      src={src}\n      alt={trans(message('Poster for :name', {values: {name: episode.name}}))}\n    />\n  ) : (\n    <span className={imageClassName}>\n      <MovieIcon className=\"max-w-[60%] text-divider\" size=\"text-6xl\" />\n    </span>\n  );\n\n  const playButton =\n    showPlayButton && episode.primary_video ? (\n      <IconButton\n        color=\"white\"\n        variant=\"flat\"\n        className=\"absolute bottom-12 left-12 z-10 shadow-md\"\n        elementType={Link}\n        to={getWatchLink(episode.primary_video)}\n      >\n        <MediaPlayIcon />\n      </IconButton>\n    ) : null;\n\n  if (wrapWithLink) {\n    image = link ? (\n      <Link to={link}>{image}</Link>\n    ) : (\n      <EpisodeLink\n        title={title}\n        episode={episode}\n        seasonNumber={episode.season_number ?? seasonNumber}\n        displayContents\n      >\n        {image}\n      </EpisodeLink>\n    );\n  }\n\n  return (\n    <div\n      className={clsx('group relative flex-shrink-0', size, aspect, className)}\n    >\n      {image}\n      {playButton}\n      {children && <div className=\"absolute bottom-14 left-14\">{children}</div>}\n      {wrapWithLink && (\n        <div className=\"pointer-events-none absolute inset-0 bg-black opacity-0 transition-opacity group-hover:opacity-10\" />\n      )}\n      {rightAction && (\n        <div className=\"absolute bottom-12 right-12 z-10 shadow-md\">\n          {rightAction}\n        </div>\n      )}\n    </div>\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ArrowBackIcon = createSvgIcon(\n  <path d=\"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\" />\n, 'ArrowBackOutlined');\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const ArrowForwardIcon = createSvgIcon(\n  <path d=\"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z\" />\n, 'ArrowForwardOutlined');\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const TvIcon = createSvgIcon(\n  <path d=\"M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5v2h8v-2h5c1.1 0 1.99-.9 1.99-2L23 5c0-1.1-.9-2-2-2zm0 14H3V5h18v12z\" />\n, 'TvOutlined');\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {useParams} from 'react-router-dom';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {Season} from '@app/titles/models/season';\nimport {Title} from '@app/titles/models/title';\nimport {Episode} from '@app/titles/models/episode';\nimport {PaginationResponse} from '@common/http/backend-response/pagination-response';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\n\nexport interface GetSeasonResponse extends BackendResponse {\n  season: Season;\n  title: Title;\n  episodes?: PaginationResponse<Episode>;\n}\n\ninterface Params {\n  skipUpdating?: boolean;\n  truncateDescriptions?: boolean;\n  load?: string;\n}\n\nexport const seasonQueryKey = (\n  titleId: number | string,\n  season: number | string,\n  params?: any\n) => {\n  const key = ['titles', `${titleId}`, 'seasons', `${season}`];\n  if (params) {\n    key.push(params);\n  }\n  return key;\n};\n\nexport function useSeason(loader: 'seasonPage' | 'season' | 'editSeasonPage') {\n  const {titleId, season} = useParams();\n  return useQuery<GetSeasonResponse>(\n    seasonQueryKey(titleId!, season!, loader),\n    () => fetchSeason(titleId!, season!, loader),\n    {\n      initialData: () => {\n        const data = getBootstrapData().loaders?.[loader];\n        if (data?.title?.id == titleId && data?.season?.number == season) {\n          return data;\n        }\n        return undefined;\n      },\n    }\n  );\n}\n\nfunction fetchSeason(\n  titleId: number | string,\n  seasonNumber: number | string,\n  loader: string\n) {\n  return apiClient\n    .get<GetSeasonResponse>(`titles/${titleId}/seasons/${seasonNumber}`, {\n      params: {loader},\n    })\n    .then(response => response.data);\n}\n","import {useInfiniteData} from '@common/ui/infinite-scroll/use-infinite-data';\nimport {PaginationResponse} from '@common/http/backend-response/pagination-response';\nimport {Episode} from '@app/titles/models/episode';\nimport {useParams} from 'react-router-dom';\nimport {seasonQueryKey} from '@app/seasons/requests/use-season';\n\ninterface Props {\n  titleId?: number | string;\n  season?: number | string;\n  willSortOrFilter?: boolean;\n  defaultOrderBy?: string;\n  defaultOrderDir?: 'desc' | 'asc';\n}\n\nexport function useSeasonEpisodes(\n  initialPage?: PaginationResponse<Episode>,\n  queryParams?: Record<string, string | number>,\n  props: Props = {}\n) {\n  const urlParams = useParams();\n  const titleId = props.titleId || urlParams.titleId;\n  const season = props.season || urlParams.season;\n  return useInfiniteData<Episode>({\n    initialPage,\n    willSortOrFilter: props.willSortOrFilter,\n    defaultOrderBy: props.defaultOrderBy,\n    defaultOrderDir: props.defaultOrderDir,\n    endpoint: `titles/${titleId}/seasons/${season}/episodes`,\n    queryKey: [...seasonQueryKey(titleId!, season!), 'episodes'],\n    queryParams,\n  });\n}\n","import React, {ReactNode, useEffect, useRef, useState} from 'react';\nimport clsx from 'clsx';\nimport {UseInfiniteQueryResult} from '@tanstack/react-query/src/types';\nimport {Trans} from '@common/i18n/trans';\nimport {Button} from '@common/ui/buttons/button';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {opacityAnimation} from '@common/ui/animation/opacity-animation';\nimport {ProgressCircle} from '@common/ui/progress/progress-circle';\n\nexport interface InfiniteScrollSentinelProps {\n  loaderMarginTop?: string;\n  children?: ReactNode;\n  loadMoreExtraContent?: ReactNode;\n  query: UseInfiniteQueryResult;\n  style?: React.CSSProperties;\n  className?: string;\n  variant?: 'infiniteScroll' | 'loadMore';\n  size?: 'sm' | 'md';\n}\nexport function InfiniteScrollSentinel({\n  query: {isInitialLoading, fetchNextPage, isFetchingNextPage, hasNextPage},\n  children,\n  loaderMarginTop = 'mt-24',\n  style,\n  className,\n  variant: _variant = 'infiniteScroll',\n  loadMoreExtraContent,\n  size = 'md',\n}: InfiniteScrollSentinelProps) {\n  const sentinelRef = useRef<HTMLDivElement>(null);\n  const isLoading = isFetchingNextPage || isInitialLoading;\n  const [loadMoreClickCount, setLoadMoreClickCount] = useState(0);\n  const innerVariant =\n    _variant === 'loadMore' && loadMoreClickCount < 3\n      ? 'loadMore'\n      : 'infiniteScroll';\n\n  useEffect(() => {\n    const sentinelEl = sentinelRef.current;\n    if (!sentinelEl || innerVariant === 'loadMore') return;\n    const observer = new IntersectionObserver(([entry]) => {\n      if (entry.isIntersecting && hasNextPage && !isLoading) {\n        fetchNextPage();\n      }\n    });\n    observer.observe(sentinelEl);\n    return () => {\n      observer.unobserve(sentinelEl);\n    };\n  }, [fetchNextPage, hasNextPage, isLoading, innerVariant]);\n\n  let content: ReactNode;\n\n  if (children) {\n    // children might already be wrapped in AnimatePresence, so only wrap default loader with it\n    content = isFetchingNextPage ? children : null;\n  } else if (innerVariant === 'loadMore') {\n    content = !isInitialLoading && hasNextPage && (\n      <div className={clsx('flex items-center gap-8', loaderMarginTop)}>\n        {loadMoreExtraContent}\n        <Button\n          size={size === 'md' ? 'sm' : 'xs'}\n          className={clsx(\n            size === 'sm' ? 'min-h-24 min-w-96' : 'min-h-36 min-w-112'\n          )}\n          variant=\"outline\"\n          color=\"primary\"\n          onClick={() => {\n            fetchNextPage();\n            setLoadMoreClickCount(loadMoreClickCount + 1);\n          }}\n          disabled={isLoading}\n        >\n          {loadMoreClickCount >= 2 && !isFetchingNextPage ? (\n            <Trans message=\"Load all\" />\n          ) : (\n            <Trans message=\"Show more\" />\n          )}\n        </Button>\n      </div>\n    );\n  } else {\n    content = (\n      <AnimatePresence>\n        {isFetchingNextPage && (\n          <m.div\n            className={clsx('flex justify-center w-full', loaderMarginTop)}\n            {...opacityAnimation}\n          >\n            <ProgressCircle size={size} isIndeterminate aria-label=\"loading\" />\n          </m.div>\n        )}\n      </AnimatePresence>\n    );\n  }\n\n  return (\n    <div\n      style={style}\n      className={clsx('w-full', className, hasNextPage && 'min-h-36')}\n      role=\"presentation\"\n    >\n      <div ref={sentinelRef} aria-hidden />\n      {content}\n    </div>\n  );\n}\n","import {createSvgIcon} from '@common/icons/create-svg-icon';\n\nexport const MediaEpisodesIcon = createSvgIcon(\n  [<path d=\"M24 19.3328V9.46667C24 9.39303 23.9403 9.33334 23.8667 9.33334L11.3333 9.33334C10.9652 9.33334 10.6667 9.03486 10.6667 8.66667V7.33334C10.6667 6.96515 10.9652 6.66667 11.3333 6.66667H26C26.3682 6.66667 26.6667 6.96515 26.6667 7.33334V19.3328C26.6667 19.701 26.3682 19.9994 26 19.9994H24.6667C24.2985 19.9994 24 19.701 24 19.3328Z\" key=\"0\"/>,<path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M6.00001 12C5.63182 12 5.33334 12.2985 5.33334 12.6667V24.6667C5.33334 25.0349 5.63182 25.3333 6.00001 25.3333H20.6672C21.0354 25.3333 21.3338 25.0349 21.3338 24.6667V12.6667C21.3338 12.2985 21.0354 12 20.6672 12H6.00001ZM8.66668 14.6667C8.29849 14.6667 8.00001 14.9651 8.00001 15.3333V22C8.00001 22.3682 8.29849 22.6667 8.66668 22.6667H18C18.3682 22.6667 18.6667 22.3682 18.6667 22V15.3333C18.6667 14.9651 18.3682 14.6667 18 14.6667H8.66668Z\" key=\"1\"/>,],\n  'MediaEpisodes',\n  '0 0 32 32'\n);\n","import {DialogTrigger} from '@common/ui/overlays/dialog/dialog-trigger';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {Dialog} from '@common/ui/overlays/dialog/dialog';\nimport {DialogHeader} from '@common/ui/overlays/dialog/dialog-header';\nimport {Trans} from '@common/i18n/trans';\nimport {DialogBody} from '@common/ui/overlays/dialog/dialog-body';\nimport {useDarkThemeVariables} from '@common/ui/themes/use-dark-theme-variables';\nimport {Title} from '@app/titles/models/title';\nimport {Episode} from '@app/titles/models/episode';\nimport {Accordion, AccordionItem} from '@common/ui/accordion/accordion';\nimport {EpisodePoster} from '@app/episodes/episode-poster/episode-poster';\nimport {MediaPlayIcon} from '@common/icons/media/media-play';\nimport React, {Fragment, ReactElement, ReactNode, useState} from 'react';\nimport {ArrowBackIcon} from '@common/icons/material/ArrowBack';\nimport {List, ListItem} from '@common/ui/list/list';\nimport {FullPageLoader} from '@common/ui/progress/full-page-loader';\nimport {ArrowForwardIcon} from '@common/icons/material/ArrowForward';\nimport {IllustratedMessage} from '@common/ui/images/illustrated-message';\nimport {TvIcon} from '@common/icons/material/Tv';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {useSeasonEpisodes} from '@app/titles/requests/use-season-episodes';\nimport {InfiniteScrollSentinel} from '@common/ui/infinite-scroll/infinite-scroll-sentinel';\nimport {useDialogContext} from '@common/ui/overlays/dialog/dialog-context';\nimport {Tooltip} from '@common/ui/tooltip/tooltip';\nimport {MediaEpisodesIcon} from '@common/icons/media/media-episodes';\n\ninterface Props {\n  title: Title;\n  currentEpisode: Episode;\n  onSelected: (episode: Episode) => void;\n  trigger?: ReactElement;\n}\nexport function EpisodeSelector(props: Props) {\n  const trigger = props.trigger || (\n    <Tooltip label={<Trans message=\"Episodes\" />}>\n      <IconButton>\n        <MediaEpisodesIcon />\n      </IconButton>\n    </Tooltip>\n  );\n  return (\n    <DialogTrigger type=\"popover\" placement=\"top\">\n      {trigger}\n      <EpisodeSelectorDialog {...props} />\n    </DialogTrigger>\n  );\n}\n\ntype SelectorPanel = 'episodes' | 'seasons';\n\nfunction EpisodeSelectorDialog({title, currentEpisode, onSelected}: Props) {\n  const {close} = useDialogContext();\n  const darkThemeVars = useDarkThemeVariables();\n  const [activeTab, setActiveTab] = useState<SelectorPanel>('episodes');\n  const [selectedSeason, setSelectedSeason] = useState(\n    currentEpisode.season_number\n  );\n\n  const heading =\n    activeTab === 'episodes' ? (\n      <Trans message=\"Season :number\" values={{number: selectedSeason}} />\n    ) : (\n      title.name\n    );\n\n  const showBackButton = activeTab === 'episodes' && title.seasons_count > 1;\n\n  return (\n    <Dialog style={darkThemeVars} className=\"dark\" size=\"lg\">\n      <DialogHeader\n        titleTextSize=\"text-md\"\n        closeButtonSize=\"md\"\n        className=\"h-60\"\n        padding={showBackButton ? 'pl-10 pr-20' : 'px-20'}\n        leftAdornment={\n          showBackButton ? (\n            <IconButton onClick={() => setActiveTab('seasons')}>\n              <ArrowBackIcon />\n            </IconButton>\n          ) : null\n        }\n      >\n        {heading}\n      </DialogHeader>\n      <DialogBody\n        className=\"stable-scrollbar relative h-400 text-main\"\n        padding=\"p-0\"\n      >\n        <AnimatePresence initial={false}>\n          {activeTab === 'episodes' ? (\n            <EpisodeList\n              title={title}\n              season={selectedSeason}\n              onSelected={episode => {\n                close();\n                onSelected(episode);\n              }}\n              selectedEpisodeId={\n                currentEpisode.season_number === selectedSeason\n                  ? currentEpisode.id\n                  : undefined\n              }\n            />\n          ) : (\n            <SeasonList\n              title={title}\n              selectedSeason={selectedSeason}\n              onSelected={number => {\n                setSelectedSeason(number);\n                setActiveTab('episodes');\n              }}\n            />\n          )}\n        </AnimatePresence>\n      </DialogBody>\n    </Dialog>\n  );\n}\n\ninterface SeasonListProps {\n  title: Title;\n  onSelected: (number: number) => void;\n  selectedSeason?: number;\n}\nfunction SeasonList({title, onSelected, selectedSeason}: SeasonListProps) {\n  return (\n    <AnimatedPanel name=\"seasons\">\n      <List>\n        {[...new Array(title.seasons_count).keys()].map(season => {\n          const seasonNumber = season + 1;\n          return (\n            <ListItem\n              className=\"group\"\n              endIcon={\n                <ArrowForwardIcon\n                  className=\"invisible group-hover:visible\"\n                  size=\"sm\"\n                />\n              }\n              showCheckmark\n              isSelected={selectedSeason === seasonNumber}\n              onSelected={() => onSelected(seasonNumber)}\n              key={seasonNumber}\n              onClick={() => onSelected(seasonNumber)}\n            >\n              <Trans message=\"Season :number\" values={{number: seasonNumber}} />\n            </ListItem>\n          );\n        })}\n      </List>\n    </AnimatedPanel>\n  );\n}\n\ninterface EpisodeListProps {\n  title: Title;\n  season: number;\n  onSelected: (episode: Episode) => void;\n  selectedEpisodeId: number | undefined;\n}\nfunction EpisodeList({\n  title,\n  season,\n  selectedEpisodeId,\n  onSelected,\n}: EpisodeListProps) {\n  const query = useSeasonEpisodes(\n    undefined,\n    {truncateDescriptions: 'true'},\n    {titleId: title.id, season}\n  );\n\n  let content: ReactNode;\n\n  if (query.noResults) {\n    content = (\n      <IllustratedMessage\n        className=\"pt-56\"\n        imageMargin=\"mb-8\"\n        image={\n          <div className=\"text-muted\">\n            <TvIcon size=\"xl\" />\n          </div>\n        }\n        imageHeight=\"h-auto\"\n        title={<Trans message=\"This season has not episodes yet.\" />}\n      />\n    );\n  } else if (query.isInitialLoading) {\n    content = <FullPageLoader />;\n  } else {\n    content = (\n      <Fragment>\n        <Accordion\n          defaultExpandedValues={\n            selectedEpisodeId ? [selectedEpisodeId] : undefined\n          }\n        >\n          {query.items.map(episode => (\n            <AccordionItem\n              value={episode.id}\n              key={episode.id}\n              buttonPadding=\"py-10 pl-26 pr-10\"\n              label={\n                <div className=\"flex items-center gap-14\">\n                  <div>{episode.episode_number}</div>\n                  <div>{episode.name}</div>\n                </div>\n              }\n            >\n              <EpisodeItem\n                title={title}\n                episode={episode}\n                isSelected={episode.id === selectedEpisodeId}\n                onSelected={() => onSelected(episode)}\n              />\n            </AccordionItem>\n          ))}\n        </Accordion>\n        <InfiniteScrollSentinel query={query} />\n      </Fragment>\n    );\n  }\n\n  return <AnimatedPanel name=\"episodes\">{content}</AnimatedPanel>;\n}\n\ninterface EpisodeItemProps {\n  title: Title;\n  episode: Episode;\n  isSelected: boolean;\n  onSelected: () => void;\n}\nfunction EpisodeItem({\n  episode,\n  title,\n  isSelected,\n  onSelected,\n}: EpisodeItemProps) {\n  const isPlayable = !isSelected && episode.primary_video;\n  return (\n    <div\n      className=\"flex gap-20 text-lg text-main\"\n      onClick={isPlayable ? () => onSelected() : undefined}\n    >\n      <EpisodePoster\n        wrapWithLink={false}\n        size=\"w-224\"\n        title={title}\n        episode={episode}\n      >\n        {isPlayable ? (\n          <IconButton variant=\"flat\" color=\"white\">\n            <MediaPlayIcon />\n          </IconButton>\n        ) : undefined}\n      </EpisodePoster>\n      <p className=\"pt-12 text-sm\">{episode.description}</p>\n    </div>\n  );\n}\n\nconst variants = {\n  enter: (activeTab: SelectorPanel) => {\n    return {\n      x: activeTab === 'episodes' ? 608 : -608,\n      opacity: 0,\n    };\n  },\n  center: {\n    x: 0,\n    opacity: 1,\n  },\n  exit: (direction: SelectorPanel) => {\n    return {\n      zIndex: 0,\n      x: direction === 'seasons' ? 608 : -608,\n      opacity: 0,\n    };\n  },\n};\n\ninterface AnimatedPanelProps {\n  name: SelectorPanel;\n  children: ReactNode;\n}\nfunction AnimatedPanel({name, children}: AnimatedPanelProps) {\n  return (\n    <m.div\n      className=\"absolute h-full w-full\"\n      key={name}\n      custom={name}\n      variants={variants}\n      initial=\"enter\"\n      animate=\"center\"\n      exit=\"exit\"\n      transition={{type: 'tween', duration: 0.15}}\n    >\n      {children}\n    </m.div>\n  );\n}\n","import {guessPlayerProvider} from '@common/player/utils/guess-player-provider';\nimport {VideoPlayer} from '@common/player/ui/video-player';\nimport {VideoThumbnail} from '@app/videos/video-thumbnail';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {MediaPlayIcon} from '@common/icons/media/media-play';\nimport React, {memo, useEffect, useRef} from 'react';\nimport {Video} from '@app/titles/models/video';\nimport {Title} from '@app/titles/models/title';\nimport {Episode} from '@app/titles/models/episode';\nimport {VideoPlayerSkeleton} from '@app/videos/video-player-skeleton';\nimport {MediaItem} from '@common/player/media-item';\nimport {useLogVideoPlay} from '@app/videos/requests/use-log-video-play';\nimport {PlayerActions} from '@common/player/hooks/use-player-actions';\nimport {getWatchLink} from '@app/videos/watch-page/get-watch-link';\nimport {useNavigate} from '@common/utils/hooks/use-navigate';\nimport {isSameMedia} from '@common/player/utils/is-same-media';\nimport {EpisodeSelector} from '@app/videos/watch-page/episode-selector';\n\ninterface Props {\n  video: Video;\n  relatedVideos?: Video[];\n  autoPlay?: boolean;\n  title?: Title;\n  episode?: Episode;\n  mediaItemId?: string;\n  logPlays?: boolean;\n  showEpisodeSelector?: boolean;\n}\nexport const SiteVideoPlayer = memo((props: Props) => {\n  const {video, autoPlay, title, episode} = props;\n  if (\n    video.type === 'video' ||\n    video.type === 'stream' ||\n    (video.type === 'embed' && video.src.includes('youtube'))\n  ) {\n    return <NativeVideoPlayer {...props} />;\n  }\n\n  if (video.type === 'embed') {\n    return <EmbedPlayer src={video.src} autoPlay={autoPlay} />;\n  }\n\n  if (video.type === 'external') {\n    return (\n      <div className=\"relative\">\n        <VideoThumbnail\n          title={title}\n          episode={episode}\n          video={video}\n          fallback={<div className=\"aspect-video w-full bg-fg-base/4\" />}\n        />\n        <div\n          className=\"absolute left-0 top-0 flex h-full w-full items-center justify-center\"\n          onClick={() => window.open(video.src, '_blank')}\n        >\n          <IconButton variant=\"flat\" color=\"primary\" size=\"lg\">\n            <MediaPlayIcon />\n          </IconButton>\n        </div>\n      </div>\n    );\n  }\n\n  return <VideoPlayerSkeleton />;\n});\n\ninterface EmberPlayerProps {\n  src: string;\n  autoPlay?: boolean;\n}\nconst EmbedPlayer = memo(({src, autoPlay}: EmberPlayerProps) => {\n  const url = src.includes('<iframe') ? src.match(/src=\"([^\"]*)\"/)?.[1] : src;\n  const parsed = new URL(url || '');\n  parsed.searchParams.set('autoplay', autoPlay ? '1' : '0');\n  return (\n    <iframe\n      src={parsed.toString()}\n      className=\"aspect-video w-full\"\n      allowFullScreen\n      allow=\"autoplay; encrypted-media; picture-in-picture;\"\n    />\n  );\n});\n\nfunction NativeVideoPlayer({\n  video,\n  title,\n  episode,\n  mediaItemId,\n  relatedVideos,\n  autoPlay,\n  logPlays,\n  showEpisodeSelector,\n}: Props) {\n  const playerRef = useRef<PlayerActions>(null!);\n  const logVideoPlay = useLogVideoPlay(playerRef, {enabled: logPlays});\n  const mediaItem = videoToMediaItem(video, mediaItemId);\n  const related = relatedVideos?.map(v => videoToMediaItem(v)) ?? [];\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      if (document.visibilityState === 'hidden') {\n        logVideoPlay();\n      }\n    };\n\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    return () =>\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n  }, [logVideoPlay]);\n\n  return (\n    <VideoPlayer\n      apiRef={playerRef}\n      id=\"player\"\n      queue={[mediaItem, ...related]}\n      autoPlay={autoPlay}\n      onBeforePlayNext={nextMedia => {\n        if (nextMedia && !isSameMedia(mediaItem, nextMedia)) {\n          navigate(getWatchLink(nextMedia.meta));\n        }\n        return true;\n      }}\n      onDestroy={() => logVideoPlay()}\n      listeners={{\n        playbackEnd: () => logVideoPlay(),\n        beforeCued: ({previous}) => {\n          // only log when cueing from previous video and not when cueing initial one\n          if (previous) {\n            logVideoPlay();\n          }\n        },\n      }}\n      rightActions={\n        showEpisodeSelector && title && episode ? (\n          <EpisodeSelector\n            title={title}\n            currentEpisode={episode}\n            onSelected={episode => {\n              navigate(getWatchLink(episode.primary_video));\n            }}\n          />\n        ) : undefined\n      }\n    />\n  );\n}\n\nfunction videoToMediaItem(video: Video, mediaItemId?: string): MediaItem {\n  return {\n    id: mediaItemId || video.id,\n    provider: guessPlayerProvider(video.src),\n    src: video.src,\n    poster: video.thumbnail,\n    meta: video,\n    initialTime: video.latest_play?.time_watched ?? undefined,\n    captions: video.captions?.map(caption => ({\n      id: caption.id,\n      src: caption.url,\n      label: caption.name,\n      language: caption.language,\n    })),\n  };\n}\n","import {\n  ALL_PRIMITIVE_OPERATORS,\n  BackendFilter,\n  FilterControlType,\n  FilterOperator,\n} from '@common/datatable/filters/backend-filter';\nimport {message} from '@common/i18n/message';\nimport {FetchValueListsResponse} from '@common/http/value-lists';\nimport {dateRangeToAbsoluteRange} from '@common/ui/forms/input-field/date/date-range-picker/form-date-range-picker';\nimport {\n  DateRangePreset,\n  DateRangePresets,\n} from '@common/ui/forms/input-field/date/date-range-picker/dialog/date-range-presets';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\nimport {now, parseDateTime} from '@internationalized/date';\nimport {getUserTimezone} from '@common/i18n/get-user-timezone';\nimport {Channel} from '@common/channels/channel';\nimport {GENRE_MODEL} from '@app/titles/models/genre';\nimport {PRODUCTION_COUNTRY_MODEL} from '@app/titles/models/production-country';\n\ninterface Props {\n  languages: FetchValueListsResponse['titleFilterLanguages'];\n  countries: FetchValueListsResponse['productionCountries'];\n  genres: FetchValueListsResponse['genres'];\n  ageRatings: FetchValueListsResponse['titleFilterAgeRatings'];\n  restriction?: Channel['restriction'];\n}\n\nexport const getTitleChannelFilters = ({\n  languages,\n  countries,\n  genres,\n  ageRatings,\n  restriction,\n}: Props): BackendFilter[] => {\n  return [\n    restriction?.model_type !== GENRE_MODEL\n      ? {\n          key: 'genres',\n          label: message('Genres'),\n          defaultOperator: FilterOperator.hasAll,\n          control: {\n            type: FilterControlType.ChipField,\n            placeholder: message('Pick genres'),\n            defaultValue: [],\n            options: genres.map(genre => ({\n              label: message(genre.name),\n              key: genre.value,\n              value: genre.value,\n            })),\n          },\n        }\n      : null,\n    {\n      key: 'release_date',\n      label: message('Release date'),\n      defaultOperator: FilterOperator.between,\n      control: {\n        type: FilterControlType.DateRangePicker,\n        defaultValue: dateRangeToAbsoluteRange(\n          (DateRangePresets[9] as Required<DateRangePreset>).getRangeValue()\n        ),\n        min: parseDateTime('1900-01-01'),\n        max: now(getUserTimezone()).add({years: 5}),\n      },\n    },\n    {\n      control: {\n        type: FilterControlType.Input,\n        inputType: 'number',\n        minValue: 1,\n        maxValue: 10,\n        defaultValue: 7,\n      },\n      key:\n        getBootstrapData().settings.content.title_provider !== 'tmdb'\n          ? 'tmdb_vote_average'\n          : 'local_vote_average',\n      label: message('User rating'),\n      defaultOperator: FilterOperator.gte,\n      operators: ALL_PRIMITIVE_OPERATORS,\n    },\n    {\n      key: 'runtime',\n      label: message('Runtime'),\n      description: message('Runtime in minutes'),\n      defaultOperator: FilterOperator.lte,\n      operators: ALL_PRIMITIVE_OPERATORS,\n      control: {\n        type: FilterControlType.Input,\n        inputType: 'number',\n        minValue: 1,\n        maxValue: 255,\n        defaultValue: 180,\n      },\n    },\n    {\n      key: 'language',\n      label: message('Original language'),\n      defaultOperator: FilterOperator.eq,\n      control: {\n        type: FilterControlType.Select,\n        placeholder: message('Pick a language'),\n        searchPlaceholder: message('Search for language'),\n        showSearchField: true,\n        options: languages.map(({name, value}) => ({\n          label: message(name),\n          key: value,\n          value: value,\n        })),\n      },\n    },\n    restriction?.model_type !== PRODUCTION_COUNTRY_MODEL\n      ? {\n          control: {\n            type: FilterControlType.ChipField,\n            placeholder: message('Pick countries'),\n            defaultValue: [],\n            options: countries?.map(({name, value}) => ({\n              label: message(name),\n              key: value,\n              value: value,\n            })),\n          },\n          key: 'productionCountries',\n          label: message('Production countries'),\n          defaultOperator: FilterOperator.hasAll,\n        }\n      : null,\n    {\n      key: 'certification',\n      label: message('Age rating'),\n      defaultOperator: FilterOperator.eq,\n      control: {\n        type: FilterControlType.Select,\n        placeholder: message('Pick an age rating'),\n        showSearchField: true,\n        searchPlaceholder: message('Search for age rating'),\n        options: ageRatings.map(({name, value}) => ({\n          label: message(name),\n          key: value,\n          value: value,\n        })),\n      },\n    },\n    {\n      key: 'budget',\n      label: message('Budget'),\n      description: message('Budget in US dollars'),\n      defaultOperator: FilterOperator.lte,\n      operators: ALL_PRIMITIVE_OPERATORS,\n      control: {\n        type: FilterControlType.Input,\n        inputType: 'number',\n        minValue: 1,\n        maxValue: 1000000000,\n        defaultValue: 100000000,\n      },\n    },\n    {\n      key: 'revenue',\n      label: message('Revenue'),\n      description: message('Revenue in US dollars'),\n      defaultOperator: FilterOperator.lte,\n      operators: ALL_PRIMITIVE_OPERATORS,\n      control: {\n        type: FilterControlType.Input,\n        inputType: 'number',\n        minValue: 1,\n        maxValue: 1000000000,\n        defaultValue: 100000000,\n      },\n    },\n  ].filter(Boolean) as BackendFilter[];\n};\n","import {useValueLists} from '@common/http/value-lists';\nimport {useMemo} from 'react';\nimport {getTitleChannelFilters} from '@app/channels/channel-header/get-title-channel-filters';\n\ninterface Options {\n  disabled?: boolean;\n}\n\nexport function useTitleIndexFilters(options: Options = {}) {\n  const {data, isLoading, fetchStatus} = useValueLists(\n    [\n      'titleFilterLanguages',\n      'productionCountries',\n      'genres',\n      'titleFilterAgeRatings',\n    ],\n    undefined,\n    options\n  );\n  const filters = useMemo(() => {\n    return getTitleChannelFilters({\n      countries: data?.productionCountries || [],\n      languages: data?.titleFilterLanguages || [],\n      genres: data?.genres || [],\n      ageRatings: data?.titleFilterAgeRatings || [],\n    });\n  }, [data]);\n\n  return {filters, filtersLoading: isLoading && fetchStatus !== 'idle'};\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {useParams} from 'react-router-dom';\nimport {Title, TitleCredit, TitleCreditPivot} from '@app/titles/models/title';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {LengthAwarePaginationResponse} from '@common/http/backend-response/pagination-response';\nimport {Season} from '@app/titles/models/season';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\nimport {Episode} from '@app/titles/models/episode';\n\nexport type GroupTitleCredits = Partial<\n  Record<TitleCreditPivot['department'], TitleCredit[]>\n>;\n\nexport interface GetTitleResponse extends BackendResponse {\n  title: Title;\n  seasons?: LengthAwarePaginationResponse<Season>;\n  episodes?: LengthAwarePaginationResponse<Episode>;\n  credits?: GroupTitleCredits;\n  language?: string;\n}\n\nexport function useTitle(\n  loader: 'title' | 'titlePage' | 'titleCreditsPage' | 'editTitlePage'\n) {\n  const {titleId} = useParams();\n  return useQuery<GetTitleResponse>(\n    ['titles', `${titleId}`, loader],\n    () => fetchTitle(titleId!, loader),\n    {\n      initialData: () => {\n        const data = getBootstrapData().loaders?.[loader];\n        if (data?.title?.id == titleId) {\n          return data;\n        }\n        return undefined;\n      },\n    }\n  );\n}\n\nfunction fetchTitle(titleId: number | string, loader: string) {\n  return apiClient\n    .get<GetTitleResponse>(`titles/${titleId}`, {params: {loader}})\n    .then(response => response.data);\n}\n","import {Video} from './video';\nimport {Title} from '@app/titles/models/title';\n\nexport const EPISODE_MODEL = 'episode';\n\nexport interface Episode {\n  id: number;\n  name: string;\n  model_type: typeof EPISODE_MODEL;\n  status: 'released' | 'upcoming';\n  poster: string;\n  runtime: number;\n  popularity: number;\n  rating: number;\n  description: string;\n  season_number: number;\n  episode_number: number;\n  title?: Title;\n  title_id: number;\n  release_date: string;\n  year: number;\n  videos?: Video[];\n  primary_video: Video;\n}\n","import {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {useMutation} from '@tanstack/react-query';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/utils/http/show-http-error-toast';\nimport {Review} from '@app/titles/models/review';\nimport {Reviewable} from '@app/reviews/reviewable';\nimport {UseFormReturn} from 'react-hook-form';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\nimport {reviewsQueryKey} from '@app/reviews/requests/use-reviews';\n\ninterface Response extends BackendResponse {\n  review: Review;\n}\n\nexport interface CreateReviewPayload {\n  score: number;\n  title?: string;\n  body?: string;\n}\n\ninterface Payload extends CreateReviewPayload {\n  reviewable: Reviewable;\n}\n\nexport function useCreateReview(form?: UseFormReturn<CreateReviewPayload>) {\n  return useMutation((payload: Payload) => createReview(payload), {\n    onSuccess: async () => {\n      await queryClient.invalidateQueries(reviewsQueryKey());\n    },\n    onError: r => (form ? onFormQueryError(r, form) : showHttpErrorToast(r)),\n  });\n}\n\nfunction createReview(payload: Payload): Promise<Response> {\n  return apiClient\n    .post(`reviews`, {\n      reviewable_id: payload.reviewable.id,\n      reviewable_type: payload.reviewable.model_type,\n      score: payload.score,\n      title: payload.title,\n      body: payload.body,\n    })\n    .then(r => r.data);\n}\n","import {Title} from '@app/titles/models/title';\nimport {Episode, EPISODE_MODEL} from '@app/titles/models/episode';\nimport {Dialog} from '@common/ui/overlays/dialog/dialog';\nimport {DialogBody} from '@common/ui/overlays/dialog/dialog-body';\nimport {Trans} from '@common/i18n/trans';\nimport {TitlePoster} from '@app/titles/title-poster/title-poster';\nimport {useState} from 'react';\nimport {Button} from '@common/ui/buttons/button';\nimport {useCreateReview} from '@app/reviews/requests/use-create-review';\nimport {useDialogContext} from '@common/ui/overlays/dialog/dialog-context';\nimport {useDeleteReviews} from '@app/reviews/requests/use-delete-reviews';\nimport {DialogHeader} from '@common/ui/overlays/dialog/dialog-header';\nimport {EpisodePoster} from '@app/episodes/episode-poster/episode-poster';\nimport {TitleLink} from '@app/titles/title-link';\nimport {CompactSeasonEpisode} from '@app/episodes/compact-season-episode';\nimport {StarSelector} from '@app/reviews/review-list/star-selector';\n\ninterface Props {\n  title: Title;\n  episode?: Episode;\n  initialRating?: {id: number; score: number};\n}\nexport function RatingDialog({title, episode, initialRating}: Props) {\n  const item = episode || title;\n  const createReview = useCreateReview();\n  const deleteReview = useDeleteReviews();\n  const {close} = useDialogContext();\n  const [currentRating, setCurrentRating] = useState(initialRating?.score || 0);\n\n  const handleCreateReview = () => {\n    if (currentRating) {\n      createReview.mutate(\n        {reviewable: item, score: currentRating},\n        {\n          onSuccess: () => close(),\n        }\n      );\n    }\n  };\n\n  const handleDeleteReview = () => {\n    if (initialRating) {\n      deleteReview.mutate(\n        {reviewIds: [initialRating.id]},\n        {\n          onSuccess: () => close(),\n        }\n      );\n    }\n  };\n\n  return (\n    <Dialog size=\"w-auto\">\n      <DialogHeader>\n        <DialogTitle item={item} />\n      </DialogHeader>\n      <DialogBody>\n        {item.model_type === EPISODE_MODEL ? (\n          <EpisodeDetails title={title} episode={episode!} />\n        ) : (\n          <TitleDetails title={title} />\n        )}\n        <div className=\"pb-16\">\n          <StarSelector\n            count={10}\n            value={currentRating}\n            onValueChange={setCurrentRating}\n            className=\"my-14\"\n          />\n          <Button\n            variant=\"flat\"\n            color=\"primary\"\n            className=\"w-full\"\n            disabled={!currentRating || createReview.isLoading}\n            onClick={handleCreateReview}\n          >\n            <Trans message=\"Rate\" />\n          </Button>\n          {initialRating && (\n            <Button\n              className=\"w-full mt-14\"\n              disabled={deleteReview.isLoading}\n              onClick={handleDeleteReview}\n            >\n              <Trans message=\"Remove rating\" />\n            </Button>\n          )}\n        </div>\n      </DialogBody>\n    </Dialog>\n  );\n}\n\ninterface TitleDetailsProps {\n  title: Title;\n}\nfunction TitleDetails({title}: TitleDetailsProps) {\n  return (\n    <div className=\"flex items-center gap-12 mb-24\">\n      <TitlePoster size=\"w-60\" srcSize=\"sm\" title={title} />\n      <div className=\"text-sm\">\n        <div>{title.name}</div>\n        <div>{title.year}</div>\n      </div>\n    </div>\n  );\n}\n\ninterface EpisodeDetailsProps {\n  title: Title;\n  episode: Episode;\n}\nfunction EpisodeDetails({title, episode}: EpisodeDetailsProps) {\n  return (\n    <div className=\"flex items-center gap-12 mb-24\">\n      <EpisodePoster size=\"w-100\" title={title} episode={episode} />\n      <div className=\"text-base\">\n        <TitleLink title={title} color=\"primary\" />\n        <div className=\"text-sm\">\n          {episode.name} (<CompactSeasonEpisode episode={episode} />)\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface DialogTitleProps {\n  item: Title | Episode;\n}\nfunction DialogTitle({item}: DialogTitleProps) {\n  if (item.model_type === EPISODE_MODEL) {\n    return <Trans message=\"Rate this episode\" />;\n  } else if (item.is_series) {\n    return <Trans message=\"Rate this series\" />;\n  } else {\n    return <Trans message=\"Rate this movie\" />;\n  }\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {useAuth} from '@common/auth/use-auth';\nimport {Title} from '@app/titles/models/title';\nimport {Episode} from '@app/titles/models/episode';\n\ninterface Response extends BackendResponse {\n  ratings: {\n    episode: Record<number, {id: number; score: number}>;\n    title: Record<number, {id: number; score: number}>;\n  };\n}\n\nexport function useCurrentUserRatings() {\n  const {user} = useAuth();\n  return useQuery(['reviews', 'users', `${user?.id}`], () => fetchRatings(), {\n    enabled: !!user,\n  });\n}\n\nexport function useCurrentUserRatingFor(item: Title | Episode) {\n  const query = useCurrentUserRatings();\n  return {\n    isLoading: query.isLoading && query.fetchStatus !== 'idle',\n    rating: query.data?.ratings?.[item.model_type]?.[item.id],\n  };\n}\n\nfunction fetchRatings() {\n  return apiClient\n    .get<Response>(`users/me/ratings`)\n    .then(response => response.data);\n}\n","import {MouseEvent, useCallback} from 'react';\nimport {useAuth} from '@common/auth/use-auth';\nimport {useNavigate} from '@common/utils/hooks/use-navigate';\nimport {useDialogContext} from '@common/ui/overlays/dialog/dialog-context';\n\nexport function useAuthClickCapture() {\n  const dialogContext = useDialogContext();\n  const {isLoggedIn} = useAuth();\n  const navigate = useNavigate();\n\n  return useCallback(\n    (e: MouseEvent) => {\n      if (!isLoggedIn) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (dialogContext) {\n          dialogContext.close();\n        }\n\n        navigate('/login');\n      }\n    },\n    [navigate, isLoggedIn, dialogContext]\n  );\n}\n","import {Title} from '@app/titles/models/title';\nimport {DialogTrigger} from '@common/ui/overlays/dialog/dialog-trigger';\nimport {Button} from '@common/ui/buttons/button';\nimport {StarBorderIcon} from '@common/icons/material/StarBorder';\nimport {Trans} from '@common/i18n/trans';\nimport {RatingDialog} from '@app/reviews/rating-dialog';\nimport {Episode} from '@app/titles/models/episode';\nimport clsx from 'clsx';\nimport {TitleRating} from '@app/reviews/title-rating';\nimport {useCurrentUserRatingFor} from '@app/reviews/requests/use-current-user-ratings';\nimport {Skeleton} from '@common/ui/skeleton/skeleton';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {opacityAnimation} from '@common/ui/animation/opacity-animation';\nimport {ReactElement} from 'react';\nimport {useAuthClickCapture} from '@app/use-auth-click-capture';\n\ninterface Props {\n  title: Title;\n  episode?: Episode;\n  size?: 'sm' | 'md' | 'lg';\n  className?: string;\n}\nexport function InteractableRating({\n  title,\n  episode,\n  size = 'md',\n  className,\n}: Props) {\n  const isUpcoming = episode\n    ? episode.status === 'upcoming'\n    : title.status === 'upcoming';\n  const score = (episode || title).rating;\n\n  if (isUpcoming) {\n    return null;\n  }\n\n  return (\n    <div\n      className={clsx(\n        'flex min-w-[249px] flex-shrink-0 items-center',\n        getSizeClassName(size),\n        className\n      )}\n    >\n      {score ? (\n        <div className=\"border-r pr-14\">\n          <TitleRating score={score} />\n        </div>\n      ) : null}\n      <RateButton title={title} episode={episode} />\n    </div>\n  );\n}\n\nfunction RateButton({title, episode}: Props) {\n  const item = episode || title;\n  const {isLoading, rating} = useCurrentUserRatingFor(item);\n  const authHandler = useAuthClickCapture();\n\n  let content: ReactElement;\n\n  if (isLoading) {\n    content = (\n      <m.div\n        key=\"skeleton\"\n        {...opacityAnimation}\n        className=\"flex min-h-36 items-center\"\n      >\n        <Skeleton variant=\"rect\" size=\"w-[106px] h-16 ml-14\" />\n      </m.div>\n    );\n  } else {\n    content = (\n      <m.div key=\"button\" {...opacityAnimation}>\n        <DialogTrigger type=\"modal\">\n          {rating ? (\n            <Button onClickCapture={authHandler}>\n              <Trans\n                message=\"Your rating: :value / 10\"\n                values={{value: rating.score}}\n              />\n            </Button>\n          ) : (\n            <Button\n              onClickCapture={authHandler}\n              startIcon={<StarBorderIcon />}\n              className=\"min-w-120\"\n            >\n              <Trans message=\"Rate this\" />\n            </Button>\n          )}\n          <RatingDialog\n            title={title}\n            episode={episode}\n            initialRating={rating}\n          />\n        </DialogTrigger>\n      </m.div>\n    );\n  }\n\n  return (\n    <AnimatePresence initial={false} mode=\"wait\">\n      {content}\n    </AnimatePresence>\n  );\n}\n\nfunction getSizeClassName(size: Props['size']) {\n  switch (size) {\n    case 'sm':\n      return 'text-sm';\n    case 'md':\n      return 'text-base';\n    case 'lg':\n      return 'text-lg';\n  }\n}\n","import {EpisodePoster} from '@app/episodes/episode-poster/episode-poster';\nimport {CompactSeasonEpisode} from '@app/episodes/compact-season-episode';\nimport {EpisodeLink} from '@app/episodes/episode-link';\nimport {InteractableRating} from '@app/reviews/interactable-rating';\nimport React, {ReactNode} from 'react';\nimport {Episode} from '@app/titles/models/episode';\nimport {Title} from '@app/titles/models/title';\nimport {TitleRating} from '@app/reviews/title-rating';\nimport clsx from 'clsx';\nimport {FormattedDate} from '@common/i18n/formatted-date';\nimport {Trans} from '@common/i18n/trans';\n\ninterface Props {\n  episode: Episode;\n  title: Title;\n  allowRating?: boolean;\n  className?: string;\n  children?: ReactNode;\n  showPlayButton?: boolean;\n  centerPlayButton?: boolean;\n}\nexport function EpisodeListItem({\n  episode,\n  title,\n  allowRating = true,\n  className,\n  children,\n  showPlayButton,\n}: Props) {\n  return (\n    <div className={clsx('flex items-center gap-20', className)}>\n      <div className=\"relative w-288 flex-shrink-0 overflow-hidden rounded max-md:hidden\">\n        <EpisodePoster\n          title={title}\n          episode={episode}\n          seasonNumber={episode.season_number}\n          lazy={true}\n          srcSize=\"md\"\n          showPlayButton={showPlayButton}\n        />\n        <div className=\"absolute bottom-0 left-0 w-full bg-black/50 p-6 text-center text-sm text-white\">\n          <CompactSeasonEpisode episode={episode} />\n        </div>\n      </div>\n      <div>\n        <EpisodeLink\n          title={title}\n          seasonNumber={episode.season_number}\n          episode={episode}\n          color=\"primary\"\n          className=\"text-base font-medium\"\n        />\n        <div className=\"my-10\">\n          <EpisodeRating\n            title={title}\n            episode={episode}\n            allowRating={allowRating}\n          />\n        </div>\n        <div className=\"text-sm\">\n          {episode.description || (\n            <span className=\"italic\">\n              <Trans message=\"We have no overview for this episode yet.\" />\n            </span>\n          )}\n        </div>\n        {children}\n      </div>\n    </div>\n  );\n}\n\ninterface EpisodeRatingProps {\n  title: Title;\n  episode: Episode;\n  allowRating: boolean;\n}\nfunction EpisodeRating({title, episode, allowRating}: EpisodeRatingProps) {\n  if (episode.status === 'upcoming') {\n    return <FormattedDate date={episode.release_date} />;\n  }\n\n  return allowRating ? (\n    <InteractableRating title={title} episode={episode} />\n  ) : (\n    <TitleRating score={episode.rating} />\n  );\n}\n","import {useLocation} from 'react-router-dom';\nimport {RefObject, useEffect} from 'react';\nimport {usePrevious} from '@common/utils/hooks/use-previous';\nimport {getScrollParent} from '@react-aria/utils';\n\nexport function useScrollToTop(ref?: RefObject<HTMLElement>) {\n  const {pathname} = useLocation();\n\n  const previousPathname = usePrevious(pathname);\n\n  useEffect(() => {\n    if (previousPathname !== pathname) {\n      const scrollParent = ref?.current\n        ? getScrollParent(ref.current)\n        : document.documentElement;\n      scrollParent.scrollTo({\n        top: 0,\n        left: 0,\n      });\n    }\n  }, [pathname, previousPathname, ref]);\n}\n","import {useInfiniteData} from '@common/ui/infinite-scroll/use-infinite-data';\nimport {Season} from '@app/titles/models/season';\nimport {PaginationResponse} from '@common/http/backend-response/pagination-response';\n\nexport const titleSeasonsQueryKey = (titleId: number | string) => [\n  'title',\n  `${titleId}`,\n  'seasons',\n];\n\nexport function useTitleSeasons(\n  titleId: string | number,\n  initialPage?: PaginationResponse<Season>,\n  queryParams?: Record<string, string | number>\n) {\n  return useInfiniteData<Season>({\n    initialPage,\n    endpoint: `titles/${titleId}/seasons`,\n    queryKey: titleSeasonsQueryKey(titleId),\n    queryParams,\n  });\n}\n","import {useTrans} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\nimport clsx from 'clsx';\nimport {ImageSize, useImageSrc} from '@app/images/use-image-src';\nimport {Season} from '@app/titles/models/season';\nimport {SeasonLink} from '@app/seasons/season-link';\nimport {Title} from '@app/titles/models/title';\nimport {Link} from 'react-router-dom';\nimport {MovieIcon} from '@common/icons/material/Movie';\n\ninterface Props {\n  title: Title;\n  season: Season;\n  className?: string;\n  size?: string;\n  lazy?: boolean;\n  srcSize?: ImageSize;\n  link?: string;\n}\nexport function SeasonPoster({\n  title,\n  season,\n  className,\n  size = 'w-full',\n  srcSize,\n  lazy = true,\n  link,\n}: Props) {\n  const {trans} = useTrans();\n  const src = useImageSrc(season.poster || title.poster, {size: srcSize});\n\n  const imageClassName = clsx(\n    className,\n    size,\n    'object-cover bg-fg-base/4 aspect-poster rounded',\n    !src ? 'flex items-center justify-center' : 'block'\n  );\n\n  const image = src ? (\n    <img\n      className={imageClassName}\n      draggable={false}\n      loading={lazy ? 'lazy' : 'eager'}\n      src={src}\n      alt={trans(\n        message('Poster for season :number of :title', {\n          values: {number: season.number, title: title.name},\n        })\n      )}\n    />\n  ) : (\n    <span className={imageClassName}>\n      <MovieIcon className=\"max-w-[60%] text-divider\" size=\"text-6xl\" />\n    </span>\n  );\n\n  return link ? (\n    <Link to={link} className=\"flex-shrink-0\">\n      {image}\n    </Link>\n  ) : (\n    <SeasonLink\n      title={title}\n      seasonNumber={season.number}\n      className=\"flex-shrink-0\"\n    >\n      {image}\n    </SeasonLink>\n  );\n}\n","import {createSvgIcon} from '../create-svg-icon';\n\nexport const PlayCircleIcon = createSvgIcon(\n  <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-2.5-3.5 7-4.5-7-4.5v9z\" />\n, 'PlayCircleOutlined');\n","import {Video} from '@app/titles/models/video';\nimport {PlayCircleIcon} from '@common/icons/material/PlayCircle';\nimport {ReactNode} from 'react';\nimport {Link} from 'react-router-dom';\nimport {getWatchLink} from '@app/videos/watch-page/get-watch-link';\nimport {Skeleton} from '@common/ui/skeleton/skeleton';\nimport clsx from 'clsx';\nimport {useIsMobileMediaQuery} from '@common/utils/hooks/is-mobile-media-query';\nimport {VideoThumbnail} from '@app/videos/video-thumbnail';\nimport {Title} from '@app/titles/models/title';\nimport {Episode} from '@app/titles/models/episode';\n\ninterface Props {\n  videos?: Video[];\n  heading?: ReactNode;\n  count?: number;\n  title?: Title;\n  episode?: Episode;\n}\nexport function VideoGrid({videos, heading, count, title, episode}: Props) {\n  const isMobile = useIsMobileMediaQuery();\n  if (!videos?.length) return null;\n\n  if (!count) {\n    count = isMobile ? 4 : 3;\n  }\n\n  return (\n    <div className=\"mt-48\">\n      {heading}\n      <div className=\"grid grid-cols-2 gap-12 md:grid-cols-3 md:gap-24\">\n        {videos.slice(0, count).map(video => (\n          <VideoGridItem\n            key={video.id}\n            video={video}\n            title={title}\n            episode={episode}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n\ninterface VideoGridItemProps {\n  video: Video;\n  className?: string;\n  title?: Title;\n  episode?: Episode;\n  name?: ReactNode;\n  showCategory?: boolean;\n  forceTitleBackdrop?: boolean;\n}\nexport function VideoGridItem({\n  video,\n  className,\n  title,\n  episode,\n  name,\n  showCategory = true,\n  forceTitleBackdrop = false,\n}: VideoGridItemProps) {\n  const link = getWatchLink(video);\n  return (\n    <div key={video.id} className={className}>\n      <Link to={link} className=\"relative isolate block\">\n        <VideoThumbnail\n          video={video}\n          title={title}\n          episode={episode}\n          srcSize=\"lg\"\n          forceTitleBackdrop={forceTitleBackdrop}\n        />\n        <VideoGridItemBottomGradient />\n        <span className=\"absolute bottom-0 left-0 z-30 flex items-center gap-x-6 p-10 text-white\">\n          <PlayCircleIcon size={showCategory ? 'md' : 'lg'} />\n          {showCategory && <span className=\"capitalize\">{video.category}</span>}\n        </span>\n      </Link>\n      <Link to={link} className=\"mt-12 block hover:underline\">\n        {name || video.name}\n      </Link>\n    </div>\n  );\n}\n\ninterface VideoGridItemSkeletonProps {\n  className?: string;\n}\nexport function VideoGridItemSkeleton({className}: VideoGridItemSkeletonProps) {\n  return (\n    <div className={clsx(className, 'h-[228px]')}>\n      <Skeleton variant=\"rect\" size=\"w-full aspect-video\" animation=\"pulsate\" />\n      <Skeleton variant=\"text\" size=\"w-3/4 mt-12 h-20\" />\n    </div>\n  );\n}\n\nexport function VideoGridItemBottomGradient() {\n  return (\n    <div className=\"player-bottom-gradient pointer-events-none absolute bottom-0 z-20 h-full w-full bg-bottom bg-repeat-x pt-36\" />\n  );\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {useParams} from 'react-router-dom';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {Title} from '@app/titles/models/title';\nimport {Episode} from '@app/titles/models/episode';\nimport {seasonQueryKey} from '@app/seasons/requests/use-season';\nimport {GroupTitleCredits} from '@app/titles/requests/use-title';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\n\nexport interface GetEpisodeResponse extends BackendResponse {\n  episode: Episode;\n  title: Title;\n  credits?: GroupTitleCredits;\n}\n\nexport function useEpisode(\n  loader: 'episodePage' | 'episodeCreditsPage' | 'episode'\n) {\n  const {titleId, season, episode} = useParams();\n  return useQuery<GetEpisodeResponse>(\n    [...seasonQueryKey(titleId!, season!), 'episodes', `${episode}`, loader],\n    () => fetchEpisode(titleId!, season!, episode!, loader),\n    {\n      initialData: () => {\n        const data = getBootstrapData().loaders?.[loader];\n        if (\n          data?.title.id == titleId &&\n          data?.episode.season_number == season &&\n          data?.episode.episode_number == episode\n        ) {\n          return data;\n        }\n        return undefined;\n      },\n    }\n  );\n}\n\nfunction fetchEpisode(\n  titleId: string,\n  seasonNumber: string,\n  episodeNumber: string,\n  loader: string\n) {\n  return apiClient\n    .get<GetEpisodeResponse>(\n      `titles/${titleId}/seasons/${seasonNumber}/episodes/${episodeNumber}`,\n      {params: {loader}}\n    )\n    .then(response => response.data);\n}\n","import {Link, LinkProps} from 'react-router-dom';\nimport clsx from 'clsx';\nimport React, {ReactNode, useMemo} from 'react';\nimport {slugifyString} from '@common/utils/string/slugify-string';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\nimport {Person} from '@app/titles/models/person';\n\ninterface Props extends Omit<LinkProps, 'to'> {\n  person: Person;\n  className?: string;\n  children?: ReactNode;\n  color?: 'primary' | 'inherit';\n}\nexport function PersonLink({\n  person,\n  className,\n  children,\n  color = 'inherit',\n  ...linkProps\n}: Props) {\n  const finalUri = useMemo(() => {\n    return getPersonLink(person);\n  }, [person]);\n\n  return (\n    <Link\n      {...linkProps}\n      className={clsx(\n        color === 'primary'\n          ? 'text-primary hover:text-primary-dark'\n          : 'text-inherit',\n        'hover:underline outline-none focus-visible:underline overflow-x-hidden overflow-ellipsis transition-colors',\n        className\n      )}\n      to={finalUri}\n    >\n      {children ?? person.name}\n    </Link>\n  );\n}\n\nexport function getPersonLink(\n  person: Person,\n  {absolute}: {absolute?: boolean} = {}\n): string {\n  let link = `/people/${person.id}/${slugifyString(person.name)}`;\n  if (absolute) {\n    link = `${getBootstrapData().settings.base_url}${link}`;\n  }\n  return link;\n}\n","import {useTrans} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\nimport clsx from 'clsx';\nimport {Person} from '@app/titles/models/person';\nimport {PersonLink} from '@app/people/person-link';\nimport {ImageSize, useImageSrc} from '@app/images/use-image-src';\nimport {PersonIcon} from '@common/icons/material/Person';\n\ninterface Props {\n  person: Person;\n  className?: string;\n  size?: string;\n  lazy?: boolean;\n  srcSize?: ImageSize;\n  rounded?: boolean;\n}\nexport function PersonPoster({\n  person,\n  className,\n  size,\n  srcSize,\n  lazy = true,\n  rounded = false,\n}: Props) {\n  const {trans} = useTrans();\n  const src = useImageSrc(person?.poster, {size: srcSize});\n\n  const imageClassName = clsx(\n    className,\n    size,\n    'bg-fg-base/4 object-cover',\n    rounded ? 'aspect-square rounded-full' : 'aspect-poster rounded',\n    !src ? 'flex items-center justify-center' : 'block'\n  );\n\n  const image = src ? (\n    <img\n      decoding=\"async\"\n      className={imageClassName}\n      draggable={false}\n      loading={lazy ? 'lazy' : 'eager'}\n      src={src}\n      alt={trans(\n        message('Cover image for :name', {values: {name: person.name}})\n      )}\n    />\n  ) : (\n    <span className={imageClassName}>\n      <PersonIcon className=\"max-w-[60%] text-divider\" size=\"text-5xl\" />\n    </span>\n  );\n\n  return (\n    <PersonLink person={person} className=\"flex-shrink-0\">\n      {image}\n    </PersonLink>\n  );\n}\n","import {Person} from '@app/titles/models/person';\nimport {BulletSeparatedItems} from '@app/titles/bullet-separated-items';\nimport {Trans} from '@common/i18n/trans';\nimport {TitleLink} from '@app/titles/title-link';\nimport {HTMLAttributeAnchorTarget} from 'react';\nimport {BaseMediaLinkProps} from '@app/base-media-link';\n\ninterface Props {\n  person: Person;\n  linkTarget?: HTMLAttributeAnchorTarget;\n  linkColor?: BaseMediaLinkProps['color'];\n}\nexport function KnownForCompact({\n  person,\n  linkTarget,\n  linkColor = 'primary',\n}: Props) {\n  return (\n    <BulletSeparatedItems>\n      {person.known_for ? <Trans message={person.known_for} /> : null}\n      {person.primary_credit ? (\n        <TitleLink\n          target={linkTarget}\n          color={linkColor}\n          title={person.primary_credit}\n          onClick={e => {\n            e.stopPropagation();\n          }}\n        />\n      ) : null}\n    </BulletSeparatedItems>\n  );\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {useParams} from 'react-router-dom';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {Person} from '@app/titles/models/person';\nimport {PersonCredit} from '@app/titles/models/title';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\n\nexport interface GetPersonResponse extends BackendResponse {\n  person: Person;\n  knownFor: PersonCredit[];\n  credits: Record<string, PersonCredit[]>;\n  total_credits_count: number;\n}\n\nexport function usePerson(loader: 'personPage' | 'editPersonPage') {\n  const {personId} = useParams();\n  return useQuery<GetPersonResponse>(\n    ['people', `${personId}`, loader],\n    () => fetchPerson(personId!, loader),\n    {\n      initialData: () => {\n        const data = getBootstrapData().loaders?.[loader];\n        if (data?.person?.id == personId) {\n          return data;\n        }\n        return undefined;\n      },\n    }\n  );\n}\n\nfunction fetchPerson(personId: number | string, loader: string) {\n  return apiClient\n    .get<GetPersonResponse>(`people/${personId}`, {params: {loader}})\n    .then(response => response.data);\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {NewsArticle} from '@app/titles/models/news-article';\nimport {useParams} from 'react-router-dom';\nimport {getBootstrapData} from '@common/core/bootstrap-data/use-backend-bootstrap-data';\n\nexport interface GetNewsArticleResponse extends BackendResponse {\n  article: NewsArticle;\n  related: NewsArticle[];\n}\n\nexport function useNewsArticle(loader: 'newsArticlePage') {\n  const {articleId} = useParams();\n  return useQuery<GetNewsArticleResponse>(\n    ['news-articles', `${articleId}`],\n    () => fetchNewsArticle(articleId!),\n    {\n      initialData: () => {\n        const data = getBootstrapData().loaders?.[loader];\n        if (data?.article?.id == articleId) {\n          return data;\n        }\n        return undefined;\n      },\n    }\n  );\n}\n\nfunction fetchNewsArticle(articleId: string) {\n  return apiClient\n    .get<GetNewsArticleResponse>(`news/${articleId}`)\n    .then(response => response.data);\n}\n","export default \"__VITE_ASSET__1f8798d3__\"","import {useMutation} from '@tanstack/react-query';\nimport {UseFormReturn} from 'react-hook-form';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {toast} from '@common/ui/toast/toast';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\nimport {message} from '@common/i18n/message';\nimport {useNavigate} from '@common/utils/hooks/use-navigate';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {Channel} from '@common/channels/channel';\nimport {DatatableDataQueryKey} from '@common/datatable/requests/paginated-resources';\nimport {CreateChannelPayload} from '@common/admin/channels/requests/use-create-channel';\n\ninterface Response extends BackendResponse {\n  channel: Channel;\n}\n\nexport function useCreateList(form: UseFormReturn<CreateChannelPayload>) {\n  const {trans} = useTrans();\n  const navigate = useNavigate();\n  return useMutation((payload: CreateChannelPayload) => createList(payload), {\n    onSuccess: async response => {\n      await queryClient.invalidateQueries(DatatableDataQueryKey('channel'));\n      toast(trans(message('List created')));\n      navigate(`../${response.channel.id}/edit`, {\n        replace: true,\n        relative: 'path',\n      });\n    },\n    onError: err => onFormQueryError(err, form),\n  });\n}\n\nfunction createList(payload: CreateChannelPayload) {\n  return apiClient.post<Response>('channel', payload).then(r => r.data);\n}\n","import {FormTextField} from '@common/ui/forms/input-field/text-field/text-field';\nimport {Trans} from '@common/i18n/trans';\nimport {ContentModelField} from '@common/admin/channels/channel-editor/controls/content-model-field';\nimport {\n  channelContentConfig,\n  Layout,\n} from '@app/admin/channels/channel-content-config';\nimport {NEWS_ARTICLE_MODEL} from '@app/titles/models/news-article';\nimport {CHANNEL_MODEL} from '@common/channels/channel';\nimport {MOVIE_MODEL, SERIES_MODEL} from '@app/titles/models/title';\nimport {ContentOrderField} from '@common/admin/channels/channel-editor/controls/content-order-field';\nimport {FormSelect, Option} from '@common/ui/forms/select/select';\nimport {ChannelContentEditor} from '@common/admin/channels/channel-editor/channel-content-editor';\nimport React from 'react';\nimport {\n  ChannelContentSearchField,\n  ChannelContentSearchFieldProps,\n} from '@common/admin/channels/channel-editor/channel-content-search-field';\nimport {ChannelContentItemImage} from '@app/admin/channels/channel-content-item-image';\nimport {IllustratedMessage} from '@common/ui/images/illustrated-message';\nimport {SvgImage} from '@common/ui/images/svg-image/svg-image';\nimport playlist from '@common/admin/channels/playlist.svg';\nimport {FormSwitch} from '@common/ui/forms/toggle/switch';\n\nexport function CrupdateUserListForm() {\n  return (\n    <div>\n      <FormTextField\n        name=\"name\"\n        label={<Trans message=\"Name\" />}\n        required\n        autoFocus\n        className=\"mb-24\"\n      />\n      <FormTextField\n        name=\"description\"\n        label={<Trans message=\"Description\" />}\n        inputElementType=\"textarea\"\n        rows={2}\n        className=\"mb-24\"\n      />\n      <ContentModelField\n        config={channelContentConfig}\n        className=\"mb-24\"\n        exclude={[NEWS_ARTICLE_MODEL, CHANNEL_MODEL, MOVIE_MODEL, SERIES_MODEL]}\n      />\n      <ContentOrderField config={channelContentConfig} />\n      <FormSelect\n        className=\"flex-auto w-full\"\n        selectionMode=\"single\"\n        name=\"config.layout\"\n        label={<Trans message=\"Layout\" />}\n      >\n        <Option value={Layout.grid}>\n          <Trans {...channelContentConfig.layoutMethods[Layout.grid].label} />\n        </Option>\n        <Option value={Layout.list}>\n          <Trans {...channelContentConfig.layoutMethods[Layout.list].label} />\n        </Option>\n        <Option value={Layout.landscapeGrid}>\n          <Trans\n            {...channelContentConfig.layoutMethods[Layout.landscapeGrid].label}\n          />\n        </Option>\n      </FormSelect>\n      <FormSwitch name=\"public\" className=\"mt-24\">\n        <Trans message=\"Public\" />\n      </FormSwitch>\n      <ChannelContentEditor\n        title={<Trans message=\"List content\" />}\n        searchField={<SearchField />}\n        noResultsMessage={<NoResultsMessage />}\n      />\n    </div>\n  );\n}\n\nfunction SearchField(props: ChannelContentSearchFieldProps) {\n  return (\n    <ChannelContentSearchField\n      {...props}\n      imgRenderer={item => <ChannelContentItemImage item={item} />}\n    />\n  );\n}\n\nfunction NoResultsMessage() {\n  return (\n    <IllustratedMessage\n      title={<Trans message=\"List is empty\" />}\n      description={<Trans message=\"No content is attached to this list yet.\" />}\n      image={<SvgImage src={playlist} />}\n    />\n  );\n}\n","import React, {Fragment} from 'react';\nimport {useForm} from 'react-hook-form';\nimport {CrupdateResourceLayout} from '@common/admin/crupdate-resource-layout';\nimport {Trans} from '@common/i18n/trans';\nimport {StaticPageTitle} from '@common/seo/static-page-title';\nimport {useCreateList} from '@app/user-lists/requests/use-create-list';\nimport {CrupdateUserListForm} from '@app/user-lists/pages/crupdate-user-list-form';\nimport {TITLE_MODEL} from '@app/titles/models/title';\nimport {EMPTY_PAGINATION_RESPONSE} from '@common/http/backend-response/pagination-response';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {Link} from 'react-router-dom';\nimport {ArrowBackIcon} from '@common/icons/material/ArrowBack';\nimport {CreateChannelPayload} from '@common/admin/channels/requests/use-create-channel';\n\nexport function CreateUserListPage() {\n  const form = useForm<CreateChannelPayload>({\n    defaultValues: {\n      type: 'list',\n      public: true,\n      config: {\n        contentType: 'manual',\n        contentModel: TITLE_MODEL,\n        layout: 'grid',\n        contentOrder: 'channelables.order:asc',\n      },\n      content: EMPTY_PAGINATION_RESPONSE.pagination,\n    },\n  });\n  const createList = useCreateList(form);\n\n  return (\n    <Fragment>\n      <StaticPageTitle>\n        <Trans message=\"New list\" />\n      </StaticPageTitle>\n      <CrupdateResourceLayout\n        backButton={\n          <IconButton elementType={Link} relative=\"path\" to=\"../\">\n            <ArrowBackIcon />\n          </IconButton>\n        }\n        form={form}\n        onSubmit={values => {\n          createList.mutate(values);\n        }}\n        title={<Trans message=\"New list\" />}\n        isLoading={createList.isLoading}\n      >\n        <CrupdateUserListForm />\n      </CrupdateResourceLayout>\n    </Fragment>\n  );\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {UseFormReturn} from 'react-hook-form';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {toast} from '@common/ui/toast/toast';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\nimport {message} from '@common/i18n/message';\nimport {useNavigate} from '@common/utils/hooks/use-navigate';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {useParams} from 'react-router-dom';\nimport {DatatableDataQueryKey} from '@common/datatable/requests/paginated-resources';\nimport {Channel} from '@common/channels/channel';\nimport {CreateChannelPayload} from '@common/admin/channels/requests/use-create-channel';\n\ninterface Response extends BackendResponse {\n  list: Channel;\n}\n\nexport function useUpdateList(form: UseFormReturn<CreateChannelPayload>) {\n  const {trans} = useTrans();\n  const {slugOrId} = useParams();\n  const navigate = useNavigate();\n  return useMutation(\n    (payload: CreateChannelPayload) => createList(payload, slugOrId!),\n    {\n      onSuccess: async () => {\n        await queryClient.invalidateQueries(DatatableDataQueryKey('channel'));\n        toast(trans(message('List updated')));\n        navigate(`../../`, {\n          replace: true,\n          relative: 'path',\n        });\n      },\n      onError: err => onFormQueryError(err, form),\n    }\n  );\n}\n\nfunction createList(payload: CreateChannelPayload, listId: string) {\n  return apiClient\n    .put<Response>(`channel/${listId}`, payload)\n    .then(r => r.data);\n}\n","import React, {Fragment, ReactNode} from 'react';\nimport {PageStatus} from '@common/http/page-status';\nimport {useForm} from 'react-hook-form';\nimport {CrupdateResourceLayout} from '@common/admin/crupdate-resource-layout';\nimport {Trans} from '@common/i18n/trans';\nimport {StaticPageTitle} from '@common/seo/static-page-title';\nimport {useUpdateList} from '@app/user-lists/requests/use-update-list';\nimport {CrupdateUserListForm} from '@app/user-lists/pages/crupdate-user-list-form';\nimport {IconButton} from '@common/ui/buttons/icon-button';\nimport {ArrowBackIcon} from '@common/icons/material/ArrowBack';\nimport {Link} from 'react-router-dom';\nimport {CreateChannelPayload} from '@common/admin/channels/requests/use-create-channel';\nimport {useChannel} from '@common/channels/requests/use-channel';\nimport {Channel} from '@common/channels/channel';\n\nexport function EditUserListPage() {\n  const query = useChannel(undefined, 'editUserListPage');\n\n  return query.data ? (\n    <Fragment>\n      <StaticPageTitle>\n        <Trans message=\"Edit list\" />\n      </StaticPageTitle>\n      <PageContent list={query.data.channel}>\n        <CrupdateUserListForm />\n      </PageContent>\n    </Fragment>\n  ) : (\n    <PageStatus query={query} loaderClassName=\"absolute m-auto inset-0\" />\n  );\n}\n\ninterface PageContentProps {\n  list: Channel;\n  children: ReactNode;\n}\nfunction PageContent({list, children}: PageContentProps) {\n  const form = useForm<CreateChannelPayload>({\n    // @ts-ignore\n    defaultValues: {\n      ...list,\n    },\n  });\n  const updateList = useUpdateList(form);\n\n  return (\n    <CrupdateResourceLayout\n      backButton={\n        <IconButton elementType={Link} relative=\"path\" to=\"../../\">\n          <ArrowBackIcon />\n        </IconButton>\n      }\n      form={form}\n      onSubmit={values => {\n        updateList.mutate(values);\n      }}\n      title={<Trans message=\"Edit :name List\" values={{name: list.name}} />}\n      isLoading={updateList.isLoading}\n    >\n      {children}\n    </CrupdateResourceLayout>\n  );\n}\n","import {Link, LinkProps} from 'react-router-dom';\nimport clsx from 'clsx';\nimport React, {useContext, useMemo} from 'react';\nimport {User} from '@common/auth/user';\nimport {SiteConfigContext} from '@common/core/settings/site-config-context';\n\ninterface UserProfileLinkProps extends Omit<LinkProps, 'to'> {\n  user: User;\n  className?: string;\n}\nexport function UserProfileLink({\n  user,\n  className,\n  ...linkProps\n}: UserProfileLinkProps) {\n  const {auth} = useContext(SiteConfigContext);\n  const finalUri = useMemo(() => {\n    return auth.getUserProfileLink!(user);\n  }, [auth, user]);\n\n  return (\n    <Link\n      {...linkProps}\n      className={clsx('hover:underline', className)}\n      to={finalUri}\n    >\n      {user.display_name}\n    </Link>\n  );\n}\n"],"file":"assets/user-profile-link-bc31d40d.js"}